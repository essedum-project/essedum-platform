
<div class="container-fluid backgroud-color">
        <div class="row">
            <div class="col-lg-12">
                <div class="lfx-l-level1-middle-col">
                    <div *ngIf="!edit" class="align-items-center d-flex">
                        <span class="" *ngIf="!customCreate" style="cursor: pointer;">
                            <i class="fa fa-long-arrow-left back-icon" aria-hidden="true" (click)="routeBackToConnectionList()"></i>
                        </span>
                        <span class="lfx-u-mar-l-8 lfx-u-header-xxl secondary-color">Create Connection</span>
                    </div>
                    <div class="" *ngIf="initiativeCreate">
                       
                        <span *ngIf="initiativeView">

                            <div *ngIf="view" class="align-items-center d-flex">
                                <span class="" style="cursor: pointer;">
                                    <i class="fa fa-long-arrow-left back-icon" aria-hidden="true"
                                        (click)="routeBackToConnectionList()"></i>
                                </span>
                                <span class="lfx-u-mar-l-8 lfx-u-header-xxl secondary-color">View Connection</span>
                            </div>
                            
                        </span>
                        <div *ngIf="!initiativeView">
                            <span class="lfx-u-mar-l-8 aip-desc-title lfx-u-header-xxl">
                                <span style=" color: #737373;;">Connection:</span>{{data.alias | titlecase}}
                            </span>
                        </div>
                    </div>
                    <div *ngIf="ConnectionEdit" class="align-items-center d-flex">
                        <span class="" style="cursor: pointer;">
                            <i class="fa fa-long-arrow-left back-icon" aria-hidden="true"  (click)="routeBackToConnectionList()"></i>
                        </span>                       
                        <span class="lfx-u-mar-l-8 lfx-u-header-xxl secondary-color">Edit Connection</span>
                    </div>
                    <div class="d-flex justify-content-end" *ngIf="!initiativeView">
                        <button type="button" class="btn-close" aria-label="Close" (click)="closeModal()">
                            <i class="icon x-16 close-icon"></i>
                        </button>
                    </div>
                    <div *ngIf="view" class="align-items-center d-flex">
                            <span class="" style="cursor: pointer;">                          
                                <i class="fa fa-long-arrow-left back-icon" aria-hidden="true" (click)="routeBackToConnectionList()"></i>
                            </span>
                            <span class="lfx-u-mar-l-8 lfx-u-header-xxl secondary-color">View Connection</span>
                    </div>
                    <div class="lfx-l-level2-middle-ctr">
                        <div class="lfx-l-level2-middle-col">
                            <mat-card>
                                <div class="lfx-u-mar-tb-16 lfx-u-pad-16">
                                    <div class="row lfx-c-panel__content">
                                        <div class="lfx-l-level2-middle-col">
                                            <div class="d-flex justify-content-between align-items-center px-4 lfx-u-mar-b-20">
                                                <div class="align-items-center d-flex">
                                                    <h2 class="base-color">Connection Properties</h2>
                                                </div>
                                            </div>
                                            <div class="lfx-u-pad-t-32 lfx-u-pad-lr-24">
                                                <div class="row">
                                                    <div *ngIf="!edit" class="col-lg-12 col-md-12 lfx-u-mar-b-16">
                                                        <mat-form-field appearance="fill"  style="width: 100%;" floatLabel="always">
                                                            <mat-label>Display Name</mat-label>
                                                            <input matInput placeholder="Enter Name..." [(ngModel)]="alias" required>
                                                            <mat-error *ngIf="!alias">This field is required</mat-error>
                                                        </mat-form-field>
                                                    </div>
                                                    <div *ngIf="view" class="col-lg-12 col-md-12 lfx-u-mar-b-16">
                                                        <mat-form-field appearance="fill" style="width: 100%;" floatLabel="always">
                                                            <mat-label>Display Name</mat-label>
                                                            <input matInput placeholder="Enter Name..." [(ngModel)]="matData.alias" required>
                                                            <mat-error *ngIf="!matData.alias">This field is required</mat-error>
                                                        </mat-form-field>
                                                    </div>
                                                    <div *ngIf="ConnectionEdit"
                                                        class="col-lg-12 col-md-12 lfx-u-mar-b-16">
                                                        <mat-form-field appearance="fill" style="width: 100%;" floatLabel="always">
                                                            <mat-label>Display Name</mat-label>
                                                            <input matInput placeholder="Enter Name..." [(ngModel)]="matData.alias" required>
                                                            <mat-error *ngIf="!matData.alias">This field is required</mat-error>
                                                        </mat-form-field>
                                                    </div>
                                                    <div *ngIf="!edit" class="col-lg-12 col-md-12 lfx-u-mar-b-16">
                                                        <mat-form-field appearance="fill" style="width: 100%;" floatLabel="always">
                                                            <mat-label>Description</mat-label>
                                                            <input matInput placeholder="Enter Description..." [(ngModel)]="description">
                                                        </mat-form-field>
                                                    </div>
                                                    <div *ngIf="view" class="col-lg-12 col-md-12 lfx-u-mar-b-16">
                                                        <mat-form-field appearance="fill" style="width: 100%;" floatLabel="always">
                                                            <mat-label>Description</mat-label>
                                                            <input matInput placeholder="Enter Description..." [(ngModel)]="matData.description">
                                                        </mat-form-field>
                                                    </div>
                                                    <div *ngIf="ConnectionEdit"
                                                        class="col-lg-12 col-md-12 lfx-u-mar-b-16">
                                                        <mat-form-field appearance="fill" style="width: 100%;" floatLabel="always">
                                                            <mat-label>Description</mat-label>
                                                            <input matInput placeholder="Enter Description..." [(ngModel)]="matData.description">
                                                        </mat-form-field>
                                                    </div>
                                                    <div class="col-lg-12 col-md-12 lfx-u-mar-b-16">                                                   
                                                        <mat-form-field appearance="fill" style="width: 100%;">
                                                            <mat-label>Connection Type</mat-label>
                                                            <mat-select [(value)]="type" (selectionChange)="onTypeChange($event)">
                                                                <mat-option *ngFor="let option of typeOptions" [value]="option.value">
                                                                    {{ option.viewValue }}
                                                                </mat-option>
                                                            </mat-select>
                                                            <mat-hint>Select Connection type</mat-hint>
                                                        </mat-form-field>
                                                    </div>
                                                    <div class="col-lg-12 col-md-12 lfx-u-mar-b-16">
                                                        <mat-form-field appearance="fill" *ngIf="edit && (capabilityPromise | async)" style="width: 100%;">
                                                            <mat-label>Capability</mat-label>
                                                            <mat-select [(value)]="capability" (selectionChange)="onCapbilityTypeChange($event)" multiple>
                                                                <mat-option *ngFor="let option of capabilityOptions" [value]="option.value">
                                                                    {{ option.viewValue }}
                                                                </mat-option>
                                                            </mat-select>
                                                            <mat-hint>Select Capability</mat-hint>
                                                        </mat-form-field>

                                                    <mat-form-field appearance="fill" style="width: 100%;" *ngIf="!edit">
                                                            <mat-label>Capability</mat-label>
                                                            <mat-select [(value)]="capability" (selectionChange)="onCapbilityTypeChange($event)" multiple>
                                                                <mat-option *ngFor="let option of capabilityOptions" [value]="option.value">
                                                                    {{ option.viewValue }}
                                                                </mat-option>
                                                            </mat-select>
                                                            <mat-hint>Select Capability</mat-hint>
                                                        </mat-form-field> 
                                                    </div>
                                                  

                                                    <mat-accordion
                                                        *ngIf="category && !category.toLowerCase().endsWith('rest') && !category.toLowerCase().endsWith('git')"
                                                        designType="3D" [hideToggle]="false" [multi]="false">
                                                        <mat-expansion-panel style="margin-bottom: 10px !important">
                                                            <mat-expansion-panel-header [collapsedHeight]="'40px'"
                                                                [expandedHeight]="'40px'" 
                                                                [ngStyle]="{'background-color': '#0094ff'}">
                                                                <mat-panel-title style="color: white; font-weight: 600;">Connection Details</mat-panel-title>
                                                            </mat-expansion-panel-header>
                                                           
                                                            <div>
                                                                <table class="">
                                                                    <thead class="selector-690-15">
                                                                        <tr class="d-flex selector-690-16">
                                                                            <th class="col-2 selector-690-17 base-color"
                                                                                >
                                                                                Attribute</th>
                                                                            <th class="col-10 selector-690-18 base-color"
                                                                                >Value
                                                                            </th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody class="selector-690-19"
                                                                        style="line-height: 5rem;">
                                                                        <div>
                                                                            <tr *ngFor="let k of keys; let i = index"
                                                                                class="d-flex selector-690-27">
                                                                           
                                                                                <div *ngIf="!k.includes('_vault')"
                                                                                    class="d-flex selector-690-28"
                                                                                    style="width: 100%;">
                                                                                    <td class="col-2 selector-690-29">
                                                                                        <mat-label>{{k}}:</mat-label>
                                                                                    </td>
                                                                                    <td class="col-10 selector-690-31">

                                                                                        <div *ngIf="!obfuscate.includes(k);else other_content"
                                                                                            class="col-lg-9 col-md-9 lfx-u-mar-b-16">
                                                                                            <mat-form-field appearance="fill" style="width: 100%;">
                                                                                                <mat-label>{{k}}</mat-label>
                                                                                                <input matInput
                                                                                                    *ngIf="type != 'AWSBedrock' || k != 'modelType'"
                                                                                                    [(ngModel)]="sourceType.attributes[k]"
                                                                                                    id="mconf-dsrc-{{k}}-Input">
                                                                                            </mat-form-field>
                                                                                            <mat-form-field *ngIf="type === 'AWSBedrock' && k === 'modelType'" appearance="fill" style="width: 100%;">
                                                                                                <mat-label>Model Type</mat-label>
                                                                                                <mat-select [(value)]="sourceType.attributes.modelType" id="mconf-dsrc-modelType-Input">
                                                                                                    <mat-option *ngFor="let option of modelTypeOptions" [value]="option.value">
                                                                                                        {{ option.viewValue }}
                                                                                                    </mat-option>
                                                                                                </mat-select>
                                                                                            </mat-form-field>

                                                                                            <mat-checkbox
                                                                                                *ngIf="isVaultEnabled"
                                                                                                [checked]="sourceType.attributes[k+'_vault']"
                                                                                                [(ngModel)]="sourceType.attributes[k+'_vault']"
                                                                                                id="mconf-dsrc-{{k}}-VaultKey"
                                                                                                class="selector-690-35">
                                                                                                Vault-Key
                                                                                            </mat-checkbox>
                                                                                        </div>
                                                                                        <ng-template #other_content=""
                                                                                            class="">
                                                                                            <div *ngIf="k !== 'password';else password"
                                                                                                class="col-lg-9 col-md-9 lfx-u-mar-b-16">
                                                                                           
                                                                                                <mat-form-field appearance="fill" style="width: 100%;">
                                                                                                    <mat-label>{{k}}</mat-label>
                                                                                                    <input matInput type="password" [(ngModel)]="sourceType.attributes[k]" id="mconf-dsrc-{{k}}-Input">
                                                                                                </mat-form-field>


                                                                                                <mat-checkbox
                                                                                                    *ngIf="isVaultEnabled"
                                                                                                    [checked]="sourceType.attributes[k+'_vault']"
                                                                                                    [(ngModel)]="sourceType.attributes[k+'_vault']"
                                                                                                    id="mconf-dsrc-{{k}}-VaultKey"
                                                                                                    class="selector-690-41">
                                                                                                    Vault-Key
                                                                                                </mat-checkbox>
                                                                                            </div>
                                                                                        </ng-template>
                                                                                        <ng-template #password=""
                                                                                            class="selector-690-38">
                                                                                            <div
                                                                                                class="col-lg-9 col-md-9 lfx-u-mar-b-16">
                                                                                                <mat-form-field appearance="fill" style="width: 100%;">
                                                                                                    <mat-label>{{k}}</mat-label>
                                                                                                    <input matInput type="password" [(ngModel)]="keypass" (ngModelChange)="onPasswordChange()" id="mconf-dsrc-{{k}}-Input">
                                                                                                </mat-form-field>
                                                                                                <mat-checkbox
                                                                                                    *ngIf="isVaultEnabled"
                                                                                                    [checked]="sourceType.attributes[k+'_vault']"
                                                                                                    [(ngModel)]="sourceType.attributes[k+'_vault']"
                                                                                                    id="mconf-dsrc-{{k}}-VaultKey"
                                                                                                    class="selector-690-41">Vault-Key</mat-checkbox>
                                                                                            </div>
                                                                                        </ng-template>
                                                                                    </td>
                                                                                </div>
                                                                            </tr>
                                                                        </div>
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </mat-expansion-panel>
                                                    </mat-accordion>
                                                    <div *ngIf="isGithub">
                                                        <div class="col-md-12"
                                                            *ngIf="category && (category.toLowerCase().endsWith('rest')||category.toLowerCase().endsWith('git'))">
                                                            <div>
                                                                <modal-config-rest-datasource
                                                                    (connectionDetails)='getConnectionDetails($event)' (portDetails)='getPortDetails($event)'
                                                                    [type]="type"
                                                                    [isVaultEnabled]="isVaultEnabled"
                                                                    [capability]="capability"></modal-config-rest-datasource>
                                                            </div>
                                                        </div>
                                                    </div>
                                               
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div *ngIf="!view ">
                                        <div *ngIf="isGithub">
                                            <div *ngIf="!ConnectionEdit"
                                                class="col-lg-12 col-md-12 lfx-u-mar-b-16 d-flex justify-content-end">
                                                <button mat-raised-button style="background-color: #0a142f; color: white;"
                                                    [disabled]="false" (click)="testConnection()" 
                                                    onmouseover="this.style.backgroundColor='#0094ff'; this.style.color='white';" 
                                                    onmouseout="this.style.backgroundColor='#0a142f'; this.style.color='white';">
                                                    Test
                                                </button>
                                                <button mat-raised-button style="background-color: #0a142f; color: white;"
                                                    [disabled]="false" (click)="saveDatasource()" 
                                                    onmouseover="this.style.backgroundColor='#0094ff'; this.style.color='white';" 
                                                    onmouseout="this.style.backgroundColor='#0a142f'; this.style.color='white';">
                                                    Save
                                                </button>
                                            </div>
                                            <div *ngIf="ConnectionEdit"
                                                class="col-lg-12 col-md-12 lfx-u-mar-b-16 d-flex justify-content-end">
                                                <button mat-raised-button style="background-color: #0a142f; color: white;"
                                                    [disabled]="false" (click)="testConnection()" 
                                                    onmouseover="this.style.backgroundColor='#0094ff'; this.style.color='white';" 
                                                    onmouseout="this.style.backgroundColor='#0a142f'; this.style.color='white';">
                                                    Test
                                                </button>
                                                <button mat-raised-button style="background-color: #0a142f; color: white;"
                                                    [disabled]="false" (click)="saveDatasource()" 
                                                    onmouseover="this.style.backgroundColor='#0094ff'; this.style.color='white';" 
                                                    onmouseout="this.style.backgroundColor='#0a142f'; this.style.color='white';">
                                                    Update
                                                </button>
                                            </div>
                                        </div>
                                        <div *ngIf="!isGithub">
                                            <div class="col-lg-12 col-md-12 lfx-u-mar-b-16 d-flex justify-content-end">
                                                <button mat-raised-button style="background-color: #0a142f; color: white;"
                                                    [disabled]="false" (click)="testConnection()" 
                                                    onmouseover="this.style.backgroundColor='#0094ff'; this.style.color='white';" 
                                                    onmouseout="this.style.backgroundColor='#0a142f'; this.style.color='white';">
                                                    Test
                                                </button>
                                                <button mat-raised-button style="background-color: #0a142f; color: white;"
                                                    [disabled]="false" (click)="saveDatasource()" 
                                                    onmouseover="this.style.backgroundColor='#0094ff'; this.style.color='white';" 
                                                    onmouseout="this.style.backgroundColor='#0a142f'; this.style.color='white';">
                                                    Save
                                                </button>                                        
                                            </div>

                                        </div>
                                    </div>
                           
                                </div>
                            </mat-card>
                        </div>
                       
                    </div>
                </div>
            </div>
        </div>
    
</div> 
