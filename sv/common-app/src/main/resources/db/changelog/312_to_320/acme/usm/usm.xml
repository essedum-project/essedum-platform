<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xmlns:pro="http://www.liquibase.org/xml/ns/pro" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/pro http://www.liquibase.org/xml/ns/pro/liquibase-pro-4.1.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.1.xsd">
    
    
    <changeSet author="Leap (generated)" id="312to320-3v1-usm-1">
<preConditions onFail="MARK_RAN">
<sqlCheck expectedResult="0">
				SELECT COUNT(*) FROM usm_permissions WHERE  module='grh' AND permission='update-rule';
</sqlCheck>				
</preConditions>
<sql dbms="mysql,mssql">
			INSERT INTO usm_permissions (module,permission) VALUES('grh','update-rule')
</sql>
</changeSet>
<changeSet author="Leap (generated)" id="312to320-3v1-usm-2">
<preConditions onFail="MARK_RAN">
<sqlCheck expectedResult="0">
				SELECT COUNT(*) FROM usm_permission_api WHERE  api='/api/grh/v3/rule/update/' AND type='put' and permission_id=(select id FROM usm_permissions WHERE  module='grh' AND permission='update-rule');
</sqlCheck>				
</preConditions>
<sql dbms="mysql,mssql">
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/grh/v3/rule/update/', 'PUT', 0, 'Update Knowledge graph', id FROM usm_permissions WHERE module = 'grh'  AND permission ='update-rule';
</sql>
</changeSet>

<changeSet dbms="mysql,mssql" author="Leap (generated)" id="312to320-3v1-usm-6">
<preConditions onFail="MARK_RAN">
<sqlCheck expectedResult="1">
				SELECT count(*) FROM usm_role WHERE NAME = 'IT Portfolio Manager' and project_id IS NULL;
</sqlCheck>				
</preConditions>
<sql dbms="mysql,mssql">
			INSERT INTO usm_role_permissions (permission, ROLE ) SELECT MAX(p.id) pp, MAX(r.id) rr FROM usm_permissions p , usm_role r  WHERE r.name='IT Portfolio Manager' AND p.permission = 'update-rule' AND  p.module='grh' AND r.project_id IS NULL;
</sql>
</changeSet>

<!--changeSet author="Leap (generated)" id="312to320-3v1-usm-7">
	<sql dbms="mssql,mysql" splitStatements="true" stripComments="true">
		INSERT INTO usm_constant(item,project_name,item_value,project_id) VALUES ('Project Manager Side','leo1311','{"label":"Bizops","altText":"","icon":"cogs","url":"","children":[{"label":"Inbox","altText":"","icon":"inbox","url":"/landing/tickets/icms/inbox","children":[],"_id":199},{"label":"Case Management","altText":"","icon":"","url":"","children":[{"label":"Bulk Assign","altText":"","icon":"","url":"/landing/tickets/icms/unassignedItems","children":[],"_id":201},{"label":"Bulk Reassign","altText":"","icon":"","url":"/landing/tickets/icms/reassignItems","children":[],"_id":202},{"label":"Bulk Release","altText":"","icon":"","url":"/landing/tickets/icms/releaseItems","children":[],"_id":203},{"label":"Bulk Discard","altText":"","icon":"","url":"/landing/tickets/icms/bulkDiscard","children":[],"_id":204},{"label":"Bulk Upload","altText":"","icon":"","url":"/landing/tickets/icms/bulkupload","children":[],"_id":205},{"label":"Case Movement","altText":"","icon":"","url":"/landing/tickets/icms/caseMovement","children":[],"_id":206},{"label":"Bulk Transfer","altText":"","icon":"","url":"/landing/tickets/icms/bulkTransfer","children":[],"_id":207}],"_id":200},{"label":"Train Model","altText":"","icon":"folder","url":"./tickets/icms/trainModel","children":[],"_id":208},{"label":"Content Extraction","altText":"","icon":"","url":"./tickets/icms/fileReader","children":[],"_id":209}]}','2');
	</sql>
</changeSet>
<changeSet author="Leap" id="312to320-3v1-usm-8">
	<sql dbms="h2, mysql,mssql" splitStatements="true" stripComments="true">
		INSERT INTO usm_role (description, name, permission) values ('Bizops Admin', 'Bizops Admin', 0);
		INSERT INTO usm_user_project_role (portfolio_id,project_id,role_id,user_id) SELECT p.id, pr.id, r.id, '1' FROM usm_portfolio p, usm_project pr, usm_role r WHERE p.portfolio_name='Leo1311' AND pr.name='leo1311' AND r.name='Bizops Admin';  
	</sql> 
</changeSet>
<changeSet author="Leap" id="312to320-3v1-usm-9">
	<sql dbms="h2, mysql,mssql" splitStatements="true" stripComments="true">
		INSERT INTO usm_constant (item,project_name,item_value,project_id) SELECT 'Bizops Admin Side', 'leo1311', '{"label":"Form Setup","altText":"","icon":"cogs","url":"","children":[{"label":"Datasource","altText":"","icon":"","url":"./aip/connections","children":[],"_id":2},{"label":"Datasets","altText":"","icon":"","url":"./aip/datasets","children":[],"_id":3},{"label":"Schema","altText":"","icon":"","url":"./aip/schemas","children":[],"_id":4},{"label":"Pipelines","altText":"","icon":"","url":"./aip/pipelines","children":[],"_id":5},{"label":"Connections","altText":"","icon":"","url":"./aip/connections","children":[],"_id":6},{"label":"Schedule","altText":"","icon":"","url":"./aip/scheduler","children":[],"_id":7},{"label":"Logs","altText":"","icon":"","url":"./aibrain/jobs/logs","children":[],"_id":8}]}', a.id FROM usm_project a WHERE name='leo1311';
		INSERT INTO usm_constant (item,project_name,item_value,project_id) SELECT 'Bizops Admin Side', 'leo1311', '{"label":"Process Setup","altText":"","icon":"cogs","url":"./tickets/icms/processDeployment","children":[]}', a.id FROM usm_project a WHERE name='leo1311';
		INSERT INTO usm_constant (item,project_name,item_value,project_id) SELECT 'Bizops Admin Side', 'leo1311', '{"label":"Constants setup","altText":"","icon":"cogs","url":"./iamp-usm/dashconstant","children":[]}', a.id FROM usm_project a WHERE name='leo1311';
		INSERT INTO usm_constant (item,project_name,item_value,project_id) SELECT 'Bizops Admin Side', 'leo1311', '{"label":"Mail Template Setup","altText":"","icon":"cogs","url":"./tickets/icms/mailTemplateBuilder","children":[]}', a.id FROM usm_project a WHERE name='leo1311';
		INSERT INTO usm_constant (item,project_name,item_value,project_id) SELECT 'Bizops Admin Side', 'leo1311', '{"label":"Message Hub","altText":"","icon":"cogs","url":"","children":[{"label":"Apps","altText":"","icon":"","url":"./adapters/datasets/MYSQL/data/INFMSHPF22057/INFMSGPS41349/view","children":[],"_id":13},{"label":"Mailbox","altText":"","icon":"","url":"./adapters/datasets/MYSQL/data/INFMSHPF22057/INFMSGML79717/view","children":[],"_id":14}]}', a.id FROM usm_project a WHERE name='leo1311';
		INSERT INTO usm_constant (item,project_name,item_value,project_id) SELECT 'Bizops Admin Side', 'leo1311', '{"label":"Holiday Configuration","altText":"","icon":"calendar","url":"/landing/tickets/icms/holidayConfiguration","children":[]}', a.id FROM usm_project a WHERE name='leo1311';
		INSERT INTO usm_constant (item,project_name,item_value,project_id) SELECT 'Bizops Admin Side', 'leo1311', '{"label":"Shift Management","altText":"","icon":"folder","url":"/landing/tickets/icms/shiftManagement","children":[]}', a.id FROM usm_project a WHERE name='leo1311';
		INSERT INTO usm_constant (item,project_name,item_value,project_id) SELECT 'Bizops Admin Side', 'leo1311', '{"label":"User Shift Management","altText":"","icon":"folder","url":"/landing/tickets/icms/UsershiftMapping","children":[]}', a.id FROM usm_project a WHERE name='leo1311';
		INSERT INTO usm_constant (item,project_name,item_value,project_id) SELECT 'Bizops Admin Side', 'leo1311', '{"label":"User Process Mapping","altText":"","icon":"folder","url":"/landing/tickets/icms/UserProcessMapping","children":[]}', a.id FROM usm_project a WHERE name='leo1311';
		INSERT INTO usm_constant (item,project_name,item_value,project_id) SELECT 'Bizops Admin Side', 'leo1311', '{"label":"Code Hierarchy","altText":"","icon":"folder","url":"/landing/tickets/icms/codeHierarchy","children":[]}', a.id FROM usm_project a WHERE name='leo1311';
		INSERT INTO usm_constant (item,project_name,item_value,project_id) SELECT 'Bizops Admin Side', 'leo1311', '{"label":"Approval Hierarchy","altText":"","icon":"folder","url":"/landing/tickets/icms/approverMatrix","children":[]}', a.id FROM usm_project a WHERE name='leo1311';
		INSERT INTO usm_constant (item,project_name,item_value,project_id) SELECT 'Bizops Admin Side', 'leo1311', '{"label":"Escalation Hierarchy","altText":"","icon":"folder","url":"/landing/tickets/icms/escalationMatrix","children":[]}', a.id FROM usm_project a WHERE name='leo1311';
		INSERT INTO usm_constant(item,project_name,item_value,project_id) VALUES ('IT Portfolio Manager Side','leo1311','{"label":"Bizops","altText":"","icon":"cogs","url":"","children":[{"label":"Inbox","altText":"","icon":"inbox","url":"/landing/tickets/icms/inbox","children":[],"_id":199},{"label":"Case Management","altText":"","icon":"","url":"","children":[{"label":"Bulk Assign","altText":"","icon":"","url":"/landing/tickets/icms/unassignedItems","children":[],"_id":201},{"label":"Bulk Reassign","altText":"","icon":"","url":"/landing/tickets/icms/reassignItems","children":[],"_id":202},{"label":"Bulk Release","altText":"","icon":"","url":"/landing/tickets/icms/releaseItems","children":[],"_id":203},{"label":"Bulk Discard","altText":"","icon":"","url":"/landing/tickets/icms/bulkDiscard","children":[],"_id":204},{"label":"Bulk Upload","altText":"","icon":"","url":"/landing/tickets/icms/bulkupload","children":[],"_id":205},{"label":"Case Movement","altText":"","icon":"","url":"/landing/tickets/icms/caseMovement","children":[],"_id":206},{"label":"Bulk Transfer","altText":"","icon":"","url":"/landing/tickets/icms/bulkTransfer","children":[],"_id":207}],"_id":200},{"label":"Train Model","altText":"","icon":"folder","url":"./tickets/icms/trainModel","children":[],"_id":208},{"label":"Content Extraction","altText":"","icon":"","url":"./tickets/icms/fileReader","children":[],"_id":209}]}','2');
	</sql> 
</changeSet-->
<changeSet author="sumanth.kota" id="3v2-CAS-20250403-1">
	<sql dbms="h2, mysql,mssql, postgresql" splitStatements="true" stripComments="true">  
		UPDATE usm_constant SET item_value='{"label":"Cognitive Automation","icon":"assets/icons/Cognitive.svg","children":[{"label":"Dashboard","icon":"desktop","horizontal":true,"children":[{"label":"Automation Dashboard","icon":"","url":"./dynamicDashboard/grid/OCC/14","children":[],"_id":3},{"label":"Workload Dashboard","icon":"","url":"./dynamicDashboard/grid/OCC/2","children":[],"_id":4},{"label":"Telemetry Dashboard","icon":"","url":"./dynamicDashboard/grid/OCC/17","children":[],"_id":5},{"label":"CAS Execution","altText":"","icon":"","url":"./dynamicDashboard/grid/OCC/103487","children":[],"_id":68}],"url":"a","_id":2},{"label":"Discover","icon":"book","horizontal":true,"children":[{"label":"Workload Analytics","icon":"","url":"./dynamicDashboard/grid/OCC/2","children":[],"_id":7},{"label":"Correlation","icon":"","url":"./dynamicDashboard/grid/OCC/4","children":[],"_id":8}],"url":"a","_id":6},{"label":"Digitize","icon":"laptop","horizontal":true,"children":[{"label":"Process Model Store","icon":"","url":"./iamp-btf/SOP","children":[],"_id":10},{"label":"App Model Store","icon":"","url":"./iamp-btf/app-model","children":[],"_id":11}],"url":"a","_id":9},{"label":"Automate","icon":"list","horizontal":true,"children":[{"label":"Incident Dashboard","icon":"","url":"./iamp-cap/inputdetails","children":[],"_id":13},{"label":"Monitor Bots","icon":"","url":"./iamp-cap/viewstatistics","children":[],"_id":14},{"label":"My Workspace","icon":"","url":"./iamp-btf/entity/automation-work-flow","children":[],"_id":15},{"label":"Bot Store","icon":"","url":"./iamp-btf/entity/bot","children":[],"_id":16},{"label":"Build a Bot","icon":"","url":"./iamp-btf/bpmndemo","children":[],"_id":17},{"label":"Test a Bot","icon":"","url":"./iamp-btf/Testing","children":[],"_id":18}],"url":"a","_id":12},{"label":"Manage","icon":"files-o","horizontal":true,"children":[{"label":"Configuration Dashboard","icon":"","url":"./iamp-btf/entity/config-screen","children":[],"_id":20},{"label":"Configuration Entry","icon":"","url":"./iamp-btf/entity/configuration-entry","children":[],"_id":21},{"label":"Key Words","icon":"","url":"./iamp-btf/entity/key-words","children":[],"_id":22},{"label":"Schedule","icon":"","url":"./iamp-btf/entity/schedule","children":[],"_id":23},{"label":"Server","icon":"","url":"./iamp-btf/entity/server","children":[],"_id":24},{"label":"Technology","icon":"","url":"./iamp-btf/entity/technology","children":[],"_id":25},{"label":"Workflow Params","icon":"","url":"./iamp-btf/entity/workflow-params","children":[],"_id":26},{"label":"Groups","icon":"users","url":"./iamp-btf/entity/group","children":[],"_id":27},{"label":"Status Permission","icon":"file","url":"","children":[{"label":"Status","icon":"","url":"./iamp-btf/entity/bot-status","children":[],"_id":29},{"label":"Status Permission Mapping","icon":"","url":"./iamp-btf/entity/bot-status-permission","children":[],"_id":30}],"_id":28}],"url":"a","_id":19},{"label":"Admin","icon":"","url":"","children":[{"label":"Monitor","icon":"","url":"./iamp-btf/Cockpit","children":[],"_id":32},{"label":"Bot Execution Audit Trails","icon":"","url":"./iamp-btf/entity/bot-execution-audit-trails","children":[],"_id":33},{"label":"Schedule Background Process","icon":"","url":"./iamp-btf/entity/bot-factory-scheduler","children":[],"_id":34},{"label":"Refresh Jobs","icon":"","url":"./iamp-btf/refreshjobs","children":[],"_id":35},{"label":"API","icon":"","url":"./iamp-btf/docs","children":[],"_id":36},{"label":"Technology Property","icon":"","url":"./iamp-btf/entity/technology-properties","children":[],"_id":37},{"label":"Tool Adapter","icon":"","url":"","children":[{"label":"Adapter Purpose","icon":"list","url":"./iamp-tad/adapterPurpose-list","children":[],"_id":39},{"label":"Adapter Config","icon":"cog","url":"./iamp-tad/adapterConfig-list","children":[],"_id":40}],"_id":38}],"_id":31},{"label":"RPA","icon":"","horizontal":true,"children":[{"label":"Automation Dashboard","icon":"","url":"./dynamicDashboard/grid/OCC/57","children":[],"_id":42},{"label":"Bots","icon":"","horizontal":true,"children":[{"label":"Nodes","icon":"","url":"./iamp-cap/monitornode","children":[],"_id":44},{"label":"Bots","icon":"","url":"./iamp-cap/monitormapping","children":[],"_id":45},{"label":"Monitor bots","icon":"","url":"./iamp-cap/viewstatistics","children":[],"_id":46}],"_id":43},{"label":"Workflows","icon":"id-card","horizontal":true,"children":[{"label":"Workflows","icon":"","url":"./iamp-cap/viewworkflow","children":[],"_id":48},{"label":"Process workflow","icon":"","url":"./iamp-cap/processworkflow","children":[],"_id":49},{"label":"Monitor workflow","icon":"","url":"./iamp-cap/monitorworkflow","children":[],"_id":50},{"label":"Schedules","icon":"","url":"./iamp-cap/monitorschedule","children":[],"_id":51},{"label":"Logs","icon":"","url":"./iamp-cap/logscreenshot","children":[],"_id":52},{"label":"Headless Portal","icon":"","url":"./iamp-cap/headless","children":[],"_id":53}],"_id":47},{"label":"Scripts","icon":"book","horizontal":true,"children":[{"label":"Scripts","icon":"","url":"./iamp-cap/monitorscript","children":[],"_id":55},{"label":"Execute scripts","icon":"","url":"./iamp-cap/executescript","children":[],"_id":56},{"label":"View execution status","icon":"","url":"./iamp-cap/monitorscriptstatus","children":[],"_id":57}],"_id":54},{"label":"Probe","icon":"tasks","horizontal":true,"children":[{"label":"Schedule Downtime","icon":"","url":"./iamp-cap/viewdowntime","children":[],"_id":59},{"label":"Log Screenshots","icon":"","url":"./iamp-cap/logscreenshot","_id":60}],"_id":58},{"label":"Administration","icon":"","children":[{"label":"Bot Release","url":"./iamp-cap/monitoragent","icon":"","_id":62},{"label":"Categories","url":"./iamp-cap/monitorcategory","icon":"","_id":63},{"label":"Incident MetaData Mapping","url":"./iamp-cap/incidentmetadatamapping","icon":"","_id":64},{"label":"Configuration Mapping","icon":"","url":"./iamp-cap/viewconfig","children":[],"_id":65},{"label":"Email Template Mapping","icon":"","url":"./iamp-cap/viewtemplate","children":[],"_id":66}],"_id":61},{"label":"Vaults","icon":"","url":"./iamp-cap/monitorvault","children":[],"_id":67}],"_id":41}],"horizontal":true}' 
		WHERE item LIKE '%IT Portfolio%' AND item_value LIKE '%Cognitive Automation%' AND project_name='leo1311';
	</sql> 
</changeSet>
</databaseChangeLog>
