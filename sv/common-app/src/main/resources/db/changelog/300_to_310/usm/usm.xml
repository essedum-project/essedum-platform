<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xmlns:pro="http://www.liquibase.org/xml/ns/pro" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/pro http://www.liquibase.org/xml/ns/pro/liquibase-pro-4.1.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.1.xsd">
    
	<changeSet author="Leap" id="3v0-usm-5">
		<preConditions onFail="MARK_RAN">
			<not>
			<columnExists tableName="usm_users"
				columnName="designation" />
			</not>
		</preConditions>
        <addColumn tableName="usm_users">
            <column name="designation" type="VARCHAR(255)" />
            </addColumn>
    </changeSet>

	<changeSet author="Leap" id="3v1-usm-240719-1">
		<insert tableName="usm_constant">
			<column name="item" value='icip.schema.system' />
			<column name="project_name" value='Core' />
            <column name="item_value" value='[{"KG":[{"Capability":"Node","default":true},{"Capability":"Edge"},{"Capability":""}]},{"Feast":[{"Capability":"C1","default":true},{"Capability":"C2"}]},{"ABC":[]}]' />
            <column name="project_id" value='1' />
		</insert>
	</changeSet>


	<changeSet author="Leap" id="3v1-usm-240814-1">
		<sql>
			UPDATE usm_permission_api SET api = REPLACE(api, '/api/grh-new/', '/api/grh/v3/') WHERE api LIKE '/api/grh-new/%';
		</sql>
	</changeSet>

	<changeSet author="Leap (generated)" id="3v0-usm-240909-6">
		<sql dbms="mysql,mssql,h2,postgres" splitStatements="true" stripComments="true">
		INSERT INTO usm_constant (item, project_name, item_value, project_id) VALUES ('exportfile.download.path', 'Core', '/app/uploads/', 1);
		</sql>
	</changeSet>

	<changeSet author="Leap" id="3v1-usm-240926-1">
		<sql>
			UPDATE usm_permission_api SET api = REPLACE(api, '/api/', '/api/aip/') WHERE (SELECT module FROM usm_permissions WHERE id=permission_id) = 'cip';
		</sql>
	</changeSet>
	<changeSet author="Leap" id="3v1-usm-240926-2">
		<sql>
			UPDATE usm_role SET name  = 'IT Portfolio Manager', description = 'IT Portfolio Manager' WHERE name = 'IT Portfolio Manager' AND project_id IS NULL;
		</sql>
	</changeSet>
	<changeSet author="Leap - MA" id="3v1-usm-241024-1-1">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
				SELECT COUNT(*) FROM usm_role WHERE NAME ='IT Portfolio Manager' and project_id IS NULL;
            </sqlCheck>
        </preConditions>
        <sql>
            UPDATE usm_role SET  NAME ='IT Portfolio Manager' WHERE  NAME ='Portfolio Manager' and project_id IS NULL;
        </sql>
    </changeSet>
	<changeSet author="Leap" id="3v1-usm-240926-3">
		<sql dbms="mysql" splitStatements="true" stripComments="false">
			INSERT INTO usm_permissions (module, permission) VALUES ('cip', 'prompt-create');
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/aip/prompt/save.*', 'POST', 0, 'prompt-create', id FROM usm_permissions WHERE module = 'cip'  AND permission ='prompt-create' limit 1;
		    INSERT INTO usm_role_permissions (permission, role ) SELECT MAX(p.id) pp, MAX(r.id) rr FROM usm_permissions p , usm_role r  WHERE r.name='IT Portfolio Manager' AND p.permission = 'prompt-create' AND  p.module='cip' AND r.project_id IS NULL;
		    INSERT INTO usm_permissions (module, permission) VALUES ('cip', 'prompt-edit');
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/aip/prompt/update.*', 'POST', 0, 'prompt-edit', id FROM usm_permissions WHERE module = 'cip'  AND permission ='prompt-edit' limit 1;
		    INSERT INTO usm_role_permissions (permission, role ) SELECT MAX(p.id) pp, MAX(r.id) rr FROM usm_permissions p , usm_role r  WHERE r.name='IT Portfolio Manager' AND p.permission = 'prompt-edit' AND  p.module='cip' AND r.project_id IS NULL;
			
		    INSERT INTO usm_permissions (module, permission) VALUES ('cip', 'prompt-deleteById');
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/aip/prompt/delete.*', 'DELETE', 0, 'prompt-deleteById', id FROM usm_permissions WHERE module = 'cip'  AND permission ='prompt-deleteById' limit 1;
		    INSERT INTO usm_role_permissions (permission, role ) SELECT MAX(p.id) pp, MAX(r.id) rr FROM usm_permissions p , usm_role r  WHERE r.name='IT Portfolio Manager' AND p.permission = 'prompt-deleteById' AND  p.module='cip' AND r.project_id IS NULL;
			
			INSERT INTO usm_permissions (module, permission) VALUES ('cip', 'Fileserver-uploadTempFileFromData');
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/aip/fileserver/uploadTempFileFromData', 'POST', 0, 'Fileserver-uploadTempFileFromData', id FROM usm_permissions WHERE module = 'cip'  AND permission ='Fileserver-uploadTempFileFromData' limit 1;
		    INSERT INTO usm_role_permissions (permission, role ) SELECT MAX(p.id) pp, MAX(r.id) rr FROM usm_permissions p , usm_role r  WHERE r.name='IT Portfolio Manager' AND p.permission = 'Fileserver-uploadTempFileFromData' AND  p.module='cip' AND r.project_id IS NULL;
		    
		    INSERT INTO usm_permissions (module, permission) VALUES ('cip', 'v1-Event-Trigger-generateScript');
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/aip/service/v1/event/trigger/generateScript_DragNDropLite.*', 'POST', 0, 'v1-Event-Trigger-generateScript', id FROM usm_permissions WHERE module = 'cip'  AND permission ='v1-Event-Trigger-generateScript' limit 1;
			INSERT INTO usm_role_permissions (permission, role ) SELECT MAX(p.id) pp, MAX(r.id) rr FROM usm_permissions p , usm_role r  WHERE r.name='IT Portfolio Manager' AND p.permission = 'v1-Event-Trigger-generateScript' AND  p.module='cip' AND r.project_id IS NULL;
			
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/aip/service/v1/streamingServices/update', 'PUT', 0, 'cip-post-api-streamingServices-update', id FROM usm_permissions WHERE module = 'cip'  AND permission ='StreamingServices-update' limit 1;
			INSERT INTO usm_role_permissions (permission, role ) SELECT MAX(p.id) pp, MAX(r.id) rr FROM usm_permissions p , usm_role r  WHERE r.name='IT Portfolio Manager' AND p.permission = 'StreamingServices-update' AND  p.module='cip' AND r.project_id IS NULL;
			INSERT INTO usm_role_permissions (permission, role ) SELECT MAX(p.id) pp, MAX(r.id) rr FROM usm_permissions p , usm_role r  WHERE r.name='Project Client' AND p.permission = 'StreamingServices-update' AND  p.module='cip' AND r.project_id IS NULL;
			
		    
			INSERT INTO usm_permissions (module, permission) VALUES ('cip', 'chain-editNameAndDesc-ByID');
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/aip/chain/editNameAndDesc/[0-9].*/[A-Za-z0-9- _]*.*', 'POST', 1, 'chain-editNameAndDesc-ByID', id FROM usm_permissions WHERE module = 'cip'  AND permission ='chain-editNameAndDesc-ByID' limit 1;
			INSERT INTO usm_role_permissions (permission, role ) SELECT MAX(p.id) pp, MAX(r.id) rr FROM usm_permissions p , usm_role r  WHERE r.name='IT Portfolio Manager' AND p.permission = 'chain-editNameAndDesc-ByID' AND  p.module='cip' AND r.project_id IS NULL;
			
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/aip/service/v1/streamingServices/add', 'POST', 1, 'cip-post-api-streamingServices-add', id FROM usm_permissions WHERE module = 'cip'  AND permission ='streamingServices-add' limit 1;
			INSERT INTO usm_role_permissions (permission, role ) SELECT MAX(p.id) pp, MAX(r.id) rr FROM usm_permissions p , usm_role r  WHERE r.name='IT Portfolio Manager' AND p.permission = 'streamingServices-add' AND  p.module='cip' AND r.project_id IS NULL;
			
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/aip/chainjob/update/[A-Za-z0-9- _.]*/[A-Za-z0-9- _.]*/[A-Za-z0-9- _]*/[A-Za-z0-9- _]*.*', 'POST', 1, 'cip-get-api-chainjob', id FROM usm_permissions WHERE module = 'cip'  AND permission ='chainjob-update' limit 1;
			INSERT INTO usm_role_permissions (permission, role ) SELECT MAX(p.id) pp, MAX(r.id) rr FROM usm_permissions p , usm_role r  WHERE r.name='IT Portfolio Manager' AND p.permission = 'chainjob-update' AND  p.module='cip' AND r.project_id IS NULL;
			
			INSERT INTO usm_permissions (module, permission) VALUES ('cip', 'copyBlueprint');
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/copyDatasets/.*', 'POST', 1, 'copy blueprint', id FROM usm_permissions WHERE module = 'cip'  AND permission ='copyBlueprint' limit 1;
			INSERT INTO usm_role_permissions (permission, role ) SELECT MAX(p.id) pp, MAX(r.id) rr FROM usm_permissions p , usm_role r  WHERE r.name='IT Portfolio Manager' AND p.permission = 'copyBlueprint' AND  p.module='cip' AND r.project_id IS NULL;
			
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/aip/service/v1/models/register.*', 'POST', 0, 'register model', id FROM usm_permissions WHERE module = 'cip'  AND permission ='model-create' limit 1;
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/aip/service/v1/models/updateModel.*', 'POST', 0, 'edit model', id FROM usm_permissions WHERE module = 'cip'  AND permission ='model-edit' limit 1;
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/aip/service/v1/models/.*', 'POST', 0, 'deploy model', id FROM usm_permissions WHERE module = 'cip'  AND permission ='model-deploy' limit 1;
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/aip/service/v1/models/delete.*', 'DELETE', 0, 'delete model', id FROM usm_permissions WHERE module = 'cip'  AND permission ='model-delete' limit 1;
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/aip/service/v1/endpoints/register.*', 'POST', 0, 'register endpoint', id FROM usm_permissions WHERE module = 'cip'  AND permission ='endpoint-create' limit 1;
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/aip/service/v1/endpoints/updateEndpoint.*', 'POST', 0, 'edit endpoint', id FROM usm_permissions WHERE module = 'cip'  AND permission ='endpoint-edit' limit 1;
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/aip/service/v1/endpoints.*', 'DELETE', 0, 'delete endpoint', id FROM usm_permissions WHERE module = 'cip'  AND permission ='endpoint-delete' limit 1;
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/aip/service/v1/add/tags.*', 'POST', 0, 'add tags to model/endpoint', id FROM usm_permissions WHERE module = 'cip'  AND permission ='model-tag' limit 1;
	
		</sql>
		<sql dbms="mssql" splitStatements="true" stripComments="false">
			INSERT INTO usm_permissions (module, permission) VALUES ('cip', 'prompt-create');
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT TOP 1 '/api/aip/prompt/save.*', 'POST', 0, 'prompt-create', id FROM usm_permissions WHERE module = 'cip'  AND permission ='prompt-create';
		    INSERT INTO usm_role_permissions (permission, role ) SELECT MAX(p.id) pp, MAX(r.id) rr FROM usm_permissions p , usm_role r  WHERE r.name='IT Portfolio Manager' AND p.permission = 'prompt-create' AND  p.module='cip' AND r.project_id IS NULL;
		    INSERT INTO usm_permissions (module, permission) VALUES ('cip', 'prompt-edit');
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT TOP 1 '/api/aip/prompt/update.*', 'POST', 0, 'prompt-edit', id FROM usm_permissions WHERE module = 'cip'  AND permission ='prompt-edit';
		    INSERT INTO usm_role_permissions (permission, role ) SELECT MAX(p.id) pp, MAX(r.id) rr FROM usm_permissions p , usm_role r  WHERE r.name='IT Portfolio Manager' AND p.permission = 'prompt-edit' AND  p.module='cip' AND r.project_id IS NULL;
			
		    INSERT INTO usm_permissions (module, permission) VALUES ('cip', 'prompt-deleteById');
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT TOP 1 '/api/aip/prompt/delete.*', 'DELETE', 0, 'prompt-deleteById', id FROM usm_permissions WHERE module = 'cip'  AND permission ='prompt-deleteById';
		    INSERT INTO usm_role_permissions (permission, role ) SELECT MAX(p.id) pp, MAX(r.id) rr FROM usm_permissions p , usm_role r  WHERE r.name='IT Portfolio Manager' AND p.permission = 'prompt-deleteById' AND  p.module='cip' AND r.project_id IS NULL;
			
			INSERT INTO usm_permissions (module, permission) VALUES ('cip', 'Fileserver-uploadTempFileFromData');
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT TOP 1 '/api/aip/fileserver/uploadTempFileFromData', 'POST', 0, 'Fileserver-uploadTempFileFromData', id FROM usm_permissions WHERE module = 'cip'  AND permission ='Fileserver-uploadTempFileFromData';
		    INSERT INTO usm_role_permissions (permission, role ) SELECT MAX(p.id) pp, MAX(r.id) rr FROM usm_permissions p , usm_role r  WHERE r.name='IT Portfolio Manager' AND p.permission = 'Fileserver-uploadTempFileFromData' AND  p.module='cip' AND r.project_id IS NULL;
		    
		    INSERT INTO usm_permissions (module, permission) VALUES ('cip', 'v1-Event-Trigger-generateScript');
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT TOP 1 '/api/aip/service/v1/event/trigger/generateScript_DragNDropLite.*', 'POST', 0, 'v1-Event-Trigger-generateScript', id FROM usm_permissions WHERE module = 'cip'  AND permission ='v1-Event-Trigger-generateScript';
			INSERT INTO usm_role_permissions (permission, role ) SELECT MAX(p.id) pp, MAX(r.id) rr FROM usm_permissions p , usm_role r  WHERE r.name='IT Portfolio Manager' AND p.permission = 'v1-Event-Trigger-generateScript' AND  p.module='cip' AND r.project_id IS NULL;
			
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT TOP 1 '/api/aip/service/v1/streamingServices/update', 'PUT', 0, 'cip-post-api-streamingServices-update', id FROM usm_permissions WHERE module = 'cip'  AND permission ='StreamingServices-update';
			INSERT INTO usm_role_permissions (permission, role ) SELECT MAX(p.id) pp, MAX(r.id) rr FROM usm_permissions p , usm_role r  WHERE r.name='IT Portfolio Manager' AND p.permission = 'StreamingServices-update' AND  p.module='cip' AND r.project_id IS NULL;
			INSERT INTO usm_role_permissions (permission, role ) SELECT MAX(p.id) pp, MAX(r.id) rr FROM usm_permissions p , usm_role r  WHERE r.name='Project Client' AND p.permission = 'StreamingServices-update' AND  p.module='cip' AND r.project_id IS NULL;
			
		    
			INSERT INTO usm_permissions (module, permission) VALUES ('cip', 'chain-editNameAndDesc-ByID');
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT TOP 1 '/api/aip/chain/editNameAndDesc/[0-9].*/[A-Za-z0-9- _]*.*', 'POST', 1, 'chain-editNameAndDesc-ByID', id FROM usm_permissions WHERE module = 'cip'  AND permission ='chain-editNameAndDesc-ByID';
			INSERT INTO usm_role_permissions (permission, role ) SELECT MAX(p.id) pp, MAX(r.id) rr FROM usm_permissions p , usm_role r  WHERE r.name='IT Portfolio Manager' AND p.permission = 'chain-editNameAndDesc-ByID' AND  p.module='cip' AND r.project_id IS NULL;
			
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT TOP 1 '/api/aip/service/v1/streamingServices/add', 'POST', 1, 'cip-post-api-streamingServices-add', id FROM usm_permissions WHERE module = 'cip'  AND permission ='streamingServices-add';
			INSERT INTO usm_role_permissions (permission, role ) SELECT MAX(p.id) pp, MAX(r.id) rr FROM usm_permissions p , usm_role r  WHERE r.name='IT Portfolio Manager' AND p.permission = 'streamingServices-add' AND  p.module='cip' AND r.project_id IS NULL;
			
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT TOP 1 '/api/aip/chainjob/update/[A-Za-z0-9- _.]*/[A-Za-z0-9- _.]*/[A-Za-z0-9- _]*/[A-Za-z0-9- _]*.*', 'POST', 1, 'cip-get-api-chainjob', id FROM usm_permissions WHERE module = 'cip'  AND permission ='chainjob-update';
			INSERT INTO usm_role_permissions (permission, role ) SELECT MAX(p.id) pp, MAX(r.id) rr FROM usm_permissions p , usm_role r  WHERE r.name='IT Portfolio Manager' AND p.permission = 'chainjob-update' AND  p.module='cip' AND r.project_id IS NULL;
			
			INSERT INTO usm_permissions (module, permission) VALUES ('cip', 'copyBlueprint');
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT TOP 1 '/api/copyDatasets/.*', 'POST', 1, 'copy blueprint', id FROM usm_permissions WHERE module = 'cip'  AND permission ='copyBlueprint';
			INSERT INTO usm_role_permissions (permission, role ) SELECT MAX(p.id) pp, MAX(r.id) rr FROM usm_permissions p , usm_role r  WHERE r.name='IT Portfolio Manager' AND p.permission = 'copyBlueprint' AND  p.module='cip' AND r.project_id IS NULL;
			
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT TOP 1 '/api/aip/service/v1/models/register.*', 'POST', 0, 'register model', id FROM usm_permissions WHERE module = 'cip'  AND permission ='model-create';
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT TOP 1 '/api/aip/service/v1/models/updateModel.*', 'POST', 0, 'edit model', id FROM usm_permissions WHERE module = 'cip'  AND permission ='model-edit';
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT TOP 1 '/api/aip/service/v1/models/.*', 'POST', 0, 'deploy model', id FROM usm_permissions WHERE module = 'cip'  AND permission ='model-deploy';
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT TOP 1 '/api/aip/service/v1/models/delete.*', 'DELETE', 0, 'delete model', id FROM usm_permissions WHERE module = 'cip'  AND permission ='model-delete';
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT TOP 1 '/api/aip/service/v1/endpoints/register.*', 'POST', 0, 'register endpoint', id FROM usm_permissions WHERE module = 'cip'  AND permission ='endpoint-create';
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT TOP 1 '/api/aip/service/v1/endpoints/updateEndpoint.*', 'POST', 0, 'edit endpoint', id FROM usm_permissions WHERE module = 'cip'  AND permission ='endpoint-edit';
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT TOP 1 '/api/aip/service/v1/endpoints.*', 'DELETE', 0, 'delete endpoint', id FROM usm_permissions WHERE module = 'cip'  AND permission ='endpoint-delete';
			INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT TOP 1 '/api/aip/service/v1/add/tags.*', 'POST', 0, 'add tags to model/endpoint', id FROM usm_permissions WHERE module = 'cip'  AND permission ='model-tag';
	
		</sql>		
	</changeSet>
	<changeSet author="Leap" id="3v1-usm-241008-1">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                SELECT COUNT(*) FROM usm_permission_api WHERE api='/api/multiPartDashboardConf' AND permission_id=(SELECT id FROM usm_permissions WHERE permission='dbs-all');
            </sqlCheck>
        </preConditions>
        <sql>
                INSERT INTO usm_permission_api (api, TYPE, permission_id, is_whitelisted, DESCRIPTION)
                VALUES
                ('/api/multiPartDashboardConf', 'POST', (SELECT id FROM usm_permissions WHERE permission = 'dbs-all'), 0, 'save dashboard creation');
        </sql>
    </changeSet>
    <changeSet author="Leap" id="3v1-usm-241008-2">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                SELECT COUNT(*) FROM usm_permission_api WHERE api='/api/user-project-roles-list' AND permission_id=(SELECT id FROM usm_permissions WHERE permission='cfm-all');
            </sqlCheck>
        </preConditions>
        <sql>
            INSERT INTO usm_permission_api (api, TYPE, permission_id, is_whitelisted, DESCRIPTION)
            VALUES
            ('/api/user-project-roles-list', 'POST',  (SELECT id FROM usm_permissions WHERE permission = 'cfm-all'), 0, 'create a new user project role');
        </sql>
    </changeSet>
    <changeSet author="Leap" id="3v1-usm-241015-1">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                SELECT COUNT(*) FROM usm_role_permissions WHERE ROLE=11 AND permission=(SELECT id FROM usm_permissions WHERE permission='cfm-all');
            </sqlCheck>
        </preConditions>
        <sql>
            INSERT INTO usm_role_permissions (ROLE, permission)
            SELECT r.id, p.id
            FROM usm_role r, usm_permissions p
            WHERE r.name ='Project Admin' AND p.permission='cfm-all';
        </sql>
    </changeSet>
	<changeSet author="Leap" id="3v0-usm-310570">
		<preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                SELECT COUNT(*) FROM usm_constant WHERE item = 'Admin Side' AND item_value LIKE '%EGP Mgmt%' AND project_name = 'Core' AND project_id = '1'
            </sqlCheck>
        </preConditions>
		<sql dbms="h2, mysql, postgresql" splitStatements="true" stripComments="true">  
			INSERT INTO usm_constant(item,project_name,item_value,project_id) VALUES ('Admin Side','Core','{\"label\":\"EGP Mgmt\",\"icon\":\"gamepad\",\"url\":\"\",\"children\":[{\"label\":\"Dashboard\",\"icon\":\"\",\"url\":\"./iamp-iegp/dashboard\",\"children\":[{\"label\":\"Admin Dashboard\",\"icon\":\"\",\"url\":\"./iamp-iegp/dashboard\",\"children\":[],\"_id\":3},{\"label\":\"Insights\",\"icon\":\"\",\"url\":\"./iamp-iegp/insights\",\"children\":[],\"_id\":4}],\"_id\":2},{\"label\":\"Application Configuration\",\"icon\":\"\",\"url\":\"\",\"children\":[{\"label\":\"Widget Settings\",\"icon\":\"\",\"url\":\"./iamp-iegp/widget\",\"children\":[],\"_id\":6},{\"label\":\"Application Settings\",\"icon\":\"\",\"url\":\"./iamp-iegp/config\",\"children\":[],\"_id\":7},{\"label\":\"Master User Group\",\"icon\":\"\",\"url\":\"./iamp-iegp/masterUserGroup\",\"children\":[],\"_id\":8},{\"label\":\"User Group\",\"icon\":\"\",\"url\":\"./iamp-iegp/userGroup\",\"children\":[],\"_id\":9},{\"label\":\"User Info\",\"icon\":\"\",\"url\":\"./iamp-iegp/userinfo\",\"children\":[],\"_id\":11},{\"label\":\"Meta Data\",\"icon\":\"\",\"url\":\"./iamp-iegp/metadata\",\"children\":[],\"_id\":12},{\"label\":\"Variable\",\"icon\":\"\",\"url\":\"./iamp-iegp/variable\",\"children\":[],\"_id\":68}],\"_id\":5},{\"label\":\"Game Configuration\",\"icon\":\"\",\"url\":\"\",\"children\":[{\"label\":\"Metric\",\"icon\":\"\",\"url\":\"./iamp-iegp/metric\",\"children\":[],\"_id\":14},{\"label\":\"Sprint\",\"icon\":\"\",\"url\":\"\",\"children\":[{\"label\":\"Sprint\",\"icon\":\"\",\"url\":\"./iamp-iegp/sprint\",\"children\":[],\"_id\":16},{\"label\":\"Sprint Metric Association\",\"icon\":\"\",\"url\":\"./iamp-iegp/sprintmetricassociation\",\"children\":[],\"_id\":17},{\"label\":\"Sprint User Goals\",\"icon\":\"\",\"url\":\"./iamp-iegp/sprintusergoals\",\"children\":[],\"_id\":18},{\"label\":\"Copy Sprint\",\"icon\":\"\",\"url\":\"./iamp-iegp/copysprint\",\"children\":[],\"_id\":19}],\"_id\":15},{\"label\":\"Metaphor\",\"icon\":\"\",\"url\":\"./iamp-iegp/metaphor\",\"children\":[],\"_id\":20},{\"label\":\"Rule Engine\",\"icon\":\"\",\"url\":\"./iamp-iegp/ruleengine\",\"children\":[{\"label\":\"Rule Set\",\"icon\":\"\",\"url\":\"./iamp-iegp/ruleengine\",\"children\":[],\"_id\":48},{\"label\":\"Formula Engine\",\"icon\":\"\",\"url\":\"./iamp-iegp/formulaengine\",\"children\":[],\"_id\":49},{\"label\":\"Rule Orchestration\",\"icon\":\"\",\"url\":\"./iamp-iegp/orchestratedrules\",\"children\":[],\"_id\":50}],\"_id\":47},{\"label\":\"Rewards\",\"icon\":\"\",\"url\":\"\",\"children\":[{\"label\":\"Currency\",\"icon\":\"\",\"url\":\"./iamp-iegp/currency\",\"children\":[],\"_id\":22},{\"label\":\"Reward Category\",\"icon\":\"\",\"url\":\"./iamp-iegp/rewardcategory\",\"children\":[],\"_id\":23},{\"label\":\"Level Reward Mapping\",\"icon\":\"\",\"url\":\"./iamp-iegp/itemlevelcatalog\",\"children\":[],\"_id\":24}],\"_id\":21},{\"label\":\"Avatar\",\"icon\":\"\",\"url\":\"./iamp-iegp/avatar\",\"children\":[],\"_id\":25}],\"_id\":13},{\"label\":\"Game Mechanics\",\"icon\":\"gamepad\",\"url\":\"\",\"children\":[{\"label\":\"Behaviour\",\"icon\":\"\",\"url\":\"./iamp-iegp/behavior\",\"children\":[],\"_id\":27},{\"label\":\"Badge\",\"icon\":\"\",\"url\":\"./iamp-iegp/badge\",\"children\":[],\"_id\":28},{\"label\":\"Level\",\"icon\":\"\",\"url\":\"./iamp-iegp/level\",\"children\":[],\"_id\":29},{\"label\":\"Challenge\",\"icon\":\"\",\"url\":\"./iamp-iegp/challenge\",\"children\":[],\"_id\":30},{\"label\":\"Literacy\",\"icon\":\"\",\"url\":\"\",\"children\":[{\"label\":\"Content Type\",\"icon\":\"\",\"url\":\"./iamp-iegp/contenttype\",\"children\":[],\"_id\":32},{\"label\":\"Quiz\",\"icon\":\"\",\"url\":\"./iamp-iegp/quiz\",\"children\":[],\"_id\":33},{\"label\":\"Content Set\",\"icon\":\"\",\"url\":\"./iamp-iegp/contentset\",\"children\":[],\"_id\":34}],\"_id\":31},{\"label\":\"Treasure Hunt\",\"icon\":\"\",\"url\":\"./iamp-iegp/treasurehunt\",\"children\":[],\"_id\":35},{\"label\":\"Behaviour Group\",\"icon\":\"\",\"url\":\"./iamp-iegp/behaviourgroup\",\"children\":[],\"_id\":36},{\"label\":\"Progress Bar\",\"icon\":\"\",\"url\":\"./iamp-iegp/progressbar\",\"children\":[],\"_id\":37}],\"_id\":26}]}','1');		
		</sql> 
			<sql dbms="mssql" splitStatements="true" stripComments="true">  
            INSERT INTO usm_constant(item,project_name,item_value,project_id) VALUES ('Admin Side','Core','{"label":"EGP Mgmt","icon":"gamepad","url":"./iamp-iegp/dashboard","children":[{"label":"Dashboard","icon":"","url":"","children":[{"label":"Admin Dashboard","icon":"","url":"./iamp-iegp/dashboard","children":[],"_id":29},{"label":"Insights","icon":"","url":"./iamp-iegp/insights","children":[],"_id":30}],"_id":28},{"label":"Application Configuration","icon":"","url":"","children":[{"label":"Widget Settings","icon":"","url":"./iamp-iegp/widget","children":[],"_id":32},{"label":"Application Settings","icon":"","url":"./iamp-iegp/config","children":[],"_id":33},{"label":"Master User Group","icon":"","url":"./iamp-iegp/masterUserGroup","children":[],"_id":34},{"label":"User Group","icon":"","url":"./iamp-iegp/userGroup","children":[],"_id":35},{"label":"User Info","icon":"","url":"./iamp-iegp/userinfo","children":[],"_id":37},{"label":"Meta Data","icon":"","url":"./iamp-iegp/metadata","children":[],"_id":38},{"label":"Variable","icon":"","url":"./iamp-iegp/variable","children":[],"_id":68}],"_id":31},{"label":"Game Configuration","icon":"list","url":"","children":[{"label":"Metric","icon":"","url":"./iamp-iegp/metric","children":[],"_id":40},{"label":"Sprint","icon":"calendar","url":"./iamp-iegp/sprint","children":[{"label":"Sprint","icon":"","url":"./iamp-iegp/sprint","children":[],"_id":42},{"label":"Sprint Metric Association","icon":"","url":"./iamp-iegp/sprintmetricassociation","children":[],"_id":43},{"label":"Sprint User Goals","icon":"","url":"./iamp-iegp/sprintusergoals","children":[],"_id":44},{"label":"Copy Sprint","icon":"","url":"./iamp-iegp/copysprint","children":[],"_id":45}],"_id":41},{"label":"Metaphor","icon":"","url":"./iamp-iegp/metaphor","children":[],"_id":46},{"label":"Rule Engine","icon":"","url":"./iamp-iegp/ruleengine","children":[{"label":"Rule Set","icon":"","url":"./iamp-iegp/ruleengine","children":[],"_id":48},{"label":"Formula Engine","icon":"","url":"./iamp-iegp/formulaengine","children":[],"_id":49},{"label":"Rule Orchestration","icon":"","url":"./iamp-iegp/orchestratedrules","children":[],"_id":50}],"_id":47},{"label":"Rewards","icon":"gifts","url":"","children":[{"label":"Currency","icon":"","url":"./iamp-iegp/currency","children":[],"_id":52},{"label":"Reward Category","icon":"","url":"./iamp-iegp/rewardcategory","children":[],"_id":53},{"label":"Level Reward Mapping","icon":"","url":"./iamp-iegp/itemlevelcatalog","children":[],"_id":54}],"_id":51},{"label":"Avatar","icon":"smile-o","url":"./iamp-iegp/avatar","children":[],"_id":55}],"_id":39},{"label":"Game Mechanics","icon":"gamepad","url":"","children":[{"label":"Behaviour","icon":"","url":"./iamp-iegp/behavior","children":[],"_id":57},{"label":"Badge","icon":"","url":"./iamp-iegp/badge","children":[],"_id":58},{"label":"Level","icon":"","url":"./iamp-iegp/level","children":[],"_id":59},{"label":"Challenge","icon":"","url":"./iamp-iegp/challenge","children":[],"_id":60},{"label":"Literacy","icon":"","url":"","children":[{"label":"Content Type","icon":"","url":"./iamp-iegp/contenttype","children":[],"_id":62},{"label":"Quiz","icon":"","url":"./iamp-iegp/quiz","children":[],"_id":63},{"label":"Content Set","icon":"","url":"./iamp-iegp/contentset","children":[],"_id":64}],"_id":61},{"label":"Treasure Hunt","icon":"","url":"./iamp-iegp/treasurehunt","children":[],"_id":65},{"label":"Behaviour Group","icon":"","url":"./iamp-iegp/behaviourgroup","children":[],"_id":66},{"label":"Progress Bar","icon":"","url":"./iamp-iegp/progressbar","children":[],"_id":67}],"_id":56}]}','1');  		
         </sql> 
	</changeSet>
	
	
	<changeSet author="Leap" id="3v1-usm-20241023-1">
	<preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                 select count(*) from usm_constant where item='application.tickets.dataset'
            </sqlCheck>
        </preConditions>
		<sql dbms="h2, mysql,mssql" splitStatements="true" stripComments="true">  
           INSERT INTO usm_constant(item,project_name,item_value,project_id) VALUES ('application.tickets.dataset','core','TicketsData','1');		
        </sql> 
	</changeSet>
	<changeSet author="Leap" id="3v1-usm-20241023-1-01">
	    <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                 select count(*) from usm_constant where item='application.tickets.dataset.allcis'
            </sqlCheck>
        </preConditions>
		<sql dbms="h2, mysql,mssql" splitStatements="true" stripComments="true">  
			INSERT INTO usm_constant(item,project_name,item_value,project_id) VALUES ('application.tickets.dataset.allcis','core','TicketsDataAllCis','1');		
		</sql>
    </changeSet>
	<changeSet author="Leap" id="3v1-usm-20241023-1-02">
		<sql dbms="h2, mysql,mssql" splitStatements="true" stripComments="true"> 
			INSERT INTO usm_constant(item,project_name,item_value,project_id) VALUES ('application.ticekts.impacted.types.dataset','core','TicketsTypes','1');
		</sql>
	</changeSet>
		<changeSet author="Leap" id="3v1-usm-20241023-2">
		<sql dbms="mysql,mssql" splitStatements="true" stripComments="true">  
		 UPDATE usm_constant SET item_value='{"label":"AI Brain","icon":"assets/icons/digital-ai-brain.svg","children":[{"label":"Datasources","icon":"","url":"./adapters/datasources","children":[],"_id":2},{"label":"Data Market Place","icon":"","url":"./adapters/datasets","children":[],"_id":3},{"label":"Analytics Pipelines","icon":"","url":"./aibrain/pipelines","children":[],"_id":4},{"label":"Workflows","icon":"","url":"./workflows/create/specification","children":[{"label":"Volume Forecast","icon":"","url":"./workflows/VolumeForecast","children":[],"_id":6},{"label":"EASE","icon":"","url":"./workflows/EASE","children":[],"_id":7},{"label":"Ticket Clustering","icon":"","url":"./workflows/TicketClustering","_id":8},{"label":"Shift Roster","icon":"","url":"./workflows/ShiftRoster","children":[],"_id":9},{"label":"Process Mining","icon":"","url":"./workflows/ProcessMining","children":[],"_id":10},{"label":"PMA Workflow","icon":"","url":"./workflows/NewPMAWorkflow","children":[],"_id":11}],"_id":5},{"label":"Model Market Place","icon":"","url":"./aibrain/models","children":[],"_id":12},{"label":"Endpoints","icon":"","url":"./aibrain/endpoints","children":[],"_id":13},{"label":"Agents","icon":"","url":"./aibrain/agents","children":[],"_id":14},{"label":"Data Models","icon":"","url":"./adapters/schemas","children":[{"label":"Schemas","icon":"","url":"./adapters/schemas","children":[],"_id":16},{"label":"Relationships","icon":"","url":"./adapters/schemas/relationship","children":[],"_id":17}],"_id":15},{"label":"Events","icon":"","url":"./aibrain/events","children":[],"_id":18},{"label":"Chains","icon":"","url":"./aibrain/jobs/chain","children":[],"_id":19},{"label":"Schedule","icon":"","url":"./aibrain/jobs/scheduled","children":[],"_id":20},{"label":"Logs","icon":"","url":"./aibrain/jobs/logs","children":[],"_id":21}],"horizontal":true}' 
WHERE project_name='Core' AND item_value LIKE '%AI Brain%' AND item='IT Portfolio Manager Side'
           </sql> 
	</changeSet>
	<changeSet author="Leap" id="3v1-usm-20241023-3">
		<sql dbms="mysql,mssql" splitStatements="true" stripComments="true">  
		 UPDATE usm_constant SET item_value='{"label":"AI Brain","icon":"ils","children":[{"label":"Datasources","icon":"database","url":"./adapters/datasources","children":[],"_id":2},{"label":"Analytics Pipelines","icon":"wpexplorer","url":"./aibrain/pipelines","children":[],"_id":3},{"label":"Agents","icon":"gg","url":"./aibrain/agents","children":[],"_id":4},{"label":"Data Marketplace","icon":"table","url":"./adapters/datasets","children":[],"_id":5},{"label":"Model Marketplace","icon":"superpowers","url":"./aibrain/models","children":[],"_id":6},{"label":"Schemas","icon":"puzzle-piece","url":"./adapters/schemas","children":[],"_id":7},{"label":"Data Models","icon":"","url":"./adapters/schemas","children":[{"label":"Schemas","icon":"","url":"./adapters/schemas","children":[],"_id":13},{"label":"Relationships","icon":"","url":"./adapters/schemas/relationship","children":[],"_id":14}],"_id":12},{"label":"Events","icon":"calendar","url":"./aibrain/events","children":[],"_id":8},{"label":"Chain Jobs","icon":"link","url":"./aibrain/jobs/chain","children":[],"_id":9},{"label":"Scheduled Jobs","icon":"clock-o","url":"./aibrain/jobs/scheduled","children":[],"_id":10},{"label":"Logs","icon":"file-text-o","url":"./aibrain/jobs/logs","children":[],"_id":11}]}' 
WHERE project_name='Core' AND item_value LIKE '%AI Brain%' AND item='Project Admin Side'
           </sql> 
	</changeSet>
	<changeSet author="Leap" id="3v1-usm-20241023-4">
		<sql dbms="mysql,mssql" splitStatements="true" stripComments="true">  
		INSERT INTO usm_permissions (module,permission) Values('dbs','get-tickets-data');
           </sql> 
		  <sql dbms="mysql,mssql" splitStatements="true" stripComments="true">  
          INSERT INTO usm_permissions (module,permission) Values('dbs','get-tickets-ci-mapping-data');
           </sql>    
		   <sql dbms="mysql,mssql" splitStatements="true" stripComments="true">  
            INSERT INTO usm_permissions (module,permission) Values('dbs','get-tickets-disruptions-data');
           </sql>    
		   <sql dbms="mysql,mssql" splitStatements="true" stripComments="true">  
           INSERT INTO usm_permissions (module,permission) Values('dbs','get-tickets-locations');
           </sql>    
		   <sql dbms="mysql,mssql" splitStatements="true" stripComments="true">  
           INSERT INTO usm_permissions (module,permission) Values('dbs','get-impacted-types');
           </sql>    
		   <sql dbms="mysql,mssql" splitStatements="true" stripComments="true">  
             INSERT INTO usm_permissions (module,permission) Values('dbs','get-project-ci-list');
           </sql>    
		   <sql dbms="mysql,mssql" splitStatements="true" stripComments="true">  
           INSERT INTO usm_permissions (module,permission) Values('dbs','get-cidetails-from-cmdb-sys-id');
           </sql> 
</changeSet>
 <changeSet author="Leap" id="3v1-usm-20241023-5">
		<sql dbms="mssql" splitStatements="true" stripComments="true">  
		 INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/get-tickets-data', 'POST', 0, 'get-tickets-data-gets the impacted tickets ci list data', id FROM usm_permissions WHERE module = 'dbs'  AND permission ='get-tickets-data' ORDER BY id OFFSET 0 ROWS FETCH FIRST 1 ROWS ONLY;
           </sql> 
		  <sql dbms="mssql" splitStatements="true" stripComments="true">  
          INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/get-tickets-ci-mapping-data', 'POST', 0, 'get-tickets-ci-mapping-data the impacted tickets ci type list data', id FROM usm_permissions WHERE module = 'dbs'  AND permission ='get-tickets-ci-mapping-data' ORDER BY id OFFSET 0 ROWS FETCH FIRST 1 ROWS ONLY;
           </sql>    
		   <sql dbms="mssql" splitStatements="true" stripComments="true">  
              INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/get-tickets-disruptions-data', 'POST', 0, 'get-tickets-disruptions-data the impacted tickets from tickets table', id FROM usm_permissions WHERE module = 'dbs'  AND permission ='get-tickets-disruptions-data' ORDER BY id OFFSET 0 ROWS FETCH FIRST 1 ROWS ONLY;
           </sql>    
		   <sql dbms="mssql" splitStatements="true" stripComments="true">  
           INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/get-tickets-locations/[A-Za-z0-9- _]*', 'GET', 0, 'get-tickets-locations-gets the ci location list', id FROM usm_permissions WHERE module = 'dbs'  AND permission ='get-tickets-locations' ORDER BY id OFFSET 0 ROWS FETCH FIRST 1 ROWS ONLY;
           </sql>    
		   <sql dbms="mssql" splitStatements="true" stripComments="true">  
           INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/get-impacted-types/[A-Za-z0-9-_]*', 'GET', 0, 'get-impacted-types-gets impacted types of the tickets', id FROM usm_permissions WHERE module = 'dbs'  AND permission ='get-impacted-types' ORDER BY id OFFSET 0 ROWS FETCH FIRST 1 ROWS ONLY;
           </sql>    
		   <sql dbms="mssql" splitStatements="true" stripComments="true">  
             INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/get-project-ci-list', 'GET', 0, 'get-project-ci-list the impacted tickets ci list data', id FROM usm_permissions WHERE module = 'dbs'  AND permission ='get-project-ci-list' ORDER BY id OFFSET 0 ROWS FETCH FIRST 1 ROWS ONLY;
           </sql>    
		   <sql dbms="mssql" splitStatements="true" stripComments="true">  
           INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/get-cidetails-from-cmdb-sys-id', 'GET', 0, 'get-cidetails-from-cmdb-sys-id-gets the impacted tickets ci list data', id FROM usm_permissions WHERE module = 'dbs'  AND permission ='get-cidetails-from-cmdb-sys-id' ORDER BY id OFFSET 0 ROWS FETCH FIRST 1 ROWS ONLY;
           </sql> 
</changeSet>
 
 
 
  <changeSet author="Leap" id="3v1-usm-20241023-6">
		<sql dbms="mysql" splitStatements="true" stripComments="true">  
		 INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/get-tickets-data', 'POST', 0, 'get-tickets-data-gets the impacted tickets ci list data', id FROM usm_permissions WHERE module = 'dbs'  AND permission ='get-tickets-data' limit 1;
           </sql> 
		  <sql dbms="mysql" splitStatements="true" stripComments="true">  
          INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/get-tickets-ci-mapping-data', 'POST', 0, 'get-tickets-ci-mapping-data the impacted tickets ci type list data', id FROM usm_permissions WHERE module = 'dbs'  AND permission ='get-tickets-ci-mapping-data' limit 1;
           </sql>    
		   <sql dbms="mysql" splitStatements="true" stripComments="true">  
              INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/get-tickets-disruptions-data', 'POST', 0, 'get-tickets-disruptions-data the impacted tickets from tickets table', id FROM usm_permissions WHERE module = 'dbs'  AND permission ='get-tickets-disruptions-data' limit 1;
           </sql>    
		   <sql dbms="mysql" splitStatements="true" stripComments="true">  
           INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/get-tickets-locations/[A-Za-z0-9- _]*', 'GET', 0, 'get-tickets-locations-gets the ci location list', id FROM usm_permissions WHERE module = 'dbs'  AND permission ='get-tickets-locations' limit 1;
           </sql>    
		   <sql dbms="mysql" splitStatements="true" stripComments="true">  
           INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/get-impacted-types/[A-Za-z0-9-_]*', 'GET', 0, 'get-impacted-types-gets impacted types of the tickets', id FROM usm_permissions WHERE module = 'dbs'  AND permission ='get-impacted-types' limit 1;
           </sql>    
		   <sql dbms="mysql" splitStatements="true" stripComments="true">  
             INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/get-project-ci-list', 'GET', 0, 'get-project-ci-list the impacted tickets ci list data', id FROM usm_permissions WHERE module = 'dbs'  AND permission ='get-project-ci-list' limit 1;
           </sql>    
		   <sql dbms="mysql" splitStatements="true" stripComments="true">  
           INSERT INTO usm_permission_api (api, TYPE, is_whitelisted, DESCRIPTION,permission_id) SELECT '/api/get-cidetails-from-cmdb-sys-id', 'GET', 0, 'get-cidetails-from-cmdb-sys-id-gets the impacted tickets ci list data', id FROM usm_permissions WHERE module = 'dbs'  AND permission ='get-cidetails-from-cmdb-sys-id' limit 1;
           </sql> 
</changeSet>
	<changeSet author="Leap" dbms="mssql,mysql" id="3v1-usm-20241023-7">   
        <sql splitStatements="true" stripComments="true">  
            INSERT INTO usm_constant (item,project_name,item_value,project_id) SELECT 'kg.maximumNodeLimit','Core','100',a.id FROM usm_project a WHERE name='Core';
        </sql>   
    </changeSet>
        <changeSet author="Leap" id="3v1-usm-20241202-1">  
         <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                SELECT COUNT(*) FROM usm_constant WHERE item = 'application.uiconfig.leapAppYear';
            </sqlCheck>
        </preConditions>
        <sql>
            INSERT INTO usm_constant(item, project_name, item_value, project_id) VALUES('application.uiconfig.leapAppYear', 'Core', '2025', 1);
        </sql>
    </changeSet>
    <changeSet author="Leap" id="3v1-usm-20241202-2">  
         <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM usm_constant WHERE item = 'application.uiconfig.appVersion';
            </sqlCheck>
        </preConditions>
        <sql>
            INSERT INTO usm_constant(item, item_value) VALUES('application.uiconfig.appVersion', '3.1.0');	
        </sql>
    </changeSet>
	<changeSet author="Leap (generated)" id="3v1-usm-20241202-3">
		<preConditions onFail="MARK_RAN">
			<not>
				<columnExists tableName="usm_users" columnName="is_ui_inactivity_tracked"/>
			</not>
		</preConditions>
		<sql dbms="postgresql">
			ALTER TABLE usm_users ADD is_ui_inactivity_tracked BOOLEAN NOT NULL DEFAULT TRUE;
			UPDATE usm_users SET is_ui_inactivity_tracked = TRUE;
		</sql>
		<sql dbms="mysql">
			ALTER TABLE usm_users ADD COLUMN is_ui_inactivity_tracked BIT NOT NULL DEFAULT b'1';
		</sql>
		<sql dbms="mssql">
			ALTER TABLE usm_users ADD is_ui_inactivity_tracked BIT NOT NULL DEFAULT 1;
			UPDATE usm_users SET is_ui_inactivity_tracked = 1;
		</sql>
	</changeSet>
</databaseChangeLog>
