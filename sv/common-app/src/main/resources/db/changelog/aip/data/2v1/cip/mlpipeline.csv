"created_by","created_date","deleted","description","job_id","json_content","lastmodifiedby","alias","lastmodifieddate","name","organization","type","version"
"admin","2022-06-17 17:09:34.381000","","","NULL","{\"elements\":[{\"attributes\":{\"filetype\":\"Python3\",\"files\":[\"LEORSTRS86577_leo1311.py\"],\"arguments\":[{\"name\":\"SnowDataSource\",\"value\":\"ACMSNWQB82627\",\"index\":\"1\",\"type\":\"Datasource\",\"alias\":\"SNOW\"},{\"name\":\"api\",\"value\":\"/api/now/table/\",\"index\":\"2\"},{\"name\":\"params\",\"value\":\"sysparm_display_value=true\",\"index\":\"4\"},{\"name\":\"RosterDataSource\",\"value\":\"LEOLRLLL53151\",\"index\":\"8\",\"type\":\"Datasource\",\"alias\":\"Shift Roster\"},{\"name\":\"setProxy\",\"value\":\"True\",\"type\":\"Text\",\"index\":\"14\"},{\"name\":\"dataTable\",\"value\":\"@projectname_rostertool_metadata\",\"type\":\"Text\",\"index\":\"6\",\"alias\":\"@projectname_rostertool_metadata\"}]}}]}","admin","Roster SNOW_Get_Metadata","2022-06-20 05:31:50","LEORSTRS86577","leo1311","NativeScript","NULL"
"admin","2022-06-17 17:09:47.298000","","","NULL","{\"elements\":[{\"attributes\":{\"filetype\":\"Python3\",\"files\":[\"LEORSTRS62652_leo1311.py\"],\"arguments\":[{\"name\":\"SnowDataSource\",\"value\":\"ACMSNWQB82627\",\"type\":\"Datasource\",\"index\":\"1\",\"alias\":\"SNOW\"},{\"name\":\"api\",\"value\":\"/api/now/table/\",\"type\":\"Text\",\"index\":\"2\"},{\"name\":\"params\",\"value\":\"sysparm_display_value=true&sysparm_fields=number%2Cshort_description%2Cpriority%2Cstate%2Cdescription%2Csys_id%2Copened_at%2Csys_created_on%2Csys_updated_on%2Cclosed_at%2Cdue_date%2Csys_created_by%2Creopened_time%2Cresolved_at%2Ccategory%2Cclose_code%2Cimpact%2Curgency%2Crequested_for%2Cassignment_group%2Ccaller_id%2Cassigned_to%2Cresolved_by%2Cclosed_by%2Ccmdb_ci%2Cclose_notes%2Clocation%2Crequest_state%2Cprice%2Cspecial_instructions%2Capproval%2Cbusiness_service%2Crisk%2Ctype%2Crequested_by%2Cincident\",\"type\":\"Text\",\"index\":\"3\"},{\"name\":\"snowTable\",\"value\":\"incident\",\"type\":\"Text\",\"index\":\"5\"},{\"name\":\"setProxy\",\"value\":\"True\",\"type\":\"Text\",\"index\":\"6\"},{\"name\":\"RosterDataSource\",\"value\":\"LEOLRLLL53151\",\"type\":\"Datasource\",\"index\":\"7\",\"alias\":\"Shift Roster\"},{\"name\":\"fullLoad\",\"value\":\"True\",\"type\":\"Text\",\"index\":\"8\",\"alias\":\"True\"},{\"name\":\"TimeDelta(hrs)\",\"value\":\"1\",\"type\":\"Text\",\"index\":\"9\"},{\"name\":\"dataTable\",\"value\":\"@projectname_rostertickets\",\"type\":\"Text\",\"index\":\"9\"},{\"name\":\"limit\",\"value\":\"1000\",\"type\":\"Text\",\"index\":\"10\"},{\"name\":\"offset\",\"value\":\"0\",\"type\":\"Text\",\"index\":\"11\"},{\"name\":\"Keywords\",\"value\":\"@projectname_rosterkeywords\",\"type\":\"Text\",\"alias\":\"@projectname_rosterkeywords\",\"index\":\"12\"}],\"dataset\":[]}}]}","admin","Roster SNOW_Get & Classify","2022-06-19 12:26:52","LEORSTRS62652","leo1311","NativeScript","NULL"
"admin","2022-06-20 07:10:40.127000","\0","",\N,"{""elements"":[{""attributes"":{""filetype"":""Python3"",""files"":[""LEORSTRS30124_leo1311.py""],""arguments"":[{""name"":""SnowDataSource"",""value"":""ACMSNWQB82627"",""index"":""1"",""type"":""Datasource"",""alias"":""SNOW""},{""name"":""api"",""value"":""/api/now/table/"",""index"":""2""},{""name"":""params"",""value"":""sysparm_display_value=true&sysparm_fields=number%2Cshort_description%2Cpriority%2Cstate%2Csys_id%2Csys_created_on%2Csys_updated_on%2Cassigned_to"",""index"":""4"",""type"":""Text"",""alias"":""sysparm_display_value=true&sysparm_fields=number%2Cshort_description%2Cpriority%2Cstate%2Csys_id%2Csys_created_on%2Csys_updated_on%2Cassigned_to""},{""name"":""setProxy"",""value"":""True"",""index"":""5""},{""name"":""RosterDataSource"",""value"":""LEOLRLLL53151"",""index"":""10"",""type"":""Datasource"",""alias"":""Shift Roster""},{""name"":""incidentPayload"",""value"":""{\\""number\\"": \\""INC0036074\\"", \\""assignedto\\"": {\\""displayvalue\\"": \\""Fred Luddy\\"", \\""systemId\\"": \\""\\""}}"",""index"":""13"",""type"":""Text"",""alias"":""{\\""number\\"": \\""INC0036074\\"", \\""assignedto\\"": {\\""displayvalue\\"": \\""Fred Luddy\\"", \\""systemId\\"": \\""\\""}}""},{""name"":""ticketType"",""value"":""Incident"",""type"":""Text"",""index"":""10""},{""name"":""dataTable"",""value"":""@projectname_rostertickets"",""type"":""Text"",""index"":""9"",""alias"":""@projectname_rostertickets""},{""name"":""userDetails"",""value"":""@projectname_rostertool_metadata"",""type"":""Text"",""alias"":""@projectname_rostertool_metadata"",""index"":""9""}]}}]}","admin","Roster SNOW_Update","2022-06-20 07:10:52","LEORSTRS30124","leo1311","NativeScript",\N
"admin","2021-04-05 09:47:02.150000","false","Train a classification model to predict clusters","NULL","{\"elements\":[{\"id\":\"nvSqf\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"id\":39039,\"name\":\"Clusters\",\"alias\":\"Clusters\",\"description\":\"clustered Tickets with short description\",\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-21 11:03:07\",\"alias\":\"Cluster Classification\",\"id\":13,\"name\":\"ACMCLSTR30039\",\"description\":\"\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\",\\\"isprimarykey\\\":true,\\\"isautoincrement\\\":false,\\\"isunique\\\":true,\\\"isrequired\\\":true},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"text\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":true},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"clusterName\\\",\\\"recordcolumndisplayname\\\":\\\"clusterName\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":false},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":4,\\\"recordcolumnname\\\":\\\"configurationItem\\\",\\\"recordcolumndisplayname\\\":\\\"configurationItem\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":false}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number , clean_text as text, post_ranking_cluster AS clusterName FROM @projectname_tickets_enriched WHERE post_ranking_cluster IS NOT NULL AND post_ranking_cluster <> ''\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-21 11:01:56\",\"alias\":\"leo1311\",\"id\":2,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encnOsN7Ge7HZuvB9Z4Tobpr5LfVWGgdkxS\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://10.212.115.65:31692/leapmaster_ref_data\\\"}\",\"salt\":\"gBL2oW1CXmYVlFMotQnqjQeGevFjul91p7wutQx8N8Jj71UuoY7eMWasQ9jK5zhTCIwqod4DB9VqFlIC8n2W6w==\",\"organization\":\"leo1311\",\"dshashcode\":\"6dff27e9115bd0514b0e559d24ac28b5567259110cd168ea4378ceb12269b063\",\"activetime\":\"2021-06-21 11:01:55\",\"category\":\"SQL\"},\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MYSQL\",\"expStatus\":0,\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":false},\"position_x\":\"50\",\"position_y\":\"110\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"oksqS\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"aPhFu\",\"alias\":\"Count  Vectorizer\",\"name\":\"Count  Vectorizer\",\"classname\":\"CountVectorizerFeatureExtractorConfig\",\"category\":\"FeatureExtractorConfig\",\"attributes\":{\"inputCol\":\"clean_tokens\",\"outputCol\":\"features\",\"vocabSize\":\"1000000\"},\"position_x\":\"710\",\"position_y\":\"110\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"UkSyH\",\"elementPosition\":\"LeftMiddle\"},{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"acJqw\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"inputCol\":\"text\",\"outputCol\":\"text\",\"vocabSize\":\"text\"},\"context\":[{\"inputCol\":\"tokens\",\"outputCol\":\"clean_tokens\",\"stopWords\":\"\"},{\"inputCol\":\"text\",\"outputCol\":\"tokens\"},{\"dataset\":{\"id\":39039,\"name\":\"Clusters\",\"alias\":\"Clusters\",\"description\":\"clustered Tickets with short description\",\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-21 11:03:07\",\"alias\":\"Cluster Classification\",\"id\":13,\"name\":\"ACMCLSTR30039\",\"description\":\"\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\",\\\"isprimarykey\\\":true,\\\"isautoincrement\\\":false,\\\"isunique\\\":true,\\\"isrequired\\\":true},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"text\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":true},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"clusterName\\\",\\\"recordcolumndisplayname\\\":\\\"clusterName\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":false},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":4,\\\"recordcolumnname\\\":\\\"configurationItem\\\",\\\"recordcolumndisplayname\\\":\\\"configurationItem\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":false}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number , clean_text as text, post_ranking_cluster AS clusterName FROM @projectname_tickets_enriched WHERE post_ranking_cluster IS NOT NULL AND post_ranking_cluster <> ''\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-21 11:01:56\",\"alias\":\"leo1311\",\"id\":2,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encnOsN7Ge7HZuvB9Z4Tobpr5LfVWGgdkxS\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://10.212.115.65:31692/leapmaster_ref_data\\\"}\",\"salt\":\"gBL2oW1CXmYVlFMotQnqjQeGevFjul91p7wutQx8N8Jj71UuoY7eMWasQ9jK5zhTCIwqod4DB9VqFlIC8n2W6w==\",\"organization\":\"leo1311\",\"dshashcode\":\"6dff27e9115bd0514b0e559d24ac28b5567259110cd168ea4378ceb12269b063\",\"activetime\":\"2021-06-21 11:01:55\",\"category\":\"SQL\"},\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MYSQL\",\"expStatus\":0,\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":false}]},{\"id\":\"KoEyF\",\"alias\":\"Random  Forest  Classifier\",\"name\":\"Random  Forest  Classifier\",\"classname\":\"RandomForestClassifierConfig\",\"category\":\"AnalyzerConfig\",\"attributes\":{\"labelCol\":\"cluster_idx\",\"featuresCol\":\"features\",\"numTrees\":\"10\"},\"position_x\":\"60\",\"position_y\":\"240\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"PwxMg\",\"elementPosition\":\"LeftMiddle\"},{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"UkSyH\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"labelCol\":\"text\",\"featuresCol\":\"text\",\"numTrees\":\"text\"},\"context\":[{\"inputCols\":\"clusterName\",\"outputCols\":\"cluster_idx\"},{\"inputCol\":\"clean_tokens\",\"outputCol\":\"features\",\"vocabSize\":\"1000000\"},{\"inputCol\":\"tokens\",\"outputCol\":\"clean_tokens\",\"stopWords\":\"\"},{\"inputCol\":\"text\",\"outputCol\":\"tokens\"},{\"dataset\":{\"id\":39039,\"name\":\"Clusters\",\"alias\":\"Clusters\",\"description\":\"clustered Tickets with short description\",\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-21 11:03:07\",\"alias\":\"Cluster Classification\",\"id\":13,\"name\":\"ACMCLSTR30039\",\"description\":\"\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\",\\\"isprimarykey\\\":true,\\\"isautoincrement\\\":false,\\\"isunique\\\":true,\\\"isrequired\\\":true},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"text\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":true},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"clusterName\\\",\\\"recordcolumndisplayname\\\":\\\"clusterName\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":false},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":4,\\\"recordcolumnname\\\":\\\"configurationItem\\\",\\\"recordcolumndisplayname\\\":\\\"configurationItem\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":false}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number , clean_text as text, post_ranking_cluster AS clusterName FROM @projectname_tickets_enriched WHERE post_ranking_cluster IS NOT NULL AND post_ranking_cluster <> ''\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-21 11:01:56\",\"alias\":\"leo1311\",\"id\":2,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encnOsN7Ge7HZuvB9Z4Tobpr5LfVWGgdkxS\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://10.212.115.65:31692/leapmaster_ref_data\\\"}\",\"salt\":\"gBL2oW1CXmYVlFMotQnqjQeGevFjul91p7wutQx8N8Jj71UuoY7eMWasQ9jK5zhTCIwqod4DB9VqFlIC8n2W6w==\",\"organization\":\"leo1311\",\"dshashcode\":\"6dff27e9115bd0514b0e559d24ac28b5567259110cd168ea4378ceb12269b063\",\"activetime\":\"2021-06-21 11:01:55\",\"category\":\"SQL\"},\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MYSQL\",\"expStatus\":0,\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":false}]},{\"id\":\"PwxMg\",\"alias\":\"Model  Sink\",\"name\":\"Model  Sink\",\"classname\":\"ModelSinkConfig\",\"category\":\"BaseConfig\",\"attributes\":{\"modelName\":\"IIAClusterClassification\"},\"position_x\":\"330\",\"position_y\":\"240\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"KoEyF\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"kOIVY\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"modelName\":\"text\"},\"context\":[{\"labelCol\":\"cluster_idx\",\"featuresCol\":\"features\",\"numTrees\":\"10\"},{\"inputCols\":\"clusterName\",\"outputCols\":\"cluster_idx\"},{\"inputCol\":\"clean_tokens\",\"outputCol\":\"features\",\"vocabSize\":\"1000000\"},{\"inputCol\":\"tokens\",\"outputCol\":\"clean_tokens\",\"stopWords\":\"\"},{\"inputCol\":\"text\",\"outputCol\":\"tokens\"},{\"dataset\":{\"id\":39039,\"name\":\"Clusters\",\"alias\":\"Clusters\",\"description\":\"clustered Tickets with short description\",\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-21 11:03:07\",\"alias\":\"Cluster Classification\",\"id\":13,\"name\":\"ACMCLSTR30039\",\"description\":\"\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\",\\\"isprimarykey\\\":true,\\\"isautoincrement\\\":false,\\\"isunique\\\":true,\\\"isrequired\\\":true},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"text\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":true},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"clusterName\\\",\\\"recordcolumndisplayname\\\":\\\"clusterName\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":false},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":4,\\\"recordcolumnname\\\":\\\"configurationItem\\\",\\\"recordcolumndisplayname\\\":\\\"configurationItem\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":false}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number , clean_text as text, post_ranking_cluster AS clusterName FROM @projectname_tickets_enriched WHERE post_ranking_cluster IS NOT NULL AND post_ranking_cluster <> ''\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-21 11:01:56\",\"alias\":\"leo1311\",\"id\":2,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encnOsN7Ge7HZuvB9Z4Tobpr5LfVWGgdkxS\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://10.212.115.65:31692/leapmaster_ref_data\\\"}\",\"salt\":\"gBL2oW1CXmYVlFMotQnqjQeGevFjul91p7wutQx8N8Jj71UuoY7eMWasQ9jK5zhTCIwqod4DB9VqFlIC8n2W6w==\",\"organization\":\"leo1311\",\"dshashcode\":\"6dff27e9115bd0514b0e559d24ac28b5567259110cd168ea4378ceb12269b063\",\"activetime\":\"2021-06-21 11:01:55\",\"category\":\"SQL\"},\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MYSQL\",\"expStatus\":0,\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":false}]},{\"id\":\"kOIVY\",\"alias\":\"Post  Processing  Script\",\"name\":\"Post  Processing  Script\",\"classname\":\"PostProcessingScriptConfig\",\"category\":\"BaseConfig\",\"attributes\":{\"params\":\"\",\"script\":[\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"from pyspark.ml.feature import IndexToString\\r\",\"from datetime import datetime\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, model,dataset):\\r\",\"        print(dataset)\\r\",\"        data = dataset.select('number','prediction')\\r\",\"        indexer = model.stages[3]\\r\",\"        labeler = IndexToString(inputCol='prediction', outputCol='cluster_classification_label', labels=indexer.labels)\\r\",\"        dataset = labeler.transform(data)\\r\",\"        dataset = dataset.drop('prediction')\\r\",\"        dataset = dataset.withColumn('last_updated', lit(datetime.now()))\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},\"position_x\":\"600\",\"position_y\":\"240\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"PwxMg\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"kqYQR\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\",\"out2\"],\"requiredJars\":[],\"formats\":{\"params\":\"textarea\",\"script\":\"textarea\"},\"context\":[{\"modelName\":\"IIAClusterClassification\"},{\"labelCol\":\"cluster_idx\",\"featuresCol\":\"features\",\"numTrees\":\"10\"},{\"inputCols\":\"clusterName\",\"outputCols\":\"cluster_idx\"},{\"inputCol\":\"clean_tokens\",\"outputCol\":\"features\",\"vocabSize\":\"1000000\"},{\"inputCol\":\"tokens\",\"outputCol\":\"clean_tokens\",\"stopWords\":\"\"},{\"inputCol\":\"text\",\"outputCol\":\"tokens\"},{\"dataset\":{\"id\":39039,\"name\":\"Clusters\",\"alias\":\"Clusters\",\"description\":\"clustered Tickets with short description\",\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-21 11:03:07\",\"alias\":\"Cluster Classification\",\"id\":13,\"name\":\"ACMCLSTR30039\",\"description\":\"\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\",\\\"isprimarykey\\\":true,\\\"isautoincrement\\\":false,\\\"isunique\\\":true,\\\"isrequired\\\":true},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"text\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":true},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"clusterName\\\",\\\"recordcolumndisplayname\\\":\\\"clusterName\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":false},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":4,\\\"recordcolumnname\\\":\\\"configurationItem\\\",\\\"recordcolumndisplayname\\\":\\\"configurationItem\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":false}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number , clean_text as text, post_ranking_cluster AS clusterName FROM @projectname_tickets_enriched WHERE post_ranking_cluster IS NOT NULL AND post_ranking_cluster <> ''\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-21 11:01:56\",\"alias\":\"leo1311\",\"id\":2,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encnOsN7Ge7HZuvB9Z4Tobpr5LfVWGgdkxS\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://10.212.115.65:31692/leapmaster_ref_data\\\"}\",\"salt\":\"gBL2oW1CXmYVlFMotQnqjQeGevFjul91p7wutQx8N8Jj71UuoY7eMWasQ9jK5zhTCIwqod4DB9VqFlIC8n2W6w==\",\"organization\":\"leo1311\",\"dshashcode\":\"6dff27e9115bd0514b0e559d24ac28b5567259110cd168ea4378ceb12269b063\",\"activetime\":\"2021-06-21 11:01:55\",\"category\":\"SQL\"},\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MYSQL\",\"expStatus\":0,\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":false}]},{\"id\":\"kqYQR\",\"alias\":\"Dataset  Loader\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"id\":39038,\"name\":\"ClassifiedClusters\",\"alias\":\"ClassifiedClusters\",\"description\":\"Classified Clusters for training data\",\"schema\":{\"id\":10106,\"name\":\"ClusterClassification\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"configurationItem\\\",\\\"recordcolumndisplayname\\\":\\\"configurationItem\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"clusterName\\\",\\\"recordcolumndisplayname\\\":\\\"clusterName\\\"},{\\\"columntype\\\":\\\"int\\\",\\\"columnorder\\\":4,\\\"recordcolumnname\\\":\\\"projectId\\\",\\\"recordcolumndisplayname\\\":\\\"projectId\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":5,\\\"recordcolumnname\\\":\\\"shortDescription\\\",\\\"recordcolumndisplayname\\\":\\\"shortDescription\\\"}]\",\"organization\":\"leo1311\"},\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, cluster_classification_label,  last_updated from @projectname_tickets_enriched  \",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"update\",\"params\":\"{}\",\"tableName\":\"@projectname_tickets_enriched\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"rw\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MYSQL\",\"groups\":\"\",\"expStatus\":0,\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-21 11:01:56\",\"alias\":\"leo1311\",\"id\":2,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encnOsN7Ge7HZuvB9Z4Tobpr5LfVWGgdkxS\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://10.212.115.65:31692/leapmaster_ref_data\\\"}\",\"salt\":\"gBL2oW1CXmYVlFMotQnqjQeGevFjul91p7wutQx8N8Jj71UuoY7eMWasQ9jK5zhTCIwqod4DB9VqFlIC8n2W6w==\",\"organization\":\"leo1311\",\"dshashcode\":\"6dff27e9115bd0514b0e559d24ac28b5567259110cd168ea4378ceb12269b063\",\"activetime\":\"2021-06-21 11:01:55\",\"category\":\"SQL\"}},\"applySchema\":false},\"position_x\":\"860\",\"position_y\":\"240\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"kOIVY\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"applySchema\":\"checkbox\"},\"context\":[{\"params\":\"\",\"script\":[\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"from pyspark.ml.feature import IndexToString\\r\",\"from datetime import datetime\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, model,dataset):\\r\",\"        print(dataset)\\r\",\"        data = dataset.select('number','prediction')\\r\",\"        indexer = model.stages[3]\\r\",\"        labeler = IndexToString(inputCol='prediction', outputCol='cluster_classification_label', labels=indexer.labels)\\r\",\"        dataset = labeler.transform(data)\\r\",\"        dataset = dataset.drop('prediction')\\r\",\"        dataset = dataset.withColumn('last_updated', lit(datetime.now()))\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},{\"modelName\":\"IIAClusterClassification\"},{\"labelCol\":\"cluster_idx\",\"featuresCol\":\"features\",\"numTrees\":\"10\"},{\"inputCols\":\"clusterName\",\"outputCols\":\"cluster_idx\"},{\"inputCol\":\"clean_tokens\",\"outputCol\":\"features\",\"vocabSize\":\"1000000\"},{\"inputCol\":\"tokens\",\"outputCol\":\"clean_tokens\",\"stopWords\":\"\"},{\"inputCol\":\"text\",\"outputCol\":\"tokens\"},{\"dataset\":{\"id\":39039,\"name\":\"Clusters\",\"alias\":\"Clusters\",\"description\":\"clustered Tickets with short description\",\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-21 11:03:07\",\"alias\":\"Cluster Classification\",\"id\":13,\"name\":\"ACMCLSTR30039\",\"description\":\"\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\",\\\"isprimarykey\\\":true,\\\"isautoincrement\\\":false,\\\"isunique\\\":true,\\\"isrequired\\\":true},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"text\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":true},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"clusterName\\\",\\\"recordcolumndisplayname\\\":\\\"clusterName\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":false},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":4,\\\"recordcolumnname\\\":\\\"configurationItem\\\",\\\"recordcolumndisplayname\\\":\\\"configurationItem\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":false}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number , clean_text as text, post_ranking_cluster AS clusterName FROM @projectname_tickets_enriched WHERE post_ranking_cluster IS NOT NULL AND post_ranking_cluster <> ''\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-21 11:01:56\",\"alias\":\"leo1311\",\"id\":2,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encnOsN7Ge7HZuvB9Z4Tobpr5LfVWGgdkxS\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://10.212.115.65:31692/leapmaster_ref_data\\\"}\",\"salt\":\"gBL2oW1CXmYVlFMotQnqjQeGevFjul91p7wutQx8N8Jj71UuoY7eMWasQ9jK5zhTCIwqod4DB9VqFlIC8n2W6w==\",\"organization\":\"leo1311\",\"dshashcode\":\"6dff27e9115bd0514b0e559d24ac28b5567259110cd168ea4378ceb12269b063\",\"activetime\":\"2021-06-21 11:01:55\",\"category\":\"SQL\"},\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MYSQL\",\"expStatus\":0,\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":false}]},{\"id\":\"UkSyH\",\"alias\":\"String  Indexer\",\"name\":\"String  Indexer\",\"classname\":\"StringIndexerTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"inputCols\":\"clusterName\",\"outputCols\":\"cluster_idx\"},\"position_x\":\"930\",\"position_y\":\"110\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"aPhFu\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"KoEyF\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"inputCols\":\"text\",\"outputCols\":\"text\"},\"context\":[{\"inputCol\":\"clean_tokens\",\"outputCol\":\"features\",\"vocabSize\":\"1000000\"},{\"inputCol\":\"tokens\",\"outputCol\":\"clean_tokens\",\"stopWords\":\"\"},{\"inputCol\":\"text\",\"outputCol\":\"tokens\"},{\"dataset\":{\"id\":39039,\"name\":\"Clusters\",\"alias\":\"Clusters\",\"description\":\"clustered Tickets with short description\",\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-21 11:03:07\",\"alias\":\"Cluster Classification\",\"id\":13,\"name\":\"ACMCLSTR30039\",\"description\":\"\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\",\\\"isprimarykey\\\":true,\\\"isautoincrement\\\":false,\\\"isunique\\\":true,\\\"isrequired\\\":true},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"text\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":true},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"clusterName\\\",\\\"recordcolumndisplayname\\\":\\\"clusterName\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":false},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":4,\\\"recordcolumnname\\\":\\\"configurationItem\\\",\\\"recordcolumndisplayname\\\":\\\"configurationItem\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":false}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number , clean_text as text, post_ranking_cluster AS clusterName FROM @projectname_tickets_enriched WHERE post_ranking_cluster IS NOT NULL AND post_ranking_cluster <> ''\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-21 11:01:56\",\"alias\":\"leo1311\",\"id\":2,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encnOsN7Ge7HZuvB9Z4Tobpr5LfVWGgdkxS\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://10.212.115.65:31692/leapmaster_ref_data\\\"}\",\"salt\":\"gBL2oW1CXmYVlFMotQnqjQeGevFjul91p7wutQx8N8Jj71UuoY7eMWasQ9jK5zhTCIwqod4DB9VqFlIC8n2W6w==\",\"organization\":\"leo1311\",\"dshashcode\":\"6dff27e9115bd0514b0e559d24ac28b5567259110cd168ea4378ceb12269b063\",\"activetime\":\"2021-06-21 11:01:55\",\"category\":\"SQL\"},\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MYSQL\",\"expStatus\":0,\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":false}]},{\"id\":\"acJqw\",\"alias\":\"Stop  Words  Remover\",\"name\":\"Stop  Words  Remover\",\"classname\":\"StopWordsRemoverTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"inputCol\":\"tokens\",\"outputCol\":\"clean_tokens\",\"stopWords\":\"\"},\"position_x\":\"490\",\"position_y\":\"110\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"aPhFu\",\"elementPosition\":\"LeftMiddle\"},{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"oksqS\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"inputCol\":\"text\",\"outputCol\":\"text\",\"stopWords\":\"text\"},\"context\":[{\"inputCol\":\"text\",\"outputCol\":\"tokens\"},{\"dataset\":{\"id\":39039,\"name\":\"Clusters\",\"alias\":\"Clusters\",\"description\":\"clustered Tickets with short description\",\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-21 11:03:07\",\"alias\":\"Cluster Classification\",\"id\":13,\"name\":\"ACMCLSTR30039\",\"description\":\"\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\",\\\"isprimarykey\\\":true,\\\"isautoincrement\\\":false,\\\"isunique\\\":true,\\\"isrequired\\\":true},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"text\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":true},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"clusterName\\\",\\\"recordcolumndisplayname\\\":\\\"clusterName\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":false},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":4,\\\"recordcolumnname\\\":\\\"configurationItem\\\",\\\"recordcolumndisplayname\\\":\\\"configurationItem\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":false}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number , clean_text as text, post_ranking_cluster AS clusterName FROM @projectname_tickets_enriched WHERE post_ranking_cluster IS NOT NULL AND post_ranking_cluster <> ''\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-21 11:01:56\",\"alias\":\"leo1311\",\"id\":2,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encnOsN7Ge7HZuvB9Z4Tobpr5LfVWGgdkxS\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://10.212.115.65:31692/leapmaster_ref_data\\\"}\",\"salt\":\"gBL2oW1CXmYVlFMotQnqjQeGevFjul91p7wutQx8N8Jj71UuoY7eMWasQ9jK5zhTCIwqod4DB9VqFlIC8n2W6w==\",\"organization\":\"leo1311\",\"dshashcode\":\"6dff27e9115bd0514b0e559d24ac28b5567259110cd168ea4378ceb12269b063\",\"activetime\":\"2021-06-21 11:01:55\",\"category\":\"SQL\"},\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MYSQL\",\"expStatus\":0,\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":false}]},{\"id\":\"oksqS\",\"alias\":\"Tokenizer\",\"name\":\"Tokenizer\",\"classname\":\"TokenizerTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"inputCol\":\"text\",\"outputCol\":\"tokens\"},\"position_x\":\"260\",\"position_y\":\"110\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"nvSqf\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"acJqw\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"inputCol\":\"text\",\"outputCol\":\"text\"},\"context\":[{\"dataset\":{\"id\":39039,\"name\":\"Clusters\",\"alias\":\"Clusters\",\"description\":\"clustered Tickets with short description\",\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-21 11:03:07\",\"alias\":\"Cluster Classification\",\"id\":13,\"name\":\"ACMCLSTR30039\",\"description\":\"\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\",\\\"isprimarykey\\\":true,\\\"isautoincrement\\\":false,\\\"isunique\\\":true,\\\"isrequired\\\":true},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"text\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":true},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"clusterName\\\",\\\"recordcolumndisplayname\\\":\\\"clusterName\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":false},{\\\"columntype\\\":\\\"varchar\\\",\\\"columnorder\\\":4,\\\"recordcolumnname\\\":\\\"configurationItem\\\",\\\"recordcolumndisplayname\\\":\\\"configurationItem\\\",\\\"isprimarykey\\\":false,\\\"isautoincrement\\\":false,\\\"isunique\\\":false,\\\"isrequired\\\":false}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number , clean_text as text, post_ranking_cluster AS clusterName FROM @projectname_tickets_enriched WHERE post_ranking_cluster IS NOT NULL AND post_ranking_cluster <> ''\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-21 11:01:56\",\"alias\":\"leo1311\",\"id\":2,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encnOsN7Ge7HZuvB9Z4Tobpr5LfVWGgdkxS\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://10.212.115.65:31692/leapmaster_ref_data\\\"}\",\"salt\":\"gBL2oW1CXmYVlFMotQnqjQeGevFjul91p7wutQx8N8Jj71UuoY7eMWasQ9jK5zhTCIwqod4DB9VqFlIC8n2W6w==\",\"organization\":\"leo1311\",\"dshashcode\":\"6dff27e9115bd0514b0e559d24ac28b5567259110cd168ea4378ceb12269b063\",\"activetime\":\"2021-06-21 11:01:55\",\"category\":\"SQL\"},\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MYSQL\",\"expStatus\":0,\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":false}]}]}","admin","Cluster Classification Training","2021-06-21 11:15:34","ClusterClassification_Training","leo1311","DragAndDrop","NULL"
"admin","2021-10-13 14:44:14.729000","false","NULL","NULL","{\"elements\":[{\"id\":\"ZGDHt\",\"alias\":\"clean text\",\"name\":\"Pre  Processing  Script\",\"classname\":\"PreProcessingScriptConfig\",\"category\":\"BaseConfig\",\"attributes\":{\"params\":\"\",\"script\":[\"import logging as logger\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"\\r\",\"\\r\",\"\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        \\r\",\"        def alphaNum(text):\\r\",\"            alphanumeric = ''\\r\",\"            for character in text:\\r\",\"                if character.isalnum():\\r\",\"                    alphanumeric += character\\r\",\"                else:\\r\",\"                    alphanumeric += ' '\\r\",\"            return alphanumeric\\r\",\"        udfAlpaNum = udf(alphaNum, StringType())\\r\",\"        dataset = dataset.withColumn('cleanText',udfAlpaNum('shortdescription'))\\r\",\"        dataset = dataset.select('number','shortDescription', 'cleanText' )\\r\",\"        logger.info(dataset.show())\\r\",\"        return dataset  \\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"],\"outputCols\":\"number,shortDescription,cleanText\"},\"position_x\":\"280\",\"position_y\":\"40\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"lNPKQ\",\"elementPosition\":\"LeftMiddle\"},{\"type\":\"target\",\"endpoint\":\"dataset1\",\"position\":\"LeftMiddle\",\"elementId\":\"cCkPo\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"dataset1\",\"dataset2\",\"dataset3\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"params\":\"textarea\",\"script\":\"textarea\",\"outputCols\":\"text\"},\"context\":[{\"dataset\":{\"alias\":\"cleantext\",\"name\":\"YS2GY6GCOS\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-09 15:55:40\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-11-09 15:55:40\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT NUMBER, clean_text AS shortdescription , group_by_field FROM @projectname_tickets_enriched WHERE clean_text <> '' AND   clean_text IS NOT NULL \",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"@projectname_tickets_enriched\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"isAuditRequired\":\"\",\"isPermissionManaged\":\"\",\"isApprovalRequired\":\"\",\"isInboxRequired\":\"\",\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"puTtA\",\"alias\":\"Lemmetizer\",\"name\":\"Python  Script  Transformer\",\"classname\":\"PythonScriptTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"script\":[\"import logging\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"from nltk.stem import WordNetLemmatizer\\r\",\"\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"      \\r\",\"        def lemmatize(tokens):\\r\",\"            wordnet_lemmatizer = WordNetLemmatizer()\\r\",\"            lemmatizedTokens = []\\r\",\"            for word in tokens:\\r\",\"                lemmatizedTokens.append(wordnet_lemmatizer.lemmatize(word, pos='v'))\\r\",\"            return lemmatizedTokens\\r\",\"        \\r\",\"        udfLemmetize = udf(lemmatize, ArrayType(StringType()))\\r\",\"        dataset = dataset.withColumn('lemmatizedTokens',udfLemmetize('clean_tokens'))\\r\",\"\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"],\"outputCols\":\"lemmatizedTokens\"},\"position_x\":\"80\",\"position_y\":\"160\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"VHGys\",\"elementPosition\":\"LeftMiddle\"},{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"RhTEg\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"script\":\"textarea\",\"outputCols\":\"text\"},\"context\":[{\"inputCol\":\"tokens\",\"outputCol\":\"clean_tokens\",\"stopWords\":\"test\"},{\"inputCol\":\"cleanText\",\"outputCol\":\"tokens\"},{\"params\":\"\",\"script\":[\"import logging as logger\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"\\r\",\"\\r\",\"\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        \\r\",\"        def alphaNum(text):\\r\",\"            alphanumeric = ''\\r\",\"            for character in text:\\r\",\"                if character.isalnum():\\r\",\"                    alphanumeric += character\\r\",\"                else:\\r\",\"                    alphanumeric += ' '\\r\",\"            return alphanumeric\\r\",\"        udfAlpaNum = udf(alphaNum, StringType())\\r\",\"        dataset = dataset.withColumn('cleanText',udfAlpaNum('shortdescription'))\\r\",\"        dataset = dataset.select('number','shortDescription', 'cleanText' )\\r\",\"        logger.info(dataset.show())\\r\",\"        return dataset  \\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"],\"outputCols\":\"number,shortDescription,cleanText\"},{\"dataset\":{\"alias\":\"cleantext\",\"name\":\"YS2GY6GCOS\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-09 15:55:40\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-11-09 15:55:40\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT NUMBER, clean_text AS shortdescription , group_by_field FROM @projectname_tickets_enriched WHERE clean_text <> '' AND   clean_text IS NOT NULL \",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"@projectname_tickets_enriched\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"isAuditRequired\":\"\",\"isPermissionManaged\":\"\",\"isApprovalRequired\":\"\",\"isInboxRequired\":\"\",\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"lNPKQ\",\"alias\":\"Tokenizer\",\"name\":\"Tokenizer\",\"classname\":\"TokenizerTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"inputCol\":\"cleanText\",\"outputCol\":\"tokens\"},\"position_x\":\"530\",\"position_y\":\"40\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"ZGDHt\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"RhTEg\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"inputCol\":\"text\",\"outputCol\":\"text\"},\"context\":[{\"params\":\"\",\"script\":[\"import logging as logger\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"\\r\",\"\\r\",\"\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        \\r\",\"        def alphaNum(text):\\r\",\"            alphanumeric = ''\\r\",\"            for character in text:\\r\",\"                if character.isalnum():\\r\",\"                    alphanumeric += character\\r\",\"                else:\\r\",\"                    alphanumeric += ' '\\r\",\"            return alphanumeric\\r\",\"        udfAlpaNum = udf(alphaNum, StringType())\\r\",\"        dataset = dataset.withColumn('cleanText',udfAlpaNum('shortdescription'))\\r\",\"        dataset = dataset.select('number','shortDescription', 'cleanText' )\\r\",\"        logger.info(dataset.show())\\r\",\"        return dataset  \\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"],\"outputCols\":\"number,shortDescription,cleanText\"},{\"dataset\":{\"alias\":\"cleantext\",\"name\":\"YS2GY6GCOS\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-09 15:55:40\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-11-09 15:55:40\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT NUMBER, clean_text AS shortdescription , group_by_field FROM @projectname_tickets_enriched WHERE clean_text <> '' AND   clean_text IS NOT NULL \",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"@projectname_tickets_enriched\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"isAuditRequired\":\"\",\"isPermissionManaged\":\"\",\"isApprovalRequired\":\"\",\"isInboxRequired\":\"\",\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"RhTEg\",\"alias\":\"Stop  Words  Remover\",\"name\":\"Stop  Words  Remover\",\"classname\":\"StopWordsRemoverTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"inputCol\":\"tokens\",\"outputCol\":\"clean_tokens\",\"stopWords\":\"test\"},\"position_x\":\"790\",\"position_y\":\"40\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"lNPKQ\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"puTtA\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"inputCol\":\"text\",\"outputCol\":\"text\",\"stopWords\":\"text\"},\"context\":[{\"inputCol\":\"cleanText\",\"outputCol\":\"tokens\"},{\"params\":\"\",\"script\":[\"import logging as logger\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"\\r\",\"\\r\",\"\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        \\r\",\"        def alphaNum(text):\\r\",\"            alphanumeric = ''\\r\",\"            for character in text:\\r\",\"                if character.isalnum():\\r\",\"                    alphanumeric += character\\r\",\"                else:\\r\",\"                    alphanumeric += ' '\\r\",\"            return alphanumeric\\r\",\"        udfAlpaNum = udf(alphaNum, StringType())\\r\",\"        dataset = dataset.withColumn('cleanText',udfAlpaNum('shortdescription'))\\r\",\"        dataset = dataset.select('number','shortDescription', 'cleanText' )\\r\",\"        logger.info(dataset.show())\\r\",\"        return dataset  \\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"],\"outputCols\":\"number,shortDescription,cleanText\"},{\"dataset\":{\"alias\":\"cleantext\",\"name\":\"YS2GY6GCOS\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-09 15:55:40\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-11-09 15:55:40\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT NUMBER, clean_text AS shortdescription , group_by_field FROM @projectname_tickets_enriched WHERE clean_text <> '' AND   clean_text IS NOT NULL \",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"@projectname_tickets_enriched\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"isAuditRequired\":\"\",\"isPermissionManaged\":\"\",\"isApprovalRequired\":\"\",\"isInboxRequired\":\"\",\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"KWSQJ\",\"alias\":\"Post  Processing  Script\",\"name\":\"Post  Processing  Script\",\"classname\":\"PostProcessingScriptConfig\",\"category\":\"BaseConfig\",\"attributes\":{\"params\":\"\",\"script\":[\"import logging\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self,model, dataset):\\r\",\"        dataset = dataset.select('filteredTokens','number')\\r\",\"        dataset = dataset.withColumn('word', explode('filteredTokens'))\\r\",\"        dataset = dataset.distinct()\\r\",\"        dataset = dataset.groupby('word').agg(collect_list('number').alias('numberList'))\\r\",\"        dataset = dataset.withColumn('frequency',  size('numberList'))\\r\",\"        dataset = dataset.withColumn('numberList',  concat_ws(',',col('numberList')))\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},\"position_x\":\"570\",\"position_y\":\"160\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"nQStO\",\"elementPosition\":\"LeftMiddle\"},{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"VHGys\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\",\"out2\"],\"requiredJars\":[],\"formats\":{\"params\":\"textarea\",\"script\":\"textarea\"},\"context\":[{\"script\":[\"import logging\\r\",\"from pyspark.sql.types import *\\r\",\"from pyspark.sql.functions import *\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        #remove numbers\\r\",\"        logging.info('lemmatizedTokens')\\r\",\"        def removeNumbers(tokens):\\r\",\"            filteredTokens = []\\r\",\"            for t in tokens:\\r\",\"               if not t.isdigit() and len(t)>2:\\r\",\"                   filteredTokens.append(t)\\r\",\"            return filteredTokens\\r\",\"            \\r\",\"        udfremoveNumber = udf(removeNumbers,ArrayType(StringType()))\\r\",\"        dataset = dataset.withColumn('filteredTokens', udfremoveNumber('lemmatizedTokens'))\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"],\"outputCols\":\"filteredTokens\"},{\"script\":[\"import logging\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"from nltk.stem import WordNetLemmatizer\\r\",\"\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"      \\r\",\"        def lemmatize(tokens):\\r\",\"            wordnet_lemmatizer = WordNetLemmatizer()\\r\",\"            lemmatizedTokens = []\\r\",\"            for word in tokens:\\r\",\"                lemmatizedTokens.append(wordnet_lemmatizer.lemmatize(word, pos='v'))\\r\",\"            return lemmatizedTokens\\r\",\"        \\r\",\"        udfLemmetize = udf(lemmatize, ArrayType(StringType()))\\r\",\"        dataset = dataset.withColumn('lemmatizedTokens',udfLemmetize('clean_tokens'))\\r\",\"\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"],\"outputCols\":\"lemmatizedTokens\"},{\"inputCol\":\"tokens\",\"outputCol\":\"clean_tokens\",\"stopWords\":\"test\"},{\"inputCol\":\"cleanText\",\"outputCol\":\"tokens\"},{\"params\":\"\",\"script\":[\"import logging as logger\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"\\r\",\"\\r\",\"\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        \\r\",\"        def alphaNum(text):\\r\",\"            alphanumeric = ''\\r\",\"            for character in text:\\r\",\"                if character.isalnum():\\r\",\"                    alphanumeric += character\\r\",\"                else:\\r\",\"                    alphanumeric += ' '\\r\",\"            return alphanumeric\\r\",\"        udfAlpaNum = udf(alphaNum, StringType())\\r\",\"        dataset = dataset.withColumn('cleanText',udfAlpaNum('shortdescription'))\\r\",\"        dataset = dataset.select('number','shortDescription', 'cleanText' )\\r\",\"        logger.info(dataset.show())\\r\",\"        return dataset  \\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"],\"outputCols\":\"number,shortDescription,cleanText\"},{\"dataset\":{\"alias\":\"cleantext\",\"name\":\"YS2GY6GCOS\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-09 15:55:40\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-11-09 15:55:40\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT NUMBER, clean_text AS shortdescription , group_by_field FROM @projectname_tickets_enriched WHERE clean_text <> '' AND   clean_text IS NOT NULL \",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"@projectname_tickets_enriched\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"isAuditRequired\":\"\",\"isPermissionManaged\":\"\",\"isApprovalRequired\":\"\",\"isInboxRequired\":\"\",\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"VHGys\",\"alias\":\"Filter tokens\",\"name\":\"Python  Script  Transformer\",\"classname\":\"PythonScriptTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"script\":[\"import logging\\r\",\"from pyspark.sql.types import *\\r\",\"from pyspark.sql.functions import *\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        #remove numbers\\r\",\"        logging.info('lemmatizedTokens')\\r\",\"        def removeNumbers(tokens):\\r\",\"            filteredTokens = []\\r\",\"            for t in tokens:\\r\",\"               if not t.isdigit() and len(t)>2:\\r\",\"                   filteredTokens.append(t)\\r\",\"            return filteredTokens\\r\",\"            \\r\",\"        udfremoveNumber = udf(removeNumbers,ArrayType(StringType()))\\r\",\"        dataset = dataset.withColumn('filteredTokens', udfremoveNumber('lemmatizedTokens'))\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"],\"outputCols\":\"filteredTokens\"},\"position_x\":\"320\",\"position_y\":\"170\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"puTtA\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"KWSQJ\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"script\":\"textarea\",\"outputCols\":\"text\"},\"context\":[{\"script\":[\"import logging\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"from nltk.stem import WordNetLemmatizer\\r\",\"\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"      \\r\",\"        def lemmatize(tokens):\\r\",\"            wordnet_lemmatizer = WordNetLemmatizer()\\r\",\"            lemmatizedTokens = []\\r\",\"            for word in tokens:\\r\",\"                lemmatizedTokens.append(wordnet_lemmatizer.lemmatize(word, pos='v'))\\r\",\"            return lemmatizedTokens\\r\",\"        \\r\",\"        udfLemmetize = udf(lemmatize, ArrayType(StringType()))\\r\",\"        dataset = dataset.withColumn('lemmatizedTokens',udfLemmetize('clean_tokens'))\\r\",\"\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"],\"outputCols\":\"lemmatizedTokens\"},{\"inputCol\":\"tokens\",\"outputCol\":\"clean_tokens\",\"stopWords\":\"test\"},{\"inputCol\":\"cleanText\",\"outputCol\":\"tokens\"},{\"params\":\"\",\"script\":[\"import logging as logger\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"\\r\",\"\\r\",\"\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        \\r\",\"        def alphaNum(text):\\r\",\"            alphanumeric = ''\\r\",\"            for character in text:\\r\",\"                if character.isalnum():\\r\",\"                    alphanumeric += character\\r\",\"                else:\\r\",\"                    alphanumeric += ' '\\r\",\"            return alphanumeric\\r\",\"        udfAlpaNum = udf(alphaNum, StringType())\\r\",\"        dataset = dataset.withColumn('cleanText',udfAlpaNum('shortdescription'))\\r\",\"        dataset = dataset.select('number','shortDescription', 'cleanText' )\\r\",\"        logger.info(dataset.show())\\r\",\"        return dataset  \\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"],\"outputCols\":\"number,shortDescription,cleanText\"},{\"dataset\":{\"alias\":\"cleantext\",\"name\":\"YS2GY6GCOS\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-09 15:55:40\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-11-09 15:55:40\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT NUMBER, clean_text AS shortdescription , group_by_field FROM @projectname_tickets_enriched WHERE clean_text <> '' AND   clean_text IS NOT NULL \",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"@projectname_tickets_enriched\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"isAuditRequired\":\"\",\"isPermissionManaged\":\"\",\"isApprovalRequired\":\"\",\"isInboxRequired\":\"\",\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"cCkPo\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"alias\":\"cleantext\",\"name\":\"YS2GY6GCOS\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-09 15:55:40\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-11-09 15:55:40\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT NUMBER, clean_text AS shortdescription , group_by_field FROM @projectname_tickets_enriched WHERE clean_text <> '' AND   clean_text IS NOT NULL \",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"@projectname_tickets_enriched\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"isAuditRequired\":\"\",\"isPermissionManaged\":\"\",\"isApprovalRequired\":\"\",\"isInboxRequired\":\"\",\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},\"position_x\":\"50\",\"position_y\":\"30\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"ZGDHt\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"nQStO\",\"alias\":\"Dataset  Loader\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"alias\":\"InvertedIndex\",\"name\":\"HL1LW5FMSK\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-09 15:55:40\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-11-09 15:55:40\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select * from @projectname_invertedindex order by frequency\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"@projectname_invertedindex\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"isAuditRequired\":\"\",\"isPermissionManaged\":\"\",\"isApprovalRequired\":\"\",\"isInboxRequired\":\"\",\"groups\":\"\",\"backingDataset\":\"\"},\"applySchema\":false},\"position_x\":\"790\",\"position_y\":\"160\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"KWSQJ\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"applySchema\":\"checkbox\"},\"context\":[{\"params\":\"\",\"script\":[\"import logging\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self,model, dataset):\\r\",\"        dataset = dataset.select('filteredTokens','number')\\r\",\"        dataset = dataset.withColumn('word', explode('filteredTokens'))\\r\",\"        dataset = dataset.distinct()\\r\",\"        dataset = dataset.groupby('word').agg(collect_list('number').alias('numberList'))\\r\",\"        dataset = dataset.withColumn('frequency',  size('numberList'))\\r\",\"        dataset = dataset.withColumn('numberList',  concat_ws(',',col('numberList')))\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},{\"script\":[\"import logging\\r\",\"from pyspark.sql.types import *\\r\",\"from pyspark.sql.functions import *\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        #remove numbers\\r\",\"        logging.info('lemmatizedTokens')\\r\",\"        def removeNumbers(tokens):\\r\",\"            filteredTokens = []\\r\",\"            for t in tokens:\\r\",\"               if not t.isdigit() and len(t)>2:\\r\",\"                   filteredTokens.append(t)\\r\",\"            return filteredTokens\\r\",\"            \\r\",\"        udfremoveNumber = udf(removeNumbers,ArrayType(StringType()))\\r\",\"        dataset = dataset.withColumn('filteredTokens', udfremoveNumber('lemmatizedTokens'))\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"],\"outputCols\":\"filteredTokens\"},{\"script\":[\"import logging\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"from nltk.stem import WordNetLemmatizer\\r\",\"\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"      \\r\",\"        def lemmatize(tokens):\\r\",\"            wordnet_lemmatizer = WordNetLemmatizer()\\r\",\"            lemmatizedTokens = []\\r\",\"            for word in tokens:\\r\",\"                lemmatizedTokens.append(wordnet_lemmatizer.lemmatize(word, pos='v'))\\r\",\"            return lemmatizedTokens\\r\",\"        \\r\",\"        udfLemmetize = udf(lemmatize, ArrayType(StringType()))\\r\",\"        dataset = dataset.withColumn('lemmatizedTokens',udfLemmetize('clean_tokens'))\\r\",\"\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"],\"outputCols\":\"lemmatizedTokens\"},{\"inputCol\":\"tokens\",\"outputCol\":\"clean_tokens\",\"stopWords\":\"test\"},{\"inputCol\":\"cleanText\",\"outputCol\":\"tokens\"},{\"params\":\"\",\"script\":[\"import logging as logger\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"\\r\",\"\\r\",\"\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        \\r\",\"        def alphaNum(text):\\r\",\"            alphanumeric = ''\\r\",\"            for character in text:\\r\",\"                if character.isalnum():\\r\",\"                    alphanumeric += character\\r\",\"                else:\\r\",\"                    alphanumeric += ' '\\r\",\"            return alphanumeric\\r\",\"        udfAlpaNum = udf(alphaNum, StringType())\\r\",\"        dataset = dataset.withColumn('cleanText',udfAlpaNum('shortdescription'))\\r\",\"        dataset = dataset.select('number','shortDescription', 'cleanText' )\\r\",\"        logger.info(dataset.show())\\r\",\"        return dataset  \\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"],\"outputCols\":\"number,shortDescription,cleanText\"},{\"dataset\":{\"alias\":\"cleantext\",\"name\":\"YS2GY6GCOS\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-09 15:55:40\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-11-09 15:55:40\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT NUMBER, clean_text AS shortdescription , group_by_field FROM @projectname_tickets_enriched WHERE clean_text <> '' AND   clean_text IS NOT NULL \",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"@projectname_tickets_enriched\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"isAuditRequired\":\"\",\"isPermissionManaged\":\"\",\"isApprovalRequired\":\"\",\"isInboxRequired\":\"\",\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]}]}","admin","Extract Words","2021-10-25 10:34:21","LEOINVRT15668","leo1311","DragAndDrop","NULL"
"admin","2021-05-03T05:32:52.837","false","Update incident, service request, change request, incident task in SNOW","NULL","{\"elements\":[{\"attributes\":{\"filetype\":\"Python3\",\"files\":[\"SNOW_Update_API_Acme.py\"],\"arguments\":[{\"name\":\"SnowDataSource\",\"value\":\"ACMSNWQB82627\",\"index\":\"1\",\"type\":\"Datasource\",\"alias\":\"SNOW\"},{\"name\":\"api\",\"value\":\"/api/now/table/\",\"index\":\"2\"},{\"name\":\"params\",\"value\":\"sysparm_display_value=true&sysparm_fields=number%2Cshort_description%2Cpriority%2Cstate%2Cdescription%2Csys_id%2Copened_at%2Csys_created_on%2Csys_updated_on%2Cclosed_at%2Cdue_date%2Csys_created_by%2Creopened_time%2Cresolved_at%2Ccategory%2Cclose_code%2Cimpact%2Curgency%2Crequested_for%2Cassignment_group%2Ccaller_id%2Cassigned_to%2Cresolved_by%2Cclosed_by%2Ccmdb_ci%2Cclose_notes%2Clocation%2Crequest_state%2Cprice%2Cspecial_instructions%2Capproval%2Cbusiness_service%2Crisk%2Ctype%2Crequested_by%2Cincident\",\"index\":\"4\"},{\"name\":\"setProxy\",\"value\":\"True\",\"index\":\"5\"},{\"name\":\"LEAPDataSource\",\"value\":\"leo1311\",\"index\":\"10\",\"type\":\"Datasource\"},{\"name\":\"incidentPayload\",\"value\":\"{\\\"shortdescription\\\":\\\"test update\\\",\\\"sysId\\\":\\\"d581f578dbf8501064b334523996193d\\\",\\\"priority\\\":{\\\"displayvalue\\\":\\\"1\\\",\\\"systemId\\\":\\\"1\\\"},\\\"state\\\":{\\\"displayvalue\\\":\\\"In Progress\\\",\\\"systemId\\\":\\\"2\\\"},\\\"category\\\":{\\\"displayvalue\\\":\\\"Inquiry / Help\\\",\\\"systemId\\\":\\\"inquiry\\\"},\\\"impact\\\":{\\\"displayvalue\\\":\\\"1\\\",\\\"systemId\\\":\\\"1\\\"},\\\"urgency\\\":{\\\"systemId\\\":\\\"\\\"},\\\"configurationitem\\\":{\\\"displayvalue\\\":null,\\\"systemId\\\":\\\"\\\"},\\\"description\\\":\\\"P3 - AccessAuthentication - Multiple Login Failure from same User - Windows\\\\\\\\n containing Failure Audit: An account failed to log on\\\\\\\\n\\\",\\\"assignmentgroup\\\":{\\\"displayvalue\\\":\\\"RMA Approvers\\\",\\\"systemId\\\":\\\"1c590685c0a8018b2a473a7159ff5d9a\\\"},\\\"assignedto\\\":{\\\"displayvalue\\\":\\\"Ameya Shetti\\\",\\\"systemId\\\":\\\"01d0c837374da34084720ba754990e0c\\\"},\\\"sop\\\":null,\\\"workflow\\\":null,\\\"resolutionsteps\\\":null}\",\"index\":\"13\"},{\"name\":\"ticketType\",\"value\":\"Incident\",\"type\":\"Text\",\"index\":\"10\"},{\"name\":\"dataTable\",\"value\":\"@projectname_tickets\",\"type\":\"Text\",\"index\":\"9\"}]}}]}","NULL","SNOW_Update_API","NULL","SNOW_Update_API","leo1311","NativeScript","NULL"
"admin","2021-05-28 15:46:38.547000","","Predict Assignment group and assignee for the ticket","NULL","{\"elements\":[{\"id\":\"BRljv\",\"alias\":\"unassigned ticktes\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"alias\":\"unassigned ticktes\",\"name\":\"4TYUOO7J56\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2022-09-02 11:42:05\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encaaa3ndGSH8OUbI/vfgXT8Pn4LCl+KqqT\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://cvictsecst1:3306/leapmaster_ref_data\\\"}\",\"salt\":\"ReTI9aU9y/uSKmRwEi6qCqcrm/MTKYtE06xVz3f5EEoTIFb7IyVvJw+qA5oZkDLtgR0oRhJXBl9JPyMqvAwlFA==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2022-09-02 11:42:04\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, configurationItem FROM @projectname_tickets\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"@projectname_tickets\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":[],\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},\"position_x\":\"110\",\"position_y\":\"160\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"BYjfm\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"thKAM\",\"alias\":\"Dataset  Loader\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"alias\":\"assigned tickets\",\"name\":\"VHMIKDZMCT\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2022-09-02 11:42:05\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encaaa3ndGSH8OUbI/vfgXT8Pn4LCl+KqqT\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://cvictsecst1:3306/leapmaster_ref_data\\\"}\",\"salt\":\"ReTI9aU9y/uSKmRwEi6qCqcrm/MTKYtE06xVz3f5EEoTIFb7IyVvJw+qA5oZkDLtgR0oRhJXBl9JPyMqvAwlFA==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2022-09-02 11:42:04\",\"category\":\"SQL\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select number, predicted_assignment_group from @projectname_tickets_enriched\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"update\",\"params\":\"{}\",\"tableName\":\"@projectname_tickets_enriched\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"backingDataset\":null,\"organization\":\"leo1311\"},\"applySchema\":false},\"position_x\":\"890\",\"position_y\":\"130\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"WUowg\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"applySchema\":\"checkbox\"},\"context\":[{\"script\":[\"import logging\",\"from pyspark.sql.functions import *\",\"class CustomPythonClass():\",\"    def __main__(self, dataset):\",\"        dataset = dataset.select('number',col('assignmentgroup').alias('predicted_assignment_group'))\",\"        return dataset\"]},{\"params\":\"{\\\"IncidentId\\\":\\\"\\\"}\",\"script\":[\"import logging\",\"class CustomPythonClass():\",\"    def __main__(self, dataset1,dataset2):\",\"        incidentId = self.params['IncidentId']\",\"        print('Running for incident '+ incidentId)\",\"        if incidentId !='':\",\"            dataset1 = dataset1.filter(dataset1['number'] == incidentId)\",\"            \",\"        dataset = dataset1.join(dataset2, ('configurationItem'))\",\"        dataset.show()\",\"        return dataset\"]},{\"dataset\":{\"alias\":\"unassigned ticktes\",\"name\":\"4TYUOO7J56\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2022-09-02 11:42:05\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encaaa3ndGSH8OUbI/vfgXT8Pn4LCl+KqqT\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://cvictsecst1:3306/leapmaster_ref_data\\\"}\",\"salt\":\"ReTI9aU9y/uSKmRwEi6qCqcrm/MTKYtE06xVz3f5EEoTIFb7IyVvJw+qA5oZkDLtgR0oRhJXBl9JPyMqvAwlFA==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2022-09-02 11:42:04\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, configurationItem FROM @projectname_tickets\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"@projectname_tickets\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":[],\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"Assignment Config\",\"name\":\"4J7JLN5THW\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2022-09-02 11:42:05\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encaaa3ndGSH8OUbI/vfgXT8Pn4LCl+KqqT\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://cvictsecst1:3306/leapmaster_ref_data\\\"}\",\"salt\":\"ReTI9aU9y/uSKmRwEi6qCqcrm/MTKYtE06xVz3f5EEoTIFb7IyVvJw+qA5oZkDLtgR0oRhJXBl9JPyMqvAwlFA==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2022-09-02 11:42:04\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT DISTINCT configurationItem, assignmentgroup  FROM @projectname_assignment_config\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":[],\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"BYjfm\",\"alias\":\"Pre  Processing  Script\",\"name\":\"Pre  Processing  Script\",\"classname\":\"PreProcessingScriptConfig\",\"category\":\"BaseConfig\",\"attributes\":{\"params\":\"{\\\"IncidentId\\\":\\\"\\\"}\",\"script\":[\"import logging\",\"class CustomPythonClass():\",\"    def __main__(self, dataset1,dataset2):\",\"        incidentId = self.params['IncidentId']\",\"        print('Running for incident '+ incidentId)\",\"        if incidentId !='':\",\"            dataset1 = dataset1.filter(dataset1['number'] == incidentId)\",\"            \",\"        dataset = dataset1.join(dataset2, ('configurationItem'))\",\"        dataset.show()\",\"        return dataset\"]},\"position_x\":\"360\",\"position_y\":\"90\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"dataset1\",\"position\":\"LeftMiddle\",\"elementId\":\"BRljv\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"WUowg\",\"elementPosition\":\"LeftMiddle\"},{\"type\":\"target\",\"endpoint\":\"dataset2\",\"position\":\"TopCenter\",\"elementId\":\"qOpVw\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"dataset1\",\"dataset2\",\"dataset3\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"params\":\"textarea\",\"script\":\"textarea\"},\"context\":[{\"dataset\":{\"alias\":\"unassigned ticktes\",\"name\":\"4TYUOO7J56\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2022-09-02 11:42:05\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encaaa3ndGSH8OUbI/vfgXT8Pn4LCl+KqqT\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://cvictsecst1:3306/leapmaster_ref_data\\\"}\",\"salt\":\"ReTI9aU9y/uSKmRwEi6qCqcrm/MTKYtE06xVz3f5EEoTIFb7IyVvJw+qA5oZkDLtgR0oRhJXBl9JPyMqvAwlFA==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2022-09-02 11:42:04\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, configurationItem FROM @projectname_tickets\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"@projectname_tickets\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":[],\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"Assignment Config\",\"name\":\"4J7JLN5THW\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2022-09-02 11:42:05\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encaaa3ndGSH8OUbI/vfgXT8Pn4LCl+KqqT\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://cvictsecst1:3306/leapmaster_ref_data\\\"}\",\"salt\":\"ReTI9aU9y/uSKmRwEi6qCqcrm/MTKYtE06xVz3f5EEoTIFb7IyVvJw+qA5oZkDLtgR0oRhJXBl9JPyMqvAwlFA==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2022-09-02 11:42:04\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT DISTINCT configurationItem, assignmentgroup  FROM @projectname_assignment_config\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":[],\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"qOpVw\",\"alias\":\"assignment config\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Assignment Config\",\"name\":\"4J7JLN5THW\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2022-09-02 11:42:05\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encaaa3ndGSH8OUbI/vfgXT8Pn4LCl+KqqT\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://cvictsecst1:3306/leapmaster_ref_data\\\"}\",\"salt\":\"ReTI9aU9y/uSKmRwEi6qCqcrm/MTKYtE06xVz3f5EEoTIFb7IyVvJw+qA5oZkDLtgR0oRhJXBl9JPyMqvAwlFA==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2022-09-02 11:42:04\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT DISTINCT configurationItem, assignmentgroup  FROM @projectname_assignment_config\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":[],\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},\"position_x\":\"150\",\"position_y\":\"30\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"BYjfm\",\"elementPosition\":\"TopCenter\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"WUowg\",\"alias\":\"Python  Script  Transformer\",\"name\":\"Python  Script  Transformer\",\"classname\":\"PythonScriptTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"script\":[\"import logging\",\"from pyspark.sql.functions import *\",\"class CustomPythonClass():\",\"    def __main__(self, dataset):\",\"        dataset = dataset.select('number',col('assignmentgroup').alias('predicted_assignment_group'))\",\"        return dataset\"]},\"position_x\":\"570\",\"position_y\":\"130\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"BYjfm\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"thKAM\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"script\":\"textarea\"},\"context\":[{\"params\":\"{\\\"IncidentId\\\":\\\"\\\"}\",\"script\":[\"import logging\",\"class CustomPythonClass():\",\"    def __main__(self, dataset1,dataset2):\",\"        incidentId = self.params['IncidentId']\",\"        print('Running for incident '+ incidentId)\",\"        if incidentId !='':\",\"            dataset1 = dataset1.filter(dataset1['number'] == incidentId)\",\"            \",\"        dataset = dataset1.join(dataset2, ('configurationItem'))\",\"        dataset.show()\",\"        return dataset\"]},{\"dataset\":{\"alias\":\"unassigned ticktes\",\"name\":\"4TYUOO7J56\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2022-09-02 11:42:05\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encaaa3ndGSH8OUbI/vfgXT8Pn4LCl+KqqT\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://cvictsecst1:3306/leapmaster_ref_data\\\"}\",\"salt\":\"ReTI9aU9y/uSKmRwEi6qCqcrm/MTKYtE06xVz3f5EEoTIFb7IyVvJw+qA5oZkDLtgR0oRhJXBl9JPyMqvAwlFA==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2022-09-02 11:42:04\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, configurationItem FROM @projectname_tickets\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"@projectname_tickets\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":[],\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"Assignment Config\",\"name\":\"4J7JLN5THW\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2022-09-02 11:42:05\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encaaa3ndGSH8OUbI/vfgXT8Pn4LCl+KqqT\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://cvictsecst1:3306/leapmaster_ref_data\\\"}\",\"salt\":\"ReTI9aU9y/uSKmRwEi6qCqcrm/MTKYtE06xVz3f5EEoTIFb7IyVvJw+qA5oZkDLtgR0oRhJXBl9JPyMqvAwlFA==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2022-09-02 11:42:04\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT DISTINCT configurationItem, assignmentgroup  FROM @projectname_assignment_config\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":[],\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]}]}","admin","Auto Assignment","2022-08-29 09:17:51","ACMATSGN51350","leo1311","DragAndDrop","NULL"
"admin","2021-10-13 14:44:14.729000","false","NULL","NULL","{\"elements\":[{\"id\":\"cVJae\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"alias\":\"NewDump\",\"name\":\"KU2T9A8U0X\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2022-10-13 06:40:28\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encvtCBzE419NxsjAgba7WetjNAdYZ4U2As\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://cvictsecst1:3306/leapmaster_ref_data\\\"}\",\"salt\":\"pj88CMfvFvguTZCql2VKo4wXJz8+9aHs5JSwo+b1wo6K966RMucUQMlIqFNpgx9hQfanh+MRcKZOl1oLgtMusQ==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2022-10-13 06:40:27\",\"category\":\"SQL\",\"extras\":null},\"schema\":null,\"type\":\"rw\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select * from leo1311_techclassifiedtickets WHERE (State = 'New' OR State = 'Open') AND (Category IS NOT NULL OR Category != 'NULL')\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"leo1311_techclassifiedtickets \",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"isAuditRequired\":false,\"isPermissionManaged\":false,\"isApprovalRequired\":false,\"isInboxRequired\":false,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":[]},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},\"position_x\":\"100\",\"position_y\":\"130\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"VTZdD\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"osGhD\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"alias\":\"TicketsWeightage\",\"name\":\"YTT60VWQBD\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2022-10-13 06:40:28\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encvtCBzE419NxsjAgba7WetjNAdYZ4U2As\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://cvictsecst1:3306/leapmaster_ref_data\\\"}\",\"salt\":\"pj88CMfvFvguTZCql2VKo4wXJz8+9aHs5JSwo+b1wo6K966RMucUQMlIqFNpgx9hQfanh+MRcKZOl1oLgtMusQ==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2022-10-13 06:40:27\",\"category\":\"SQL\",\"extras\":null},\"schema\":null,\"type\":\"rw\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select * from leo1311_priorityweightage\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"leo1311_priorityweightage\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"isAuditRequired\":false,\"isPermissionManaged\":false,\"isApprovalRequired\":false,\"isInboxRequired\":false,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":[]},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},\"position_x\":\"110\",\"position_y\":\"240\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"VTZdD\",\"elementPosition\":\"BottomCenter\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"VTZdD\",\"alias\":\"Pre  Processing  Script\",\"name\":\"Pre  Processing  Script\",\"classname\":\"PreProcessingScriptConfig\",\"category\":\"BaseConfig\",\"attributes\":{\"params\":\"\",\"script\":[\"import logging as logger\\r\",\"from datetime import datetime\\r\",\"from pyspark.sql import SparkSession\\r\",\"from pyspark.sql.functions import col,lit\\r\",\"from pyspark.sql.types import *\\r\",\"import time\\r\",\"import pandas as pd\\r\",\"import pytz\\r\",\"\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, df1, df2, df3):\\r\",\"    \\r\",\"        spark = SparkSession.builder.master('local[*]').appName('ShiftRosterAssignment').getOrCreate()\\r\",\"    \\r\",\"        UnAssignedTickets= df1.join(df3,['Priority'], 'inner')\\r\",\"        IST= pytz.timezone('Asia/Kolkata')\\r\",\"        print('UnAssignedTickets',UnAssignedTickets)\\r\",\"        #current_time = datetime.datetime.now().time().strftime('%H:%M:%S')\\r\",\"        emp_shifts = df2.select('Name','CurrentShift', 'shiftStart', 'shiftEnd','tech').distinct()\\r\",\"        emp_priorityweight= emp_shifts.withColumn('AssignedWeight', lit(0.0))\\r\",\"        emp_priorityweight.show()\\r\",\"        current_time = datetime.now(IST).time().strftime('%H:%M:%S')\\r\",\"        print(current_time)\\r\",\"        current_shift_emp = emp_priorityweight.filter((emp_priorityweight['shiftStart'] <= current_time) &(emp_priorityweight['shiftEnd'] > current_time)).select('Name','AssignedWeight','tech')\\r\",\"        current_shift_emp= current_shift_emp.rdd.map(lambda row: row.asDict()).collect()\\r\",\"        print('current_Shift', current_shift_emp)\\r\",\"        print(type(current_shift_emp))\\r\",\"        #print(type(current_shift_emp[0]))\\r\",\"        techList= df2.select('tech').distinct()\\r\",\"        techList=techList.rdd.map(lambda row: row.asDict()).collect()\\r\",\"        assignedTickets= []\\r\",\"        UnAssignedTickets= UnAssignedTickets.rdd.map(lambda row: row.asDict()).collect()\\r\",\"        for item in techList:\\r\",\"            print('Assigning for', item)\\r\",\"            techEmpList = [e for e in current_shift_emp if e['tech']== item['tech']]\\r\",\"            print('Available Employees', techEmpList)\\r\",\"            if len(techEmpList)>0:\\r\",\"                for ticket in UnAssignedTickets:\\r\",\"                    print(techEmpList)\\r\",\"                    employee= min(techEmpList, key= lambda x:x['AssignedWeight']) \\r\",\"                    e= next(x for x in techEmpList if x['Name']== employee['Name'])\\r\",\"                    e['AssignedWeight'] += ticket['Weight']\\r\",\"                    ticket['assignedTo']= employee['Name']\\r\",\"                    assignedTickets.append({'Number': ticket['Number'], 'AssignedTo': ticket['assignedTo']})\\r\",\"                    \\r\",\"        if len(assignedTickets)>0:\\r\",\"            headers = ['AssignedTo','Number']\\r\",\"            updated = spark.createDataFrame(assignedTickets, headers)\\r\",\"            \\r\",\"            print('Assignment completed')\\r\",\"            updated.show()\\r\",\"            \\r\",\"            return updated\\r\",\"        \\r\",\"    \\r\",\"            \\r\",\"                    \\r\",\"                    \\r\",\"\\r\",\"                \\r\",\"            \\r\",\"\\r\",\"    \\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},\"position_x\":\"370\",\"position_y\":\"130\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"dataset1\",\"position\":\"LeftMiddle\",\"elementId\":\"cVJae\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"target\",\"endpoint\":\"dataset3\",\"position\":\"BottomCenter\",\"elementId\":\"osGhD\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"FNPWq\",\"elementPosition\":\"LeftMiddle\"},{\"type\":\"target\",\"endpoint\":\"dataset2\",\"position\":\"TopCenter\",\"elementId\":\"lPKeA\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"dataset1\",\"dataset2\",\"dataset3\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"params\":\"textarea\",\"script\":\"textarea\"},\"context\":[{\"dataset\":{\"alias\":\"NewDump\",\"name\":\"KU2T9A8U0X\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2022-10-13 06:40:28\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encvtCBzE419NxsjAgba7WetjNAdYZ4U2As\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://cvictsecst1:3306/leapmaster_ref_data\\\"}\",\"salt\":\"pj88CMfvFvguTZCql2VKo4wXJz8+9aHs5JSwo+b1wo6K966RMucUQMlIqFNpgx9hQfanh+MRcKZOl1oLgtMusQ==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2022-10-13 06:40:27\",\"category\":\"SQL\",\"extras\":null},\"schema\":null,\"type\":\"rw\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select * from leo1311_techclassifiedtickets WHERE (State = 'New' OR State = 'Open') AND (Category IS NOT NULL OR Category != 'NULL')\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"leo1311_techclassifiedtickets \",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"isAuditRequired\":false,\"isPermissionManaged\":false,\"isApprovalRequired\":false,\"isInboxRequired\":false,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":[]},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"TicketsWeightage\",\"name\":\"YTT60VWQBD\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2022-10-13 06:40:28\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encvtCBzE419NxsjAgba7WetjNAdYZ4U2As\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://cvictsecst1:3306/leapmaster_ref_data\\\"}\",\"salt\":\"pj88CMfvFvguTZCql2VKo4wXJz8+9aHs5JSwo+b1wo6K966RMucUQMlIqFNpgx9hQfanh+MRcKZOl1oLgtMusQ==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2022-10-13 06:40:27\",\"category\":\"SQL\",\"extras\":null},\"schema\":null,\"type\":\"rw\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select * from leo1311_priorityweightage\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"leo1311_priorityweightage\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"isAuditRequired\":false,\"isPermissionManaged\":false,\"isApprovalRequired\":false,\"isInboxRequired\":false,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":[]},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"RosterData\",\"name\":\"DEP1S7JPWB\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2022-10-13 06:40:28\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encvtCBzE419NxsjAgba7WetjNAdYZ4U2As\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://cvictsecst1:3306/leapmaster_ref_data\\\"}\",\"salt\":\"pj88CMfvFvguTZCql2VKo4wXJz8+9aHs5JSwo+b1wo6K966RMucUQMlIqFNpgx9hQfanh+MRcKZOl1oLgtMusQ==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2022-10-13 06:40:27\",\"category\":\"SQL\",\"extras\":null},\"schema\":null,\"type\":\"rw\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT NAME,track AS tech,shift AS CurrentShift ,STR_TO_DATE(DATE, '%m/%d/%Y') AS DATE,userAvailable,shiftStart,shiftEnd,reassignedShift AS NextShift FROM leo1311_useravailability roster\n JOIN leo1311_rosterdefinition def ON def.shiftName=roster.shift WHERE STR_TO_DATE(DATE, '%m/%d/%Y')=CURRENT_DATE AND userAvailable=1\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"isAuditRequired\":false,\"isPermissionManaged\":false,\"isApprovalRequired\":false,\"isInboxRequired\":false,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":[]},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"lPKeA\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"alias\":\"RosterData\",\"name\":\"DEP1S7JPWB\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2022-10-13 06:40:28\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encvtCBzE419NxsjAgba7WetjNAdYZ4U2As\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://cvictsecst1:3306/leapmaster_ref_data\\\"}\",\"salt\":\"pj88CMfvFvguTZCql2VKo4wXJz8+9aHs5JSwo+b1wo6K966RMucUQMlIqFNpgx9hQfanh+MRcKZOl1oLgtMusQ==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2022-10-13 06:40:27\",\"category\":\"SQL\",\"extras\":null},\"schema\":null,\"type\":\"rw\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT NAME,track AS tech,shift AS CurrentShift ,STR_TO_DATE(DATE, '%m/%d/%Y') AS DATE,userAvailable,shiftStart,shiftEnd,reassignedShift AS NextShift FROM leo1311_useravailability roster\n JOIN leo1311_rosterdefinition def ON def.shiftName=roster.shift WHERE STR_TO_DATE(DATE, '%m/%d/%Y')=CURRENT_DATE AND userAvailable=1\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"isAuditRequired\":false,\"isPermissionManaged\":false,\"isApprovalRequired\":false,\"isInboxRequired\":false,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":[]},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},\"position_x\":\"90\",\"position_y\":\"50\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"VTZdD\",\"elementPosition\":\"TopCenter\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"FNPWq\",\"alias\":\"Python  Script  Transformer\",\"name\":\"Python  Script  Transformer\",\"classname\":\"PythonScriptTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"script\":[\"import logging\\r\",\"import datetime\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        dataset = dataset.select(col('Number').alias('number'),col('AssignedTo').alias('predicted_assignee'))\\r\",\"        dataset = dataset.withColumn('last_updated',lit(datetime.datetime.now()))\\r\",\"        dataset.show()\\r\",\"        return dataset\\r\",\"\\r\"]},\"position_x\":\"610\",\"position_y\":\"130\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"VTZdD\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"zDpXG\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"script\":\"textarea\"},\"context\":[{\"params\":\"\",\"script\":[\"import logging as logger\\r\",\"from datetime import datetime\\r\",\"from pyspark.sql import SparkSession\\r\",\"from pyspark.sql.functions import col,lit\\r\",\"from pyspark.sql.types import *\\r\",\"import time\\r\",\"import pandas as pd\\r\",\"import pytz\\r\",\"\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, df1, df2, df3):\\r\",\"    \\r\",\"        spark = SparkSession.builder.master('local[*]').appName('ShiftRosterAssignment').getOrCreate()\\r\",\"    \\r\",\"        UnAssignedTickets= df1.join(df3,['Priority'], 'inner')\\r\",\"        IST= pytz.timezone('Asia/Kolkata')\\r\",\"        print('UnAssignedTickets',UnAssignedTickets)\\r\",\"        #current_time = datetime.datetime.now().time().strftime('%H:%M:%S')\\r\",\"        emp_shifts = df2.select('Name','CurrentShift', 'shiftStart', 'shiftEnd','tech').distinct()\\r\",\"        emp_priorityweight= emp_shifts.withColumn('AssignedWeight', lit(0.0))\\r\",\"        emp_priorityweight.show()\\r\",\"        current_time = datetime.now(IST).time().strftime('%H:%M:%S')\\r\",\"        print(current_time)\\r\",\"        current_shift_emp = emp_priorityweight.filter((emp_priorityweight['shiftStart'] <= current_time) &(emp_priorityweight['shiftEnd'] > current_time)).select('Name','AssignedWeight','tech')\\r\",\"        current_shift_emp= current_shift_emp.rdd.map(lambda row: row.asDict()).collect()\\r\",\"        print('current_Shift', current_shift_emp)\\r\",\"        print(type(current_shift_emp))\\r\",\"        #print(type(current_shift_emp[0]))\\r\",\"        techList= df2.select('tech').distinct()\\r\",\"        techList=techList.rdd.map(lambda row: row.asDict()).collect()\\r\",\"        assignedTickets= []\\r\",\"        UnAssignedTickets= UnAssignedTickets.rdd.map(lambda row: row.asDict()).collect()\\r\",\"        for item in techList:\\r\",\"            print('Assigning for', item)\\r\",\"            techEmpList = [e for e in current_shift_emp if e['tech']== item['tech']]\\r\",\"            print('Available Employees', techEmpList)\\r\",\"            if len(techEmpList)>0:\\r\",\"                for ticket in UnAssignedTickets:\\r\",\"                    print(techEmpList)\\r\",\"                    employee= min(techEmpList, key= lambda x:x['AssignedWeight']) \\r\",\"                    e= next(x for x in techEmpList if x['Name']== employee['Name'])\\r\",\"                    e['AssignedWeight'] += ticket['Weight']\\r\",\"                    ticket['assignedTo']= employee['Name']\\r\",\"                    assignedTickets.append({'Number': ticket['Number'], 'AssignedTo': ticket['assignedTo']})\\r\",\"                    \\r\",\"        if len(assignedTickets)>0:\\r\",\"            headers = ['AssignedTo','Number']\\r\",\"            updated = spark.createDataFrame(assignedTickets, headers)\\r\",\"            \\r\",\"            print('Assignment completed')\\r\",\"            updated.show()\\r\",\"            \\r\",\"            return updated\\r\",\"        \\r\",\"    \\r\",\"            \\r\",\"                    \\r\",\"                    \\r\",\"\\r\",\"                \\r\",\"            \\r\",\"\\r\",\"    \\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},{\"dataset\":{\"alias\":\"NewDump\",\"name\":\"KU2T9A8U0X\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2022-10-13 06:40:28\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encvtCBzE419NxsjAgba7WetjNAdYZ4U2As\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://cvictsecst1:3306/leapmaster_ref_data\\\"}\",\"salt\":\"pj88CMfvFvguTZCql2VKo4wXJz8+9aHs5JSwo+b1wo6K966RMucUQMlIqFNpgx9hQfanh+MRcKZOl1oLgtMusQ==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2022-10-13 06:40:27\",\"category\":\"SQL\",\"extras\":null},\"schema\":null,\"type\":\"rw\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select * from leo1311_techclassifiedtickets WHERE (State = 'New' OR State = 'Open') AND (Category IS NOT NULL OR Category != 'NULL')\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"leo1311_techclassifiedtickets \",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"isAuditRequired\":false,\"isPermissionManaged\":false,\"isApprovalRequired\":false,\"isInboxRequired\":false,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":[]},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"TicketsWeightage\",\"name\":\"YTT60VWQBD\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2022-10-13 06:40:28\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encvtCBzE419NxsjAgba7WetjNAdYZ4U2As\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://cvictsecst1:3306/leapmaster_ref_data\\\"}\",\"salt\":\"pj88CMfvFvguTZCql2VKo4wXJz8+9aHs5JSwo+b1wo6K966RMucUQMlIqFNpgx9hQfanh+MRcKZOl1oLgtMusQ==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2022-10-13 06:40:27\",\"category\":\"SQL\",\"extras\":null},\"schema\":null,\"type\":\"rw\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select * from leo1311_priorityweightage\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"leo1311_priorityweightage\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"isAuditRequired\":false,\"isPermissionManaged\":false,\"isApprovalRequired\":false,\"isInboxRequired\":false,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":[]},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"RosterData\",\"name\":\"DEP1S7JPWB\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2022-10-13 06:40:28\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encvtCBzE419NxsjAgba7WetjNAdYZ4U2As\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://cvictsecst1:3306/leapmaster_ref_data\\\"}\",\"salt\":\"pj88CMfvFvguTZCql2VKo4wXJz8+9aHs5JSwo+b1wo6K966RMucUQMlIqFNpgx9hQfanh+MRcKZOl1oLgtMusQ==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2022-10-13 06:40:27\",\"category\":\"SQL\",\"extras\":null},\"schema\":null,\"type\":\"rw\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT NAME,track AS tech,shift AS CurrentShift ,STR_TO_DATE(DATE, '%m/%d/%Y') AS DATE,userAvailable,shiftStart,shiftEnd,reassignedShift AS NextShift FROM leo1311_useravailability roster\n JOIN leo1311_rosterdefinition def ON def.shiftName=roster.shift WHERE STR_TO_DATE(DATE, '%m/%d/%Y')=CURRENT_DATE AND userAvailable=1\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"isAuditRequired\":false,\"isPermissionManaged\":false,\"isApprovalRequired\":false,\"isInboxRequired\":false,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":[]},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"zDpXG\",\"alias\":\"Dataset  Loader\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Loader\",\"name\":\"A8VSY5GSCS\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2022-10-13 06:40:28\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encvtCBzE419NxsjAgba7WetjNAdYZ4U2As\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://cvictsecst1:3306/leapmaster_ref_data\\\"}\",\"salt\":\"pj88CMfvFvguTZCql2VKo4wXJz8+9aHs5JSwo+b1wo6K966RMucUQMlIqFNpgx9hQfanh+MRcKZOl1oLgtMusQ==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2022-10-13 06:40:27\",\"category\":\"SQL\",\"extras\":null},\"schema\":null,\"type\":\"rw\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select number, predicted_assignee from leo1311_tickets_assigned where  predicted_assignee is not null order by last_updated desc\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"update\",\"params\":\"{}\",\"tableName\":\"leo1311_tickets_assigned\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"isAuditRequired\":false,\"isPermissionManaged\":false,\"isApprovalRequired\":false,\"isInboxRequired\":false,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":[]},\"applySchema\":false},\"position_x\":\"830\",\"position_y\":\"130\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"FNPWq\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"applySchema\":\"checkbox\"},\"context\":[{\"script\":[\"import logging\\r\",\"import datetime\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        dataset = dataset.select(col('Number').alias('number'),col('AssignedTo').alias('predicted_assignee'))\\r\",\"        dataset = dataset.withColumn('last_updated',lit(datetime.datetime.now()))\\r\",\"        dataset.show()\\r\",\"        return dataset\\r\",\"\\r\"]},{\"params\":\"\",\"script\":[\"import logging as logger\\r\",\"from datetime import datetime\\r\",\"from pyspark.sql import SparkSession\\r\",\"from pyspark.sql.functions import col,lit\\r\",\"from pyspark.sql.types import *\\r\",\"import time\\r\",\"import pandas as pd\\r\",\"import pytz\\r\",\"\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, df1, df2, df3):\\r\",\"    \\r\",\"        spark = SparkSession.builder.master('local[*]').appName('ShiftRosterAssignment').getOrCreate()\\r\",\"    \\r\",\"        UnAssignedTickets= df1.join(df3,['Priority'], 'inner')\\r\",\"        IST= pytz.timezone('Asia/Kolkata')\\r\",\"        print('UnAssignedTickets',UnAssignedTickets)\\r\",\"        #current_time = datetime.datetime.now().time().strftime('%H:%M:%S')\\r\",\"        emp_shifts = df2.select('Name','CurrentShift', 'shiftStart', 'shiftEnd','tech').distinct()\\r\",\"        emp_priorityweight= emp_shifts.withColumn('AssignedWeight', lit(0.0))\\r\",\"        emp_priorityweight.show()\\r\",\"        current_time = datetime.now(IST).time().strftime('%H:%M:%S')\\r\",\"        print(current_time)\\r\",\"        current_shift_emp = emp_priorityweight.filter((emp_priorityweight['shiftStart'] <= current_time) &(emp_priorityweight['shiftEnd'] > current_time)).select('Name','AssignedWeight','tech')\\r\",\"        current_shift_emp= current_shift_emp.rdd.map(lambda row: row.asDict()).collect()\\r\",\"        print('current_Shift', current_shift_emp)\\r\",\"        print(type(current_shift_emp))\\r\",\"        #print(type(current_shift_emp[0]))\\r\",\"        techList= df2.select('tech').distinct()\\r\",\"        techList=techList.rdd.map(lambda row: row.asDict()).collect()\\r\",\"        assignedTickets= []\\r\",\"        UnAssignedTickets= UnAssignedTickets.rdd.map(lambda row: row.asDict()).collect()\\r\",\"        for item in techList:\\r\",\"            print('Assigning for', item)\\r\",\"            techEmpList = [e for e in current_shift_emp if e['tech']== item['tech']]\\r\",\"            print('Available Employees', techEmpList)\\r\",\"            if len(techEmpList)>0:\\r\",\"                for ticket in UnAssignedTickets:\\r\",\"                    print(techEmpList)\\r\",\"                    employee= min(techEmpList, key= lambda x:x['AssignedWeight']) \\r\",\"                    e= next(x for x in techEmpList if x['Name']== employee['Name'])\\r\",\"                    e['AssignedWeight'] += ticket['Weight']\\r\",\"                    ticket['assignedTo']= employee['Name']\\r\",\"                    assignedTickets.append({'Number': ticket['Number'], 'AssignedTo': ticket['assignedTo']})\\r\",\"                    \\r\",\"        if len(assignedTickets)>0:\\r\",\"            headers = ['AssignedTo','Number']\\r\",\"            updated = spark.createDataFrame(assignedTickets, headers)\\r\",\"            \\r\",\"            print('Assignment completed')\\r\",\"            updated.show()\\r\",\"            \\r\",\"            return updated\\r\",\"        \\r\",\"    \\r\",\"            \\r\",\"                    \\r\",\"                    \\r\",\"\\r\",\"                \\r\",\"            \\r\",\"\\r\",\"    \\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},{\"dataset\":{\"alias\":\"NewDump\",\"name\":\"KU2T9A8U0X\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2022-10-13 06:40:28\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encvtCBzE419NxsjAgba7WetjNAdYZ4U2As\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://cvictsecst1:3306/leapmaster_ref_data\\\"}\",\"salt\":\"pj88CMfvFvguTZCql2VKo4wXJz8+9aHs5JSwo+b1wo6K966RMucUQMlIqFNpgx9hQfanh+MRcKZOl1oLgtMusQ==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2022-10-13 06:40:27\",\"category\":\"SQL\",\"extras\":null},\"schema\":null,\"type\":\"rw\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select * from leo1311_techclassifiedtickets WHERE (State = 'New' OR State = 'Open') AND (Category IS NOT NULL OR Category != 'NULL')\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"leo1311_techclassifiedtickets \",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"isAuditRequired\":false,\"isPermissionManaged\":false,\"isApprovalRequired\":false,\"isInboxRequired\":false,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":[]},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"TicketsWeightage\",\"name\":\"YTT60VWQBD\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2022-10-13 06:40:28\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encvtCBzE419NxsjAgba7WetjNAdYZ4U2As\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://cvictsecst1:3306/leapmaster_ref_data\\\"}\",\"salt\":\"pj88CMfvFvguTZCql2VKo4wXJz8+9aHs5JSwo+b1wo6K966RMucUQMlIqFNpgx9hQfanh+MRcKZOl1oLgtMusQ==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2022-10-13 06:40:27\",\"category\":\"SQL\",\"extras\":null},\"schema\":null,\"type\":\"rw\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select * from leo1311_priorityweightage\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"leo1311_priorityweightage\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"isAuditRequired\":false,\"isPermissionManaged\":false,\"isApprovalRequired\":false,\"isInboxRequired\":false,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":[]},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"RosterData\",\"name\":\"DEP1S7JPWB\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2022-10-13 06:40:28\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encvtCBzE419NxsjAgba7WetjNAdYZ4U2As\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"jdbc:mysql://cvictsecst1:3306/leapmaster_ref_data\\\"}\",\"salt\":\"pj88CMfvFvguTZCql2VKo4wXJz8+9aHs5JSwo+b1wo6K966RMucUQMlIqFNpgx9hQfanh+MRcKZOl1oLgtMusQ==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2022-10-13 06:40:27\",\"category\":\"SQL\",\"extras\":null},\"schema\":null,\"type\":\"rw\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT NAME,track AS tech,shift AS CurrentShift ,STR_TO_DATE(DATE, '%m/%d/%Y') AS DATE,userAvailable,shiftStart,shiftEnd,reassignedShift AS NextShift FROM leo1311_useravailability roster\n JOIN leo1311_rosterdefinition def ON def.shiftName=roster.shift WHERE STR_TO_DATE(DATE, '%m/%d/%Y')=CURRENT_DATE AND userAvailable=1\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"isAuditRequired\":false,\"isPermissionManaged\":false,\"isApprovalRequired\":false,\"isInboxRequired\":false,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":[]},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]}]}","admin","TicketsAssignment","2021-10-25 10:34:21","LEOTCKTS56442","leo1311","DragAndDrop","NULL"