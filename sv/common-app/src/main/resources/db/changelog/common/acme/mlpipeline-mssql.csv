"created_by","created_date","deleted","description","job_id","json_content","lastmodifiedby","alias","lastmodifieddate","name","organization","type","version"
"admin","2021-05-25 09:08:41.219000","false","Cluster Machine generated tickets eg- alerts ","NULL","{\"elements\":[{\"id\":\"PiYva\",\"alias\":\"Tickets\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"id\":39032,\"name\":\"input\",\"alias\":\"input\",\"description\":\"Tickets with soundex of Short description\",\"schema\":null,\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, Soundex(clean_text) as sound, CASE WHEN group_by_field IS NULL THEN '' ELSE group_by_field END AS group_by_field FROM @projectname_tickets_enriched  WHERE clean_text is not null and  Soundex(clean_text) <> '' and clean_text <> ''\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MSSQL\",\"expStatus\":0,\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-07-27 10:51:41\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-07-27 10:51:41\",\"category\":\"SQL\"},\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":false},\"position_x\":\"170\",\"position_y\":\"80\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"CSUzm\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"CSUzm\",\"alias\":\"Create Clusters\",\"name\":\"Python  Script  Transformer\",\"classname\":\"PythonScriptTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"script\":[\"import logging\\r\",\"from datetime import datetime\\r\",\"from pyspark.sql.types import *\\r\",\"from pyspark.sql.functions import *\\r\",\"import re\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        soundDf = dataset.groupBy('group_by_field','sound').agg(collect_list('number').alias('numberList'), collect_list('clean_text').alias('text_list'))\\r\",\"\\r\",\"       \\r\",\"        soundDf = soundDf.withColumn('numberListSize', size('numberList'))\\r\",\"        soundDf = soundDf.filter(soundDf['numberListSize']>=5)\\r\",\"        soundDf = soundDf.withColumn('cluster' , soundDf['text_list'].getItem(0)).drop('text_list')\\r\",\"        \\r\",\"        soundDf = soundDf.select('group_by_field', 'cluster', 'numberList','sound')\\r\",\"        soundDf = soundDf.withColumn('number',explode('numberList')).drop('numberList')\\r\",\"        soundDf = soundDf.withColumn('last_updated',lit(datetime.now()))\\r\",\"\\r\",\"        soundDf = soundDf.select('number',col('cluster').alias('soundex_cluster'),'last_updated')\\r\",\"\\r\",\"        \\r\",\"        soundDf = soundDf.repartition(50)\\r\",\"        return soundDf\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},\"position_x\":\"460\",\"position_y\":\"80\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"PiYva\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"MNpqZ\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"script\":\"textarea\"},\"context\":[{\"dataset\":{\"id\":39032,\"name\":\"input\",\"alias\":\"input\",\"description\":\"Tickets with soundex of Short description\",\"schema\":null,\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, Soundex(clean_text) as sound, CASE WHEN group_by_field IS NULL THEN '' ELSE group_by_field END AS group_by_field FROM @projectname_tickets_enriched  WHERE clean_text is not null and  Soundex(clean_text) <> '' and clean_text <> ''\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MSSQL\",\"expStatus\":0,\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-07-27 10:51:41\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-07-27 10:51:41\",\"category\":\"SQL\"},\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":false}]},{\"id\":\"MNpqZ\",\"alias\":\"Clusters\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"id\":39032,\"name\":\"DJR9U1LGA5\",\"alias\":\"Cluster\",\"description\":\"Tickets with soundex of Short description\",\"schema\":null,\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"Select  number , soundex_cluster, last_updated from @projectname_soundex\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"overwrite\",\"params\":\"{}\",\"tableName\":\"@projectname_soundex\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"rw\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MSSQL\",\"groups\":\"\",\"expStatus\":0,\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-07-27 10:51:41\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-07-27 10:51:41\",\"category\":\"SQL\"}},\"applySchema\":false},\"position_x\":\"770\",\"position_y\":\"80\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"CSUzm\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"applySchema\":\"checkbox\"},\"context\":[{\"script\":[\"import logging\\r\",\"from datetime import datetime\\r\",\"from pyspark.sql.types import *\\r\",\"from pyspark.sql.functions import *\\r\",\"import re\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        soundDf = dataset.groupBy('group_by_field','sound').agg(collect_list('number').alias('numberList'), collect_list('clean_text').alias('text_list'))\\r\",\"\\r\",\"       \\r\",\"        soundDf = soundDf.withColumn('numberListSize', size('numberList'))\\r\",\"        soundDf = soundDf.filter(soundDf['numberListSize']>=5)\\r\",\"        soundDf = soundDf.withColumn('cluster' , soundDf['text_list'].getItem(0)).drop('text_list')\\r\",\"        \\r\",\"        soundDf = soundDf.select('group_by_field', 'cluster', 'numberList','sound')\\r\",\"        soundDf = soundDf.withColumn('number',explode('numberList')).drop('numberList')\\r\",\"        soundDf = soundDf.withColumn('last_updated',lit(datetime.now()))\\r\",\"\\r\",\"        soundDf = soundDf.select('number',col('cluster').alias('soundex_cluster'),'last_updated')\\r\",\"\\r\",\"        \\r\",\"        soundDf = soundDf.repartition(50)\\r\",\"        return soundDf\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},{\"dataset\":{\"id\":39032,\"name\":\"input\",\"alias\":\"input\",\"description\":\"Tickets with soundex of Short description\",\"schema\":null,\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, Soundex(clean_text) as sound, CASE WHEN group_by_field IS NULL THEN '' ELSE group_by_field END AS group_by_field FROM @projectname_tickets_enriched  WHERE clean_text is not null and  Soundex(clean_text) <> '' and clean_text <> ''\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MSSQL\",\"expStatus\":0,\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-07-27 10:51:41\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-07-27 10:51:41\",\"category\":\"SQL\"},\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":false}]}]}","NULL","Clustering Soundex","NULL","ACMCLSTR99942","leo1311","DragAndDrop","NULL"
"admin","2021-05-25 14:50:13.421000","false","Cluster human created tickets on short description","NULL","{\"elements\":[{\"id\":\"OxxDW\",\"alias\":\"Filter Dataset\",\"name\":\"Pre  Processing  Script\",\"classname\":\"PreProcessingScriptConfig\",\"category\":\"BaseConfig\",\"attributes\":{\"params\":\"{}\",\"script\":[\"import logging as logger\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        data = dataset.withColumn('cluster_Type',lit('LDA'))\\r\",\"        filteredCIs = data.groupBy('group_by_field').count().filter((col('count') >=50) ).select('group_by_field')\\r\",\"        ciList= filteredCIs.rdd.map(lambda r: r[0]).collect()\\r\",\"        if ciList is not None and len(ciList) ==0:\\r\",\"            logger.info('No data for clustering')\\r\",\"            logger.info('Completed')\\r\",\"            print('Completed')\\r\",\"            exit()\\r\",\"        filtereddf = data.filter(col('group_by_field').isin(ciList))\\r\",\"        return filtereddf\\r\"]},\"position_x\":\"340\",\"position_y\":\"100\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"sXmyX\",\"elementPosition\":\"LeftMiddle\"},{\"type\":\"target\",\"endpoint\":\"dataset1\",\"position\":\"LeftMiddle\",\"elementId\":\"LREJS\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"dataset1\",\"dataset2\",\"dataset3\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"params\":\"textarea\",\"script\":\"textarea\"},\"context\":[{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"Tickets for LDA Clustering\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-05-25 07:58:24\",\"alias\":\"LDA Cluster\",\"id\":7,\"name\":\"ACMLDCLS54038\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"clean_text\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"group_by_field\\\",\\\"recordcolumndisplayname\\\":\\\"group_by_field\\\"}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, CASE WHEN group_by_field IS NULL THEN '' ELSE group_by_field END AS group_by_field  FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text <> ''\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"IUlqx\",\"alias\":\"Post  Processing  Script\",\"name\":\"Post  Processing  Script\",\"classname\":\"PostProcessingScriptConfig\",\"category\":\"BaseConfig\",\"attributes\":{\"params\":\"\",\"script\":[\"import logging\\r\",\"from pyspark.sql.types import *\\r\",\"from pyspark.sql.functions import *\\r\",\"from datetime import datetime\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self,model, dataset):\\r\",\"        dataset = dataset['out']\\r\",\"        dataset = dataset.select('number',col('cluster_name').alias('lda_cluster') )\\r\",\"        dataset = dataset.withColumn('last_updated',lit(datetime.now()))\\r\",\"        dataset = dataset.repartition(200)\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},\"position_x\":\"720\",\"position_y\":\"240\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"XJUTb\",\"elementPosition\":\"LeftMiddle\"},{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"sXmyX\",\"elementPosition\":\"BottomCenter\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\",\"out2\"],\"requiredJars\":[],\"formats\":{\"params\":\"textarea\",\"script\":\"textarea\"},\"context\":[{\"UniqueIdColumn\":\"number\",\"GroupByColumn\":\"group_by_field\",\"TextColumn\":\"clean_text\",\"customStopWords\":\"\",\"vocabSize\":\"10000\",\"ClusterCount\":\"10\",\"checkPointInterval\":\"10\",\"saveModels\":\"\"},{\"params\":\"{}\",\"script\":[\"import logging as logger\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        data = dataset.withColumn('cluster_Type',lit('LDA'))\\r\",\"        filteredCIs = data.groupBy('group_by_field').count().filter((col('count') >=50) ).select('group_by_field')\\r\",\"        ciList= filteredCIs.rdd.map(lambda r: r[0]).collect()\\r\",\"        if ciList is not None and len(ciList) ==0:\\r\",\"            logger.info('No data for clustering')\\r\",\"            logger.info('Completed')\\r\",\"            print('Completed')\\r\",\"            exit()\\r\",\"        filtereddf = data.filter(col('group_by_field').isin(ciList))\\r\",\"        return filtereddf\\r\"]},{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"Tickets for LDA Clustering\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-05-25 07:58:24\",\"alias\":\"LDA Cluster\",\"id\":7,\"name\":\"ACMLDCLS54038\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"clean_text\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"group_by_field\\\",\\\"recordcolumndisplayname\\\":\\\"group_by_field\\\"}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, CASE WHEN group_by_field IS NULL THEN '' ELSE group_by_field END AS group_by_field  FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text <> ''\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"hPWgu\",\"alias\":\"Dataset  Loader\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Topics\",\"name\":\"\",\"description\":\"Clustering topics vocab\",\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"Select * from @projectname_clustering_topics\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"overwrite\",\"params\":\"{}\",\"tableName\":\"@projectname_clustering_topics\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-07-27 10:51:41\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-07-27 10:51:41\",\"category\":\"SQL\"}},\"applySchema\":false},\"position_x\":\"840\",\"position_y\":\"100\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"sXmyX\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"applySchema\":\"checkbox\"},\"context\":[{\"UniqueIdColumn\":\"number\",\"GroupByColumn\":\"group_by_field\",\"TextColumn\":\"clean_text\",\"customStopWords\":\"\",\"vocabSize\":\"10000\",\"ClusterCount\":\"10\",\"checkPointInterval\":\"10\",\"saveModels\":\"\"},{\"params\":\"{}\",\"script\":[\"import logging as logger\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        data = dataset.withColumn('cluster_Type',lit('LDA'))\\r\",\"        filteredCIs = data.groupBy('group_by_field').count().filter((col('count') >=50) ).select('group_by_field')\\r\",\"        ciList= filteredCIs.rdd.map(lambda r: r[0]).collect()\\r\",\"        if ciList is not None and len(ciList) ==0:\\r\",\"            logger.info('No data for clustering')\\r\",\"            logger.info('Completed')\\r\",\"            print('Completed')\\r\",\"            exit()\\r\",\"        filtereddf = data.filter(col('group_by_field').isin(ciList))\\r\",\"        return filtereddf\\r\"]},{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"Tickets for LDA Clustering\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-05-25 07:58:24\",\"alias\":\"LDA Cluster\",\"id\":7,\"name\":\"ACMLDCLS54038\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"clean_text\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"group_by_field\\\",\\\"recordcolumndisplayname\\\":\\\"group_by_field\\\"}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, CASE WHEN group_by_field IS NULL THEN '' ELSE group_by_field END AS group_by_field  FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text <> ''\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"XJUTb\",\"alias\":\"Dataset  Loader\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Clusters\",\"name\":\"KBJUD4APBG\",\"description\":\"LDA clusters\",\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT  number , lda_cluster,lda_cluster_confidence, last_updated  from  @projectname_lda\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"overwrite\",\"params\":\"{}\",\"tableName\":\"@projectname_lda\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-07-27 10:51:41\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-07-27 10:51:41\",\"category\":\"SQL\"}},\"applySchema\":false},\"position_x\":\"950\",\"position_y\":\"240\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"IUlqx\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"applySchema\":\"checkbox\"},\"context\":[{\"params\":\"\",\"script\":[\"import logging\\r\",\"from pyspark.sql.types import *\\r\",\"from pyspark.sql.functions import *\\r\",\"from datetime import datetime\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self,model, dataset):\\r\",\"        dataset = dataset['out']\\r\",\"        dataset = dataset.select('number',col('cluster_name').alias('lda_cluster') )\\r\",\"        dataset = dataset.withColumn('last_updated',lit(datetime.now()))\\r\",\"        dataset = dataset.repartition(200)\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},{\"UniqueIdColumn\":\"number\",\"GroupByColumn\":\"group_by_field\",\"TextColumn\":\"clean_text\",\"customStopWords\":\"\",\"vocabSize\":\"10000\",\"ClusterCount\":\"10\",\"checkPointInterval\":\"10\",\"saveModels\":\"\"},{\"params\":\"{}\",\"script\":[\"import logging as logger\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        data = dataset.withColumn('cluster_Type',lit('LDA'))\\r\",\"        filteredCIs = data.groupBy('group_by_field').count().filter((col('count') >=50) ).select('group_by_field')\\r\",\"        ciList= filteredCIs.rdd.map(lambda r: r[0]).collect()\\r\",\"        if ciList is not None and len(ciList) ==0:\\r\",\"            logger.info('No data for clustering')\\r\",\"            logger.info('Completed')\\r\",\"            print('Completed')\\r\",\"            exit()\\r\",\"        filtereddf = data.filter(col('group_by_field').isin(ciList))\\r\",\"        return filtereddf\\r\"]},{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"Tickets for LDA Clustering\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-05-25 07:58:24\",\"alias\":\"LDA Cluster\",\"id\":7,\"name\":\"ACMLDCLS54038\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"clean_text\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"group_by_field\\\",\\\"recordcolumndisplayname\\\":\\\"group_by_field\\\"}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, CASE WHEN group_by_field IS NULL THEN '' ELSE group_by_field END AS group_by_field  FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text <> ''\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"LREJS\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"Tickets for LDA Clustering\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-07-27 10:51:41\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-07-27 10:51:41\",\"category\":\"SQL\"},\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-05-25 07:58:24\",\"alias\":\"LDA Cluster\",\"id\":7,\"name\":\"ACMLDCLS54038\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"clean_text\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"group_by_field\\\",\\\"recordcolumndisplayname\\\":\\\"group_by_field\\\"}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, CASE WHEN group_by_field IS NULL THEN '' ELSE group_by_field END AS group_by_field  FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text <> ''\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},\"position_x\":\"60\",\"position_y\":\"100\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"OxxDW\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"sXmyX\",\"alias\":\"Incident  Clustering\",\"name\":\"Incident  Clustering\",\"classname\":\"IncidentClusteringLDAConfig\",\"category\":\"DomainSolutionConfig\",\"attributes\":{\"UniqueIdColumn\":\"number\",\"GroupByColumn\":\"group_by_field\",\"TextColumn\":\"clean_text\",\"customStopWords\":\"\",\"vocabSize\":\"10000\",\"ClusterCount\":\"10\",\"checkPointInterval\":\"10\",\"saveModels\":\"\"},\"position_x\":\"590\",\"position_y\":\"100\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"OxxDW\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"topics\",\"position\":\"RightMiddle\",\"elementId\":\"hPWgu\",\"elementPosition\":\"LeftMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"BottomCenter\",\"elementId\":\"IUlqx\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"topics\",\"out\"],\"requiredJars\":[],\"formats\":{\"UniqueIdColumn\":\"text\",\"GroupByColumn\":\"text\",\"TextColumn\":\"text\",\"customStopWords\":\"text\",\"vocabSize\":\"text\",\"ClusterCount\":\"text\",\"checkPointInterval\":\"text\",\"saveModels\":\"checkbox\"},\"context\":[{\"params\":\"{}\",\"script\":[\"import logging as logger\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        data = dataset.withColumn('cluster_Type',lit('LDA'))\\r\",\"        filteredCIs = data.groupBy('group_by_field').count().filter((col('count') >=50) ).select('group_by_field')\\r\",\"        ciList= filteredCIs.rdd.map(lambda r: r[0]).collect()\\r\",\"        if ciList is not None and len(ciList) ==0:\\r\",\"            logger.info('No data for clustering')\\r\",\"            logger.info('Completed')\\r\",\"            print('Completed')\\r\",\"            exit()\\r\",\"        filtereddf = data.filter(col('group_by_field').isin(ciList))\\r\",\"        return filtereddf\\r\"]},{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"Tickets for LDA Clustering\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-05-25 07:58:24\",\"alias\":\"LDA Cluster\",\"id\":7,\"name\":\"ACMLDCLS54038\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"clean_text\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"group_by_field\\\",\\\"recordcolumndisplayname\\\":\\\"group_by_field\\\"}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, CASE WHEN group_by_field IS NULL THEN '' ELSE group_by_field END AS group_by_field  FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text <> ''\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]}]}","NULL","Clustering LDA","NULL","ACMCLSTR21224","leo1311","DragAndDrop","NULL"
"admin","2021-05-25 10:28:07.541000","false","Extract phrases from text","NULL","{\"elements\":[{\"id\":\"UEeVc\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"name\":\"ZK0CN34C9S\",\"alias\":\"Tickets\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text <> ''\",\"Cacheable\":\"\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"datasetType\":\"MSSQL\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"expStatus\":0,\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},\"position_x\":\"40\",\"position_y\":\"30\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"XQVmY\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"HYOWn\",\"alias\":\"Dataset  Loader\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"name\":\"RGQTFH97NN\",\"alias\":\"Phrases\",\"description\":\"Phrases\",\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select number, extracted_phrase, mapped_phrase, mapped_phrase_confidennce, last_updated from @projectname_phrase_extraction\",\"Cacheable\":\"\",\"isStreaming\":\"false\",\"writeMode\":\"overwrite\",\"params\":\"{}\",\"tableName\":\"@projectname_phrase_extraction\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"datasetType\":\"MSSQL\",\"groups\":\"\",\"backingDataset\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"}},\"applySchema\":false},\"position_x\":\"730\",\"position_y\":\"30\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"XQVmY\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"applySchema\":\"checkbox\"},\"context\":[{\"script\":[\"import logging\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"import spacy\\r\",\"import pytextrank\\r\",\"from datetime import datetime\\r\",\"from pyspark.sql import SparkSession\\r\",\"\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        spark = SparkSession.builder.getOrCreate()\\r\",\"        nlp = spacy.load('en_core_web_sm')\\r\",\"        nlp.add_pipe('textrank')\\r\",\"        nlp_broadcast = spark.sparkContext.broadcast(nlp)\\r\",\"\\r\",\"        def getPharase(text):\\r\",\"            doc = nlp_broadcast.value(text)\\r\",\"            phrase =''\\r\",\"            if len(doc._.phrases)>0:\\r\",\"                for item in doc._.phrases:\\r\",\"                    withoutSpace = item.text.replace(' ' ,'')\\r\",\"                    if not withoutSpace.isdigit() and len(item.text.split(' ')) >1:\\r\",\"                        phrase = item.text\\r\",\"                        break\\r\",\"                return phrase\\r\",\"            else:\\r\",\"                return text\\r\",\"        \\r\",\"        udfPhrases = udf(getPharase,StringType())\\r\",\"        dataset.show()\\r\",\"        dataset = dataset.withColumn('extracted_phrase',udfPhrases('clean_text'))\\r\",\"        dataset = dataset.select('number','extracted_phrase')\\r\",\"        dataset = dataset.withColumn('mapped_phrase',lit(' '))\\r\",\"        dataset = dataset.withColumn('mapped_phrase_confidennce',lit(' '))\\r\",\"        dataset = dataset.withColumn('last_updated',lit(datetime.now()))\\r\",\"        dataset.show()\\r\",\"\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"],\"outputCols\":\"text\"},{\"dataset\":{\"name\":\"ZK0CN34C9S\",\"alias\":\"Tickets\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text <> ''\",\"Cacheable\":\"\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"datasetType\":\"MSSQL\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"expStatus\":0,\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"XQVmY\",\"alias\":\"Phrase extraction\",\"name\":\"Python  Script  Transformer\",\"classname\":\"PythonScriptTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"script\":[\"import logging\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"import spacy\\r\",\"import pytextrank\\r\",\"from datetime import datetime\\r\",\"from pyspark.sql import SparkSession\\r\",\"\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        spark = SparkSession.builder.getOrCreate()\\r\",\"        nlp = spacy.load('en_core_web_sm')\\r\",\"        nlp.add_pipe('textrank')\\r\",\"        nlp_broadcast = spark.sparkContext.broadcast(nlp)\\r\",\"\\r\",\"        def getPharase(text):\\r\",\"            doc = nlp_broadcast.value(text)\\r\",\"            phrase =''\\r\",\"            if len(doc._.phrases)>0:\\r\",\"                for item in doc._.phrases:\\r\",\"                    withoutSpace = item.text.replace(' ' ,'')\\r\",\"                    if not withoutSpace.isdigit() and len(item.text.split(' ')) >1:\\r\",\"                        phrase = item.text\\r\",\"                        break\\r\",\"                return phrase\\r\",\"            else:\\r\",\"                return text\\r\",\"        \\r\",\"        udfPhrases = udf(getPharase,StringType())\\r\",\"        dataset.show()\\r\",\"        dataset = dataset.withColumn('extracted_phrase',udfPhrases('clean_text'))\\r\",\"        dataset = dataset.select('number','extracted_phrase')\\r\",\"        dataset = dataset.withColumn('mapped_phrase',lit(' '))\\r\",\"        dataset = dataset.withColumn('mapped_phrase_confidennce',lit(' '))\\r\",\"        dataset = dataset.withColumn('last_updated',lit(datetime.now()))\\r\",\"        dataset.show()\\r\",\"\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"],\"outputCols\":\"text\"},\"position_x\":\"330\",\"position_y\":\"30\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"UEeVc\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"HYOWn\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"script\":\"textarea\",\"outputCols\":\"text\"},\"context\":[{\"dataset\":{\"name\":\"ZK0CN34C9S\",\"alias\":\"Tickets\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text <> ''\",\"Cacheable\":\"\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"datasetType\":\"MSSQL\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"expStatus\":0,\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]}]}","admin","Phrase Extraction","2021-11-18 08:25:45","ACMPHRSX44652","leo1311","DragAndDrop","NULL"
"admin","2021-04-05 10:58:00.567000","false","Map SOP for tickets","NULL","{\"elements\":[{\"id\":\"ELzwB\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"id\":39049,\"name\":\"Tickets\",\"alias\":\"Tickets\",\"description\":\"Tickets to classify SOP\",\"schema\":{\"id\":10109,\"name\":\"IcmticketsClassifySchema\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"Number\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"shortdescription\\\",\\\"recordcolumndisplayname\\\":\\\"shortdescription\\\"}]\",\"organization\":\"leo1311\"},\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select number, shortdescription from @projectname_tickets where  shortdescription is not null and shortdescription <> ''\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MSSQL\",\"expStatus\":0,\"groups\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-28 07:50:46\",\"alias\":\"leo1311\",\"id\":2,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encDFA7GGtjoS9sUXcj8Fa63LyB3Z3LRMzb\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"0d0ac5a054e1e39cbabb4e48898d0bc5b5e24f8c25e3ef2fcc9bf20574f7b774\",\"activetime\":\"2021-06-28 08:22:03\",\"category\":\"SQL\"}},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":false},\"position_x\":\"110\",\"position_y\":\"140\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"RuWix\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"mKdkm\",\"alias\":\"Dataset  Loader\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"id\":39050,\"name\":\"output\",\"alias\":\"output\",\"description\":\"predicted sop for tickets\",\"schema\":{\"id\":10110,\"name\":\"aioWorkFlowSchema\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"Number\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"work_flow\\\",\\\"recordcolumndisplayname\\\":\\\"Work_flow\\\"}]\",\"organization\":\"leo1311\"},\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select number, sop, sop_confidence, last_updated from @projectname_tickets_enriched \",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"update\",\"params\":\"{}\",\"tableName\":\"@projectname_tickets_enriched\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"rw\",\"backingDataset\":\"\",\"organization\":\"BCBSA\",\"datasetType\":\"MSSQL\",\"groups\":\"\",\"expStatus\":0,\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-28 07:50:46\",\"alias\":\"leo1311\",\"id\":2,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encDFA7GGtjoS9sUXcj8Fa63LyB3Z3LRMzb\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"0d0ac5a054e1e39cbabb4e48898d0bc5b5e24f8c25e3ef2fcc9bf20574f7b774\",\"activetime\":\"2021-06-28 08:22:03\",\"category\":\"SQL\"}},\"applySchema\":false},\"position_x\":\"780\",\"position_y\":\"140\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"xtOmg\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"applySchema\":\"checkbox\"},\"context\":[{\"script\":[\"import logging\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        print('python transformer')\\r\",\"        dataset.show()    \\r\",\"        return dataset\\r\"]},{\"params\":\"{\\\"IncidentId\\\":\\\"\\\"}\",\"script\":[\"from pyspark.sql.functions import *\\r\",\"import pyspark.sql.functions as F\\r\",\"from pyspark.sql.types import *\\r\",\"from datetime import datetime\\r\",\"from functools import partial\\r\",\"import re\\r\",\"import logging as logger\\r\",\"\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset1, dataset2):\\r\",\"        incidentId = self.params['IncidentId']\\r\",\"        print('Running for incident '+ incidentId)\\r\",\"        if incidentId !='':\\r\",\"            dataset1 = dataset1.filter(dataset1['number'] == incidentId)\\r\",\"        logger.info(dataset1.show())\\r\",\"        label_list = dataset2.rdd.map(lambda x:{'sop':x.sop,'workflow':x.workflow,'regex':x.regular_exp}).collect()\\r\",\"        \\r\",\"        def getsop(label,text):\\r\",\"            for item in label:\\r\",\"                ismatch = re.match(item['regex'],text.lower())\\r\",\"                if ismatch != None:\\r\",\"                    return item['sop']\\r\",\"            return\\r\",\"        \\r\",\"        def getWorkflow(label , text):\\r\",\"            for item in label:\\r\",\"                ismatch = re.match(item['regex'],text.lower())\\r\",\"                if ismatch != None:\\r\",\"                    return item['workflow']\\r\",\"            return\\r\",\"        \\r\",\"            \\r\",\"        def udf_sop(label_list):\\r\",\"            return udf(lambda l: getsop(label_list, l))\\r\",\"        def udf_workflow(label_list):\\r\",\"            return udf(lambda l: getWorkflow(label_list, l))\\r\",\"            \\r\",\"        \\r\",\"        data = dataset1.withColumn('sop', udf_sop(label_list)(col('shortdescription')))\\r\",\"        data = data.filter(col('sop') != 'undefined')\\r\",\"        data = data.withColumn('sop_confidence', lit('100'))\\r\",\"        data = data.withColumn('workflow', udf_workflow(label_list)(col('shortdescription')))\\r\",\"        data = data.withColumn('last_updated', lit(datetime.now()))\\r\",\"        \\r\",\"        data = data.select('number','sop','sop_confidence','workflow','last_updated')\\r\",\"        \\r\",\"        logger.info(data.show())\\r\",\"        return data\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},{\"dataset\":{\"id\":39049,\"name\":\"Tickets\",\"alias\":\"Tickets\",\"description\":\"Tickets to classify SOP\",\"schema\":{\"id\":10109,\"name\":\"IcmticketsClassifySchema\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"Number\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"shortdescription\\\",\\\"recordcolumndisplayname\\\":\\\"shortdescription\\\"}]\",\"organization\":\"leo1311\"},\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select number, shortdescription from @projectname_tickets where  shortdescription is not null and shortdescription <> ''\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MSSQL\",\"expStatus\":0,\"groups\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-28 07:50:46\",\"alias\":\"leo1311\",\"id\":2,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encDFA7GGtjoS9sUXcj8Fa63LyB3Z3LRMzb\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"0d0ac5a054e1e39cbabb4e48898d0bc5b5e24f8c25e3ef2fcc9bf20574f7b774\",\"activetime\":\"2021-06-28 08:22:03\",\"category\":\"SQL\"}},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":false},{\"dataset\":{\"alias\":\"sop_config\",\"name\":\"\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-28 07:50:46\",\"alias\":\"leo1311\",\"id\":2,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encDFA7GGtjoS9sUXcj8Fa63LyB3Z3LRMzb\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"0d0ac5a054e1e39cbabb4e48898d0bc5b5e24f8c25e3ef2fcc9bf20574f7b774\",\"activetime\":\"2021-06-28 08:22:03\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select * from @projectname_sop_config\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"RuWix\",\"alias\":\"Pre  Processing  Script\",\"name\":\"Pre  Processing  Script\",\"classname\":\"PreProcessingScriptConfig\",\"category\":\"BaseConfig\",\"attributes\":{\"params\":\"{\\\"IncidentId\\\":\\\"\\\"}\",\"script\":[\"from pyspark.sql.functions import *\\r\",\"import pyspark.sql.functions as F\\r\",\"from pyspark.sql.types import *\\r\",\"from datetime import datetime\\r\",\"from functools import partial\\r\",\"import re\\r\",\"import logging as logger\\r\",\"\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset1, dataset2):\\r\",\"        incidentId = self.params['IncidentId']\\r\",\"        print('Running for incident '+ incidentId)\\r\",\"        if incidentId !='':\\r\",\"            dataset1 = dataset1.filter(dataset1['number'] == incidentId)\\r\",\"        logger.info(dataset1.show())\\r\",\"        label_list = dataset2.rdd.map(lambda x:{'sop':x.sop,'workflow':x.workflow,'regex':x.regular_exp}).collect()\\r\",\"        \\r\",\"        def getsop(label,text):\\r\",\"            for item in label:\\r\",\"                ismatch = re.match(item['regex'],text.lower())\\r\",\"                if ismatch != None:\\r\",\"                    return item['sop']\\r\",\"            return\\r\",\"        \\r\",\"        def getWorkflow(label , text):\\r\",\"            for item in label:\\r\",\"                ismatch = re.match(item['regex'],text.lower())\\r\",\"                if ismatch != None:\\r\",\"                    return item['workflow']\\r\",\"            return\\r\",\"        \\r\",\"            \\r\",\"        def udf_sop(label_list):\\r\",\"            return udf(lambda l: getsop(label_list, l))\\r\",\"        def udf_workflow(label_list):\\r\",\"            return udf(lambda l: getWorkflow(label_list, l))\\r\",\"            \\r\",\"        \\r\",\"        data = dataset1.withColumn('sop', udf_sop(label_list)(col('shortdescription')))\\r\",\"        data = data.filter(col('sop') != 'undefined')\\r\",\"        data = data.withColumn('sop_confidence', lit('100'))\\r\",\"        data = data.withColumn('workflow', udf_workflow(label_list)(col('shortdescription')))\\r\",\"        data = data.withColumn('last_updated', lit(datetime.now()))\\r\",\"        \\r\",\"        data = data.select('number','sop','sop_confidence','workflow','last_updated')\\r\",\"        \\r\",\"        logger.info(data.show())\\r\",\"        return data\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},\"position_x\":\"310\",\"position_y\":\"140\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"dataset1\",\"position\":\"LeftMiddle\",\"elementId\":\"ELzwB\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"xtOmg\",\"elementPosition\":\"LeftMiddle\"},{\"type\":\"target\",\"endpoint\":\"dataset2\",\"position\":\"TopCenter\",\"elementId\":\"BVemr\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"dataset1\",\"dataset2\",\"dataset3\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"params\":\"textarea\",\"script\":\"textarea\"},\"context\":[{\"dataset\":{\"id\":39049,\"name\":\"Tickets\",\"alias\":\"Tickets\",\"description\":\"Tickets to classify SOP\",\"schema\":{\"id\":10109,\"name\":\"IcmticketsClassifySchema\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"Number\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"shortdescription\\\",\\\"recordcolumndisplayname\\\":\\\"shortdescription\\\"}]\",\"organization\":\"leo1311\"},\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select number, shortdescription from @projectname_tickets where  shortdescription is not null and shortdescription <> ''\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MSSQL\",\"expStatus\":0,\"groups\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-28 07:50:46\",\"alias\":\"leo1311\",\"id\":2,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encDFA7GGtjoS9sUXcj8Fa63LyB3Z3LRMzb\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"0d0ac5a054e1e39cbabb4e48898d0bc5b5e24f8c25e3ef2fcc9bf20574f7b774\",\"activetime\":\"2021-06-28 08:22:03\",\"category\":\"SQL\"}},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":false},{\"dataset\":{\"alias\":\"sop_config\",\"name\":\"\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-28 07:50:46\",\"alias\":\"leo1311\",\"id\":2,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encDFA7GGtjoS9sUXcj8Fa63LyB3Z3LRMzb\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"0d0ac5a054e1e39cbabb4e48898d0bc5b5e24f8c25e3ef2fcc9bf20574f7b774\",\"activetime\":\"2021-06-28 08:22:03\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select * from @projectname_sop_config\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"BVemr\",\"alias\":\"sop_config\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"alias\":\"sop_config\",\"name\":\"\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-28 07:50:46\",\"alias\":\"leo1311\",\"id\":2,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encDFA7GGtjoS9sUXcj8Fa63LyB3Z3LRMzb\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"0d0ac5a054e1e39cbabb4e48898d0bc5b5e24f8c25e3ef2fcc9bf20574f7b774\",\"activetime\":\"2021-06-28 08:22:03\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select * from @projectname_sop_config\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},\"position_x\":\"100\",\"position_y\":\"20\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"RuWix\",\"elementPosition\":\"TopCenter\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"xtOmg\",\"alias\":\"Python  Script  Transformer\",\"name\":\"Python  Script  Transformer\",\"classname\":\"PythonScriptTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"script\":[\"import logging\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        print('python transformer')\\r\",\"        dataset.show()    \\r\",\"        return dataset\\r\"]},\"position_x\":\"520\",\"position_y\":\"140\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"RuWix\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"mKdkm\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"script\":\"textarea\"},\"context\":[{\"params\":\"{\\\"IncidentId\\\":\\\"\\\"}\",\"script\":[\"from pyspark.sql.functions import *\\r\",\"import pyspark.sql.functions as F\\r\",\"from pyspark.sql.types import *\\r\",\"from datetime import datetime\\r\",\"from functools import partial\\r\",\"import re\\r\",\"import logging as logger\\r\",\"\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset1, dataset2):\\r\",\"        incidentId = self.params['IncidentId']\\r\",\"        print('Running for incident '+ incidentId)\\r\",\"        if incidentId !='':\\r\",\"            dataset1 = dataset1.filter(dataset1['number'] == incidentId)\\r\",\"        logger.info(dataset1.show())\\r\",\"        label_list = dataset2.rdd.map(lambda x:{'sop':x.sop,'workflow':x.workflow,'regex':x.regular_exp}).collect()\\r\",\"        \\r\",\"        def getsop(label,text):\\r\",\"            for item in label:\\r\",\"                ismatch = re.match(item['regex'],text.lower())\\r\",\"                if ismatch != None:\\r\",\"                    return item['sop']\\r\",\"            return\\r\",\"        \\r\",\"        def getWorkflow(label , text):\\r\",\"            for item in label:\\r\",\"                ismatch = re.match(item['regex'],text.lower())\\r\",\"                if ismatch != None:\\r\",\"                    return item['workflow']\\r\",\"            return\\r\",\"        \\r\",\"            \\r\",\"        def udf_sop(label_list):\\r\",\"            return udf(lambda l: getsop(label_list, l))\\r\",\"        def udf_workflow(label_list):\\r\",\"            return udf(lambda l: getWorkflow(label_list, l))\\r\",\"            \\r\",\"        \\r\",\"        data = dataset1.withColumn('sop', udf_sop(label_list)(col('shortdescription')))\\r\",\"        data = data.filter(col('sop') != 'undefined')\\r\",\"        data = data.withColumn('sop_confidence', lit('100'))\\r\",\"        data = data.withColumn('workflow', udf_workflow(label_list)(col('shortdescription')))\\r\",\"        data = data.withColumn('last_updated', lit(datetime.now()))\\r\",\"        \\r\",\"        data = data.select('number','sop','sop_confidence','workflow','last_updated')\\r\",\"        \\r\",\"        logger.info(data.show())\\r\",\"        return data\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},{\"dataset\":{\"id\":39049,\"name\":\"Tickets\",\"alias\":\"Tickets\",\"description\":\"Tickets to classify SOP\",\"schema\":{\"id\":10109,\"name\":\"IcmticketsClassifySchema\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"Number\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"shortdescription\\\",\\\"recordcolumndisplayname\\\":\\\"shortdescription\\\"}]\",\"organization\":\"leo1311\"},\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select number, shortdescription from @projectname_tickets where  shortdescription is not null and shortdescription <> ''\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MSSQL\",\"expStatus\":0,\"groups\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-28 07:50:46\",\"alias\":\"leo1311\",\"id\":2,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encDFA7GGtjoS9sUXcj8Fa63LyB3Z3LRMzb\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"0d0ac5a054e1e39cbabb4e48898d0bc5b5e24f8c25e3ef2fcc9bf20574f7b774\",\"activetime\":\"2021-06-28 08:22:03\",\"category\":\"SQL\"}},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":false},{\"dataset\":{\"alias\":\"sop_config\",\"name\":\"\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-28 07:50:46\",\"alias\":\"leo1311\",\"id\":2,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encDFA7GGtjoS9sUXcj8Fa63LyB3Z3LRMzb\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"0d0ac5a054e1e39cbabb4e48898d0bc5b5e24f8c25e3ef2fcc9bf20574f7b774\",\"activetime\":\"2021-06-28 08:22:03\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select * from @projectname_sop_config\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]}]}","admin","SOPClassification","2021-06-10 11:08:44","SOPClassification","leo1311","DragAndDrop","NULL"
"admin","2021-04-05 11:45:49.545000","false","Time series Forecast using ARIMA","NULL","{\"elements\":[{\"id\":\"jKxVp\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"name\":\"PEBSKPUBT3\",\"alias\":\"Volume\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-16 06:26:45\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2021-11-16 06:26:44\",\"category\":\"SQL\"},\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-16 06:45:06\",\"alias\":\"Forecast\",\"id\":18,\"name\":\"Forecast\",\"description\":null,\"schemavalue\":\"[{\\\"columntype\\\":\\\"int\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"count\\\",\\\"recordcolumndisplayname\\\":\\\"count\\\",\\\"isunique\\\":false,\\\"isrequired\\\":false},{\\\"columntype\\\":\\\"datetime\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"label\\\",\\\"recordcolumndisplayname\\\":\\\"label\\\",\\\"isunique\\\":false,\\\"isrequired\\\":false}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT COUNT(*) AS count, DATE_FORMAT(createdDate, '%d/%b/%y') AS label FROM @projectname_tickets  Group BY DATE(createdDate) ORDER BY createdDate ASC\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"datasetType\":\"MSSQL\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},\"position_x\":\"170\",\"position_y\":\"120\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"oervs\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"TqdbH\",\"alias\":\"Dataset  Loader\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"name\":\"output\",\"alias\":\"output\",\"description\":\"\",\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"Select * from @projectname_forecast\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"@projectname_forecast\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"datasetType\":\"MSSQL\",\"groups\":\"\",\"backingDataset\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-16 06:26:45\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2021-11-16 06:26:44\",\"category\":\"SQL\"}},\"applySchema\":false},\"position_x\":\"960\",\"position_y\":\"120\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"BhNMp\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"applySchema\":\"checkbox\"},\"context\":[{\"params\":\"{\\\"CorrelationId\\\":\\\"\\\"}\",\"script\":[\"from pyspark.sql.types import *\",\"from pyspark.sql.functions import *\",\"import datetime\",\"class CustomPythonClass():\",\"    def __main__(self,model,results):\",\"        data = results['out']\",\"        data.show()\",\"        correlationId = self.params['CorrelationId']\",\"        data = data.withColumn('correlationId', lit(correlationId))\",\"        \",\"        data = data.withColumn('run_timestamp',lit(datetime.datetime.now()))\",\"        \",\"        data = data.select(col('order').alias('label'), col('volume').alias('count'), 'run_timestamp','correlationId' )\",\"        return data\",\"        \",\"        \"]},{\"inputCol\":\"count\",\"seasonality\":\"7\",\"predictionCount\":\"7\"},{\"dataset\":{\"name\":\"PEBSKPUBT3\",\"alias\":\"Volume\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-16 06:26:45\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2021-11-16 06:26:44\",\"category\":\"SQL\"},\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-16 06:45:06\",\"alias\":\"Forecast\",\"id\":18,\"name\":\"Forecast\",\"description\":null,\"schemavalue\":\"[{\\\"columntype\\\":\\\"int\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"count\\\",\\\"recordcolumndisplayname\\\":\\\"count\\\",\\\"isunique\\\":false,\\\"isrequired\\\":false},{\\\"columntype\\\":\\\"datetime\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"label\\\",\\\"recordcolumndisplayname\\\":\\\"label\\\",\\\"isunique\\\":false,\\\"isrequired\\\":false}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT COUNT(*) AS count, DATE_FORMAT(createdDate, '%d/%b/%y') AS label FROM @projectname_tickets  Group BY DATE(createdDate) ORDER BY createdDate ASC\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"datasetType\":\"MSSQL\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"BhNMp\",\"alias\":\"Post  Processing  Script\",\"name\":\"Post  Processing  Script\",\"classname\":\"PostProcessingScriptConfig\",\"category\":\"BaseConfig\",\"attributes\":{\"params\":\"{\\\"CorrelationId\\\":\\\"\\\"}\",\"script\":[\"from pyspark.sql.types import *\",\"from pyspark.sql.functions import *\",\"import datetime\",\"class CustomPythonClass():\",\"    def __main__(self,model,results):\",\"        data = results['out']\",\"        data.show()\",\"        correlationId = self.params['CorrelationId']\",\"        data = data.withColumn('correlationId', lit(correlationId))\",\"        \",\"        data = data.withColumn('run_timestamp',lit(datetime.datetime.now()))\",\"        \",\"        data = data.select(col('order').alias('label'), col('volume').alias('count'), 'run_timestamp','correlationId' )\",\"        return data\",\"        \",\"        \"]},\"position_x\":\"720\",\"position_y\":\"120\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"TqdbH\",\"elementPosition\":\"LeftMiddle\"},{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"oervs\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\",\"out2\"],\"requiredJars\":[],\"formats\":{\"params\":\"textarea\",\"script\":\"textarea\"},\"context\":[{\"inputCol\":\"count\",\"seasonality\":\"7\",\"predictionCount\":\"7\"},{\"dataset\":{\"name\":\"PEBSKPUBT3\",\"alias\":\"Volume\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-16 06:26:45\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2021-11-16 06:26:44\",\"category\":\"SQL\"},\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-16 06:45:06\",\"alias\":\"Forecast\",\"id\":18,\"name\":\"Forecast\",\"description\":null,\"schemavalue\":\"[{\\\"columntype\\\":\\\"int\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"count\\\",\\\"recordcolumndisplayname\\\":\\\"count\\\",\\\"isunique\\\":false,\\\"isrequired\\\":false},{\\\"columntype\\\":\\\"datetime\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"label\\\",\\\"recordcolumndisplayname\\\":\\\"label\\\",\\\"isunique\\\":false,\\\"isrequired\\\":false}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT COUNT(*) AS count, DATE_FORMAT(createdDate, '%d/%b/%y') AS label FROM @projectname_tickets  Group BY DATE(createdDate) ORDER BY createdDate ASC\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"datasetType\":\"MSSQL\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"oervs\",\"alias\":\"A R I M A\",\"name\":\"A R I M A\",\"classname\":\"ARIMAModelConfig\",\"category\":\"DomainSolutionConfig\",\"attributes\":{\"inputCol\":\"count\",\"seasonality\":\"7\",\"predictionCount\":\"7\"},\"position_x\":\"410\",\"position_y\":\"120\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"jKxVp\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"BhNMp\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"inputCols\":\"text\",\"seasonality\":\"\",\"predictionCount\":\"text\"},\"context\":[{\"dataset\":{\"name\":\"PEBSKPUBT3\",\"alias\":\"Volume\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-16 06:26:45\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"1d23c5e213afabd559dc3e8e29f4742bbbc5da9f358a9da27b031c0bf6af6852\",\"activetime\":\"2021-11-16 06:26:44\",\"category\":\"SQL\"},\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-16 06:45:06\",\"alias\":\"Forecast\",\"id\":18,\"name\":\"Forecast\",\"description\":null,\"schemavalue\":\"[{\\\"columntype\\\":\\\"int\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"count\\\",\\\"recordcolumndisplayname\\\":\\\"count\\\",\\\"isunique\\\":false,\\\"isrequired\\\":false},{\\\"columntype\\\":\\\"datetime\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"label\\\",\\\"recordcolumndisplayname\\\":\\\"label\\\",\\\"isunique\\\":false,\\\"isrequired\\\":false}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT COUNT(*) AS count, DATE_FORMAT(createdDate, '%d/%b/%y') AS label FROM @projectname_tickets  Group BY DATE(createdDate) ORDER BY createdDate ASC\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"datasetType\":\"MSSQL\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]}]}","admin","Forecast","2021-06-09 09:22:00","Forecast","leo1311","DragAndDrop","NULL"
"admin","2021-05-03T09:55:57.030","false","Takes incident workflow name and executes corresponding resolution Script","NULL","{\"elements\":[{\"id\":\"nTTta\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"id\":10091,\"name\":\"Tickets\",\"description\":\"Not Closed/Resolved Tickets with Classified SOP \",\"schema\":\"iamp\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT te.number, te.sop, te.workflow as workflow_name,  sysId FROM @projectname_tickets_enriched te JOIN @projectname_tickets tkt ON te.number = tkt.number  where  tkt.state NOT IN ('CLOSED', 'RESOLVED') \",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-28 07:50:46\",\"alias\":\"leo1311\",\"id\":2,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encDFA7GGtjoS9sUXcj8Fa63LyB3Z3LRMzb\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"0d0ac5a054e1e39cbabb4e48898d0bc5b5e24f8c25e3ef2fcc9bf20574f7b774\",\"activetime\":\"2021-06-28 08:22:03\",\"category\":\"SQL\"},\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MSSQL\",\"expStatus\":0,\"schemajson\":null,\"groups\":\"\",\"alias\":\"Tickets\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":true},\"position_x\":\"70\",\"position_y\":\"100\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"xnlns\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"GHYpO\",\"alias\":\"Execute workflow\",\"name\":\"Python  Script  Transformer\",\"classname\":\"PythonScriptTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"script\":[\"from pyspark.sql.functions import *\",\"from pyspark.sql.types import *\",\"from pyspark.sql import SparkSession\",\"from leap.utils.Utilities import Utilities\",\"import requests\",\"import json\",\"import os\",\"from datetime import datetime\",\"class CustomPythonClass():\",\"    def __main__(self, data):\",\"        def resolve(ticket,workflow, sysid):\",\"            if workflow == 'FacebookInsights':\",\"                try:\",\"                    ####----Congigure rundeck api  URL/params/headers corresponding to workflow and return response from api\",\"                    url= 'http://myzul02u:4440/api/28/job/1a0ccbeb-887d-4c6c-9a7e-7bc3193bf545/executions?authtoken=MQqGyiIIRyUynjavzHWVgovg96qi3C3K' \",\"                    data={'argString': '-IncidentSystemID '+sysid }\",\"                    #Headers required by rundeck Api\",\"                    headers={'Accept':'application/json'}\",\"                    response=requests.post(url,data=data,headers=headers,verify=False)\",\"                    #return response.text.encode('utf8')\",\"                    return 'Workflow Executed for IncidentId:' + ticket + ' ' +str(response.text.encode('utf8'))\",\"                except:\",\"                    return 'workflow execution error'+ ticket\",\"            elif workflow == 'CancelShipment':\",\"                try:\",\"                    url= 'http://victadpst-10:6032/api/workflow/saveworkflowinputdata'\",\"                    InputJson = [{'IncidentId': ticket}]\",\"                    data={\",\"                            'ScheduleID': 1,\",\"                             'WorkFlowID': '2',\",\"                             'WorkFlowName': 'Shipment Cancel',\",\"                             'ServerName': 'victadpst-10',\",\"                              'AgentList': [5],\",\"                              'InputJson': json.dumps(InputJson)\",\"                     }\",\"    \",\"                    #Headers required by rundeck Api\",\"                    headers={'Content-Type':'application/json' }\",\"                    response=requests.post(url,auth=('admin','ZTLiPW70rwTT/6VoFmw0zg=='), data=json.dumps(data),headers=headers)\",\"                    return 'Workflow Executed for IncidentId:' + ticket + ' ' +str(response.text.encode('utf8'))\",\"                except:\",\"                    return 'Workflow execution error'\",\"            elif workflow == 'ProcessInvoice':\",\"                try:\",\"                    url= 'https://infosysq3dev1.service-now.com/api/now/table/incident/'+sysid \",\"                    proxyDict = {\",\"                      'http'  : os.environ['HTTP_PROXY'],\",\"                      'https' : os.environ['HTTPS_PROXY']            }\",\"                    data=json.dumps({'state':'7','close_code':'Closed by LEAP','caller_id':'6816f79cc0a8016401c5a33be04be441'})\",\"                    #Headers required by rundeck Api\",\"                    headers={'Content-Type':'application/json'}\",\"                    pwd=Utilities.decrypt('enc36lBo7boFl9A7QUQ86Tq/YWPxM4/+6Oj', 'ay0lj4Po/1FsrtKnrODl+Pk3yfkG7gLDzeCOtJRwpXRnIbnLtrHoDE7ktm3mmgq3MjGSJZ+ojMxtynt4BqHJwg==') \",\"                    response=requests.patch(url,auth=('ICSP_icap_user', pwd),proxies=proxyDict,data=data,headers=headers,verify=False)\",\"                    #return response.text.encode('utf8')\",\"                    return 'Workflow Executed for IncidentId:' + ticket + ' ' +str(response.text.encode('utf8'))\",\"                except:\",\"                    return 'Workflow execution error'\",\"            else:\",\"                return 'No API configured for workflow'\",\"                \",\"        udfresolve = udf(resolve, StringType())\",\"        \",\"        data = data.withColumn('apiResponse', udfresolve('number','workflow_name','sysId'))\",\"        data = data.withColumn('run_timestamp', lit(datetime.now()))\",\"        data.show()\",\"        return data\"]},\"position_x\":\"470\",\"position_y\":\"100\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"giJdf\",\"elementPosition\":\"LeftMiddle\"},{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"xnlns\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"script\":\"textarea\"},\"context\":[{\"params\":\"{'WorkflowName':'','IncidentId': ''}\",\"script\":[\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        incidentId = self.params['IncidentId']\\r\",\"        workflow = self.params['WorkflowName']\\r\",\"        print('Running for incident '+ incidentId)\\r\",\"        print('workflow' + workflow)\\r\",\"        if incidentId !='':\\r\",\"            dataset = dataset.filter(dataset['number'] == incidentId)\\r\",\"            dataset = dataset.withColumn('workflow_name',lit(self.params['WorkflowName']))\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},{\"dataset\":{\"id\":10091,\"name\":\"Tickets\",\"description\":\"Not Closed/Resolved Tickets with Classified SOP \",\"schema\":\"iamp\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT te.number, te.sop, te.workflow as workflow_name,  sysId FROM @projectname_tickets_enriched te JOIN @projectname_tickets tkt ON te.number = tkt.number  where  tkt.state NOT IN ('CLOSED', 'RESOLVED') \",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-28 07:50:46\",\"alias\":\"leo1311\",\"id\":2,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encDFA7GGtjoS9sUXcj8Fa63LyB3Z3LRMzb\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"0d0ac5a054e1e39cbabb4e48898d0bc5b5e24f8c25e3ef2fcc9bf20574f7b774\",\"activetime\":\"2021-06-28 08:22:03\",\"category\":\"SQL\"},\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MSSQL\",\"expStatus\":0,\"schemajson\":null,\"groups\":\"\",\"alias\":\"Tickets\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":true}]},{\"id\":\"giJdf\",\"alias\":\"Dataset  Loader\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"id\":10106,\"name\":\"ResolverLogs\",\"description\":\"Resolver Logs for tickets resolved through generic resolver\",\"schema\":\"iamp\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT * from @projectname_resolver_logs\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"@projectname_resolver_logs\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"rw\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"expStatus\":0,\"schemajson\":null,\"alias\":\"ResolverLogs\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-28 07:50:46\",\"alias\":\"leo1311\",\"id\":2,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encDFA7GGtjoS9sUXcj8Fa63LyB3Z3LRMzb\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"0d0ac5a054e1e39cbabb4e48898d0bc5b5e24f8c25e3ef2fcc9bf20574f7b774\",\"activetime\":\"2021-06-28 08:22:03\",\"category\":\"SQL\"},\"groups\":\"\"},\"applySchema\":false},\"position_x\":\"700\",\"position_y\":\"100\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"GHYpO\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"applySchema\":\"checkbox\"},\"context\":[{\"script\":[\"from pyspark.sql.functions import *\",\"from pyspark.sql.types import *\",\"from pyspark.sql import SparkSession\",\"from leap.utils.Utilities import Utilities\",\"import requests\",\"import json\",\"import os\",\"from datetime import datetime\",\"class CustomPythonClass():\",\"    def __main__(self, data):\",\"        def resolve(ticket,workflow, sysid):\",\"            if workflow == 'FacebookInsights':\",\"                try:\",\"                    ####----Congigure rundeck api  URL/params/headers corresponding to workflow and return response from api\",\"                    url= 'http://myzul02u:4440/api/28/job/1a0ccbeb-887d-4c6c-9a7e-7bc3193bf545/executions?authtoken=MQqGyiIIRyUynjavzHWVgovg96qi3C3K' \",\"                    data={'argString': '-IncidentSystemID '+sysid }\",\"                    #Headers required by rundeck Api\",\"                    headers={'Accept':'application/json'}\",\"                    response=requests.post(url,data=data,headers=headers,verify=False)\",\"                    #return response.text.encode('utf8')\",\"                    return 'Workflow Executed for IncidentId:' + ticket + ' ' +str(response.text.encode('utf8'))\",\"                except:\",\"                    return 'workflow execution error'+ ticket\",\"            elif workflow == 'CancelShipment':\",\"                try:\",\"                    url= 'http://victadpst-10:6032/api/workflow/saveworkflowinputdata'\",\"                    InputJson = [{'IncidentId': ticket}]\",\"                    data={\",\"                            'ScheduleID': 1,\",\"                             'WorkFlowID': '2',\",\"                             'WorkFlowName': 'Shipment Cancel',\",\"                             'ServerName': 'victadpst-10',\",\"                              'AgentList': [5],\",\"                              'InputJson': json.dumps(InputJson)\",\"                     }\",\"    \",\"                    #Headers required by rundeck Api\",\"                    headers={'Content-Type':'application/json' }\",\"                    response=requests.post(url,auth=('admin','ZTLiPW70rwTT/6VoFmw0zg=='), data=json.dumps(data),headers=headers)\",\"                    return 'Workflow Executed for IncidentId:' + ticket + ' ' +str(response.text.encode('utf8'))\",\"                except:\",\"                    return 'Workflow execution error'\",\"            elif workflow == 'ProcessInvoice':\",\"                try:\",\"                    url= 'https://infosysq3dev1.service-now.com/api/now/table/incident/'+sysid \",\"                    proxyDict = {\",\"                      'http'  : os.environ['HTTP_PROXY'],\",\"                      'https' : os.environ['HTTPS_PROXY']            }\",\"                    data=json.dumps({'state':'7','close_code':'Closed by LEAP','caller_id':'6816f79cc0a8016401c5a33be04be441'})\",\"                    #Headers required by rundeck Api\",\"                    headers={'Content-Type':'application/json'}\",\"                    pwd=Utilities.decrypt('enc36lBo7boFl9A7QUQ86Tq/YWPxM4/+6Oj', 'ay0lj4Po/1FsrtKnrODl+Pk3yfkG7gLDzeCOtJRwpXRnIbnLtrHoDE7ktm3mmgq3MjGSJZ+ojMxtynt4BqHJwg==') \",\"                    response=requests.patch(url,auth=('ICSP_icap_user', pwd),proxies=proxyDict,data=data,headers=headers,verify=False)\",\"                    #return response.text.encode('utf8')\",\"                    return 'Workflow Executed for IncidentId:' + ticket + ' ' +str(response.text.encode('utf8'))\",\"                except:\",\"                    return 'Workflow execution error'\",\"            else:\",\"                return 'No API configured for workflow'\",\"                \",\"        udfresolve = udf(resolve, StringType())\",\"        \",\"        data = data.withColumn('apiResponse', udfresolve('number','workflow_name','sysId'))\",\"        data = data.withColumn('run_timestamp', lit(datetime.now()))\",\"        data.show()\",\"        return data\"]},{\"params\":\"{'WorkflowName':'','IncidentId': ''}\",\"script\":[\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        incidentId = self.params['IncidentId']\\r\",\"        workflow = self.params['WorkflowName']\\r\",\"        print('Running for incident '+ incidentId)\\r\",\"        print('workflow' + workflow)\\r\",\"        if incidentId !='':\\r\",\"            dataset = dataset.filter(dataset['number'] == incidentId)\\r\",\"            dataset = dataset.withColumn('workflow_name',lit(self.params['WorkflowName']))\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},{\"dataset\":{\"id\":10091,\"name\":\"Tickets\",\"description\":\"Not Closed/Resolved Tickets with Classified SOP \",\"schema\":\"iamp\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT te.number, te.sop, te.workflow as workflow_name,  sysId FROM @projectname_tickets_enriched te JOIN @projectname_tickets tkt ON te.number = tkt.number  where  tkt.state NOT IN ('CLOSED', 'RESOLVED') \",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-28 07:50:46\",\"alias\":\"leo1311\",\"id\":2,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encDFA7GGtjoS9sUXcj8Fa63LyB3Z3LRMzb\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"0d0ac5a054e1e39cbabb4e48898d0bc5b5e24f8c25e3ef2fcc9bf20574f7b774\",\"activetime\":\"2021-06-28 08:22:03\",\"category\":\"SQL\"},\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MSSQL\",\"expStatus\":0,\"schemajson\":null,\"groups\":\"\",\"alias\":\"Tickets\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":true}]},{\"id\":\"xnlns\",\"alias\":\"Pre  Processing  Script\",\"name\":\"Pre  Processing  Script\",\"classname\":\"PreProcessingScriptConfig\",\"category\":\"BaseConfig\",\"attributes\":{\"params\":\"{'WorkflowName':'','IncidentId': ''}\",\"script\":[\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        incidentId = self.params['IncidentId']\\r\",\"        workflow = self.params['WorkflowName']\\r\",\"        print('Running for incident '+ incidentId)\\r\",\"        print('workflow' + workflow)\\r\",\"        if incidentId !='':\\r\",\"            dataset = dataset.filter(dataset['number'] == incidentId)\\r\",\"            dataset = dataset.withColumn('workflow_name',lit(self.params['WorkflowName']))\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},\"position_x\":\"280\",\"position_y\":\"100\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"dataset1\",\"position\":\"LeftMiddle\",\"elementId\":\"nTTta\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"GHYpO\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"dataset1\",\"dataset2\",\"dataset3\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"params\":\"textarea\",\"script\":\"textarea\"},\"context\":[{\"dataset\":{\"id\":10091,\"name\":\"Tickets\",\"description\":\"Not Closed/Resolved Tickets with Classified SOP \",\"schema\":\"iamp\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT te.number, te.sop, te.workflow as workflow_name,  sysId FROM @projectname_tickets_enriched te JOIN @projectname_tickets tkt ON te.number = tkt.number  where  tkt.state NOT IN ('CLOSED', 'RESOLVED') \",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-06-28 07:50:46\",\"alias\":\"leo1311\",\"id\":2,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"encDFA7GGtjoS9sUXcj8Fa63LyB3Z3LRMzb\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"leapuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"0d0ac5a054e1e39cbabb4e48898d0bc5b5e24f8c25e3ef2fcc9bf20574f7b774\",\"activetime\":\"2021-06-28 08:22:03\",\"category\":\"SQL\"},\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MSSQL\",\"expStatus\":0,\"schemajson\":null,\"groups\":\"\",\"alias\":\"Tickets\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":true}]}]}","NULL","GenericWorkflowResolver","NULL","GenericWorkflowResolver","leo1311","DragAndDrop","NULL"
"admin","2021-05-25 14:58:17.709000","false","Pick final cluster based on prioritization","NULL","{\"elements\":[{\"id\":\"WZFCq\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Clusters\",\"name\":\"LPD29OS8SS\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT cast(t.number as char) AS number, tags AS tags, ng.ngram, sound.soundex_cluster FROM @projectname_tickets t LEFT\\nJOIN @projectname_ngram ng ON t.number=cast(ng.number as char) LEFT JOIN @projectname_soundex sound ON t.number=cast(sound.number as char)\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},\"position_x\":\"170\",\"position_y\":\"160\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"nUpLq\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"mNtFe\",\"alias\":\"Python  Script  Transformer\",\"name\":\"Python  Script  Transformer\",\"classname\":\"PythonScriptTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"script\":[\"import logging\",\"from datetime import datetime\",\"from pyspark.sql.functions import *\",\"from pyspark.sql.types import *\",\"class CustomPythonClass():\",\"    def __main__(self, dataset):\",\"        def getCluster(tags,ngram,soundex_cluster, lda_cluster,mapped_phrase  ):\",\"            cluster = ''\",\"            if tags is not None and tags != '':\",\"                cluster = tags\",\"            elif ngram is not None and ngram != '':\",\"                cluster = ngram\",\"            elif soundex_cluster is not None and soundex_cluster != '':\",\"                cluster = soundex_cluster\",\"            elif mapped_phrase is not None and mapped_phrase != '':\",\"                cluster = mapped_phrase\",\"            elif lda_cluster is not None and lda_cluster != '':\",\"                cluster = lda_cluster\",\"            return cluster\",\"        udfGetCluster = udf(getCluster, StringType())\",\"        dataset.show()\",\"        dataset = dataset.withColumn('post_ranking_cluster', udfGetCluster('tags','ngram','soundex_cluster','lda_cluster','mapped_phrase'))\",\"        dataset = dataset.withColumn('last_updated', lit(datetime.now()))\",\"        dataset.show()\",\"        dataset = dataset.select('number','ngram','soundex_cluster','lda_cluster','mapped_phrase','last_updated','post_ranking_cluster')\",\"        return dataset\"]},\"position_x\":\"650\",\"position_y\":\"160\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"rOEhB\",\"elementPosition\":\"LeftMiddle\"},{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"nUpLq\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"script\":\"textarea\"},\"context\":[{\"params\":\"\",\"script\":[\"import logging as logger\",\"from pyspark.sql.functions import *\",\"from pyspark.sql.types import *\",\"class CustomPythonClass():\",\"    def __main__(self, dataset1, dataset2, dataset3):\",\"        dataset = dataset1.join(dataset2 , ['number'], how='left')\",\"        dataset = dataset.join(dataset3, ['number'], how='left')\",\"        \",\"        return dataset\"]},{\"dataset\":{\"alias\":\"Clusters\",\"name\":\"LPD29OS8SS\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT cast(t.number as char) AS number, tags AS tags, ng.ngram, sound.soundex_cluster FROM @projectname_tickets t LEFT\\nJOIN @projectname_ngram ng ON t.number=cast(ng.number as char) LEFT JOIN @projectname_soundex sound ON t.number=cast(sound.number as char)\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"LDA Clusters\",\"name\":\"263RBVB8BD\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT t.number, ldatopics.alias AS lda_cluster FROM @projectname_tickets_enriched t LEFT JOIN @projectname_lda lda on t.number=cast(lda.number as char) LEFT JOIN @projectname_clustering_topics ldatopics ON lda.lda_cluster = ldatopics.words\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"Phrase Extraction\",\"name\":\"DYV83OFE7R\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT cast(t.number as char) as number, case when cast(cast(pe.mapped_phrase_confidennce as char) as float) > 0.4 THEN  pe.extracted_phrase ELSE '' END as  mapped_phrase FROM @projectname_tickets_enriched t left join @projectname_phrase_extraction pe on t.number = cast(pe.number as char)\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"rOEhB\",\"alias\":\"Dataset  Loader\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Prioritized Cluster\",\"name\":\"VWT0JK2U1N\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"Select number , ngram, soundex_cluster, lda_cluster, mapped_phrase, last_updated, post_ranking_cluster from @projectname_tickets_enriched\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"update\",\"params\":\"{}\",\"tableName\":\"@projectname_tickets_enriched\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"applySchema\":false},\"position_x\":\"900\",\"position_y\":\"160\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"mNtFe\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"applySchema\":\"checkbox\"},\"context\":[{\"script\":[\"import logging\",\"from datetime import datetime\",\"from pyspark.sql.functions import *\",\"from pyspark.sql.types import *\",\"class CustomPythonClass():\",\"    def __main__(self, dataset):\",\"        def getCluster(tags,ngram,soundex_cluster, lda_cluster,mapped_phrase  ):\",\"            cluster = ''\",\"            if tags is not None and tags != '':\",\"                cluster = tags\",\"            elif ngram is not None and ngram != '':\",\"                cluster = ngram\",\"            elif soundex_cluster is not None and soundex_cluster != '':\",\"                cluster = soundex_cluster\",\"            elif mapped_phrase is not None and mapped_phrase != '':\",\"                cluster = mapped_phrase\",\"            elif lda_cluster is not None and lda_cluster != '':\",\"                cluster = lda_cluster\",\"            return cluster\",\"        udfGetCluster = udf(getCluster, StringType())\",\"        dataset.show()\",\"        dataset = dataset.withColumn('post_ranking_cluster', udfGetCluster('tags','ngram','soundex_cluster','lda_cluster','mapped_phrase'))\",\"        dataset = dataset.withColumn('last_updated', lit(datetime.now()))\",\"        dataset.show()\",\"        dataset = dataset.select('number','ngram','soundex_cluster','lda_cluster','mapped_phrase','last_updated','post_ranking_cluster')\",\"        return dataset\"]},{\"params\":\"\",\"script\":[\"import logging as logger\",\"from pyspark.sql.functions import *\",\"from pyspark.sql.types import *\",\"class CustomPythonClass():\",\"    def __main__(self, dataset1, dataset2, dataset3):\",\"        dataset = dataset1.join(dataset2 , ['number'], how='left')\",\"        dataset = dataset.join(dataset3, ['number'], how='left')\",\"        \",\"        return dataset\"]},{\"dataset\":{\"alias\":\"Clusters\",\"name\":\"LPD29OS8SS\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT cast(t.number as char) AS number, tags AS tags, ng.ngram, sound.soundex_cluster FROM @projectname_tickets t LEFT\\nJOIN @projectname_ngram ng ON t.number=cast(ng.number as char) LEFT JOIN @projectname_soundex sound ON t.number=cast(sound.number as char)\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"LDA Clusters\",\"name\":\"263RBVB8BD\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT t.number, ldatopics.alias AS lda_cluster FROM @projectname_tickets_enriched t LEFT JOIN @projectname_lda lda on t.number=cast(lda.number as char) LEFT JOIN @projectname_clustering_topics ldatopics ON lda.lda_cluster = ldatopics.words\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"Phrase Extraction\",\"name\":\"DYV83OFE7R\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT cast(t.number as char) as number, case when cast(cast(pe.mapped_phrase_confidennce as char) as float) > 0.4 THEN  pe.extracted_phrase ELSE '' END as  mapped_phrase FROM @projectname_tickets_enriched t left join @projectname_phrase_extraction pe on t.number = cast(pe.number as char)\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"RADSx\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"alias\":\"LDA Clusters\",\"name\":\"263RBVB8BD\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT t.number, ldatopics.alias AS lda_cluster FROM @projectname_tickets_enriched t LEFT JOIN @projectname_lda lda on t.number=cast(lda.number as char) LEFT JOIN @projectname_clustering_topics ldatopics ON lda.lda_cluster = ldatopics.words\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},\"position_x\":\"170\",\"position_y\":\"30\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"nUpLq\",\"elementPosition\":\"TopCenter\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"zJRXl\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Phrase Extraction\",\"name\":\"DYV83OFE7R\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT cast(t.number as char) as number, case when cast(cast(pe.mapped_phrase_confidennce as char) as float) > 0.4 THEN  pe.extracted_phrase ELSE '' END as  mapped_phrase FROM @projectname_tickets_enriched t left join @projectname_phrase_extraction pe on t.number = cast(pe.number as char)\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},\"position_x\":\"170\",\"position_y\":\"300\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"nUpLq\",\"elementPosition\":\"BottomCenter\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"nUpLq\",\"alias\":\"Pre  Processing  Script\",\"name\":\"Pre  Processing  Script\",\"classname\":\"PreProcessingScriptConfig\",\"category\":\"BaseConfig\",\"attributes\":{\"params\":\"\",\"script\":[\"import logging as logger\",\"from pyspark.sql.functions import *\",\"from pyspark.sql.types import *\",\"class CustomPythonClass():\",\"    def __main__(self, dataset1, dataset2, dataset3):\",\"        dataset = dataset1.join(dataset2 , ['number'], how='left')\",\"        dataset = dataset.join(dataset3, ['number'], how='left')\",\"        \",\"        return dataset\"]},\"position_x\":\"410\",\"position_y\":\"160\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"dataset1\",\"position\":\"LeftMiddle\",\"elementId\":\"WZFCq\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"target\",\"endpoint\":\"dataset2\",\"position\":\"TopCenter\",\"elementId\":\"RADSx\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"target\",\"endpoint\":\"dataset3\",\"position\":\"BottomCenter\",\"elementId\":\"zJRXl\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"mNtFe\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"dataset1\",\"dataset2\",\"dataset3\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"params\":\"textarea\",\"script\":\"textarea\"},\"context\":[{\"dataset\":{\"alias\":\"Clusters\",\"name\":\"LPD29OS8SS\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT cast(t.number as char) AS number, tags AS tags, ng.ngram, sound.soundex_cluster FROM @projectname_tickets t LEFT\\nJOIN @projectname_ngram ng ON t.number=cast(ng.number as char) LEFT JOIN @projectname_soundex sound ON t.number=cast(sound.number as char)\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"LDA Clusters\",\"name\":\"263RBVB8BD\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT t.number, ldatopics.alias AS lda_cluster FROM @projectname_tickets_enriched t LEFT JOIN @projectname_lda lda on t.number=cast(lda.number as char) LEFT JOIN @projectname_clustering_topics ldatopics ON lda.lda_cluster = ldatopics.words\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"Phrase Extraction\",\"name\":\"DYV83OFE7R\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT cast(t.number as char) as number, case when cast(cast(pe.mapped_phrase_confidennce as char) as float) > 0.4 THEN  pe.extracted_phrase ELSE '' END as  mapped_phrase FROM @projectname_tickets_enriched t left join @projectname_phrase_extraction pe on t.number = cast(pe.number as char)\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]}]}","NULL","Cluster Prioritization","NULL","ACMCLSTR52976","leo1311","DragAndDrop","NULL"
"admin","2021-05-26 14:13:33.816000","false","Map tickets with high frequency bi and tri grams","NULL","{\"elements\":[{\"id\":\"uNaPq\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-07-27 10:51:41\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-07-27 10:51:41\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"Select number, CAST(clean_text as CHAR) as clean_text from @projectname_tickets_enriched where clean_text is not null and clean_text <> '' \",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"}},\"position_x\":\"180\",\"position_y\":\"110\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"uOOHr\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\"},\"context\":[]},{\"id\":\"uOOHr\",\"alias\":\"Python  Script  Transformer\",\"name\":\"Python  Script  Transformer\",\"classname\":\"PythonScriptTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"script\":[\"import logging\",\"from sklearn.feature_extraction.text import CountVectorizer, TfidfVectorizer\",\"import pandas as pd\",\"import numpy as np\",\"from datetime import datetime\",\"class CustomPythonClass():\",\"    def __main__(self, dataset):\",\"        txt1 =[]\",\"        for row in dataset:\",\"            txt1.append(row['clean_text'])\",\"        logging.info('Generating NGrams')\",\"        # Getting trigrams \",\"        vectorizer = CountVectorizer(ngram_range = (3,3))\",\"        X1 = vectorizer.fit_transform(txt1) \",\"        features = (vectorizer.get_feature_names())\",\"        # Applying TFIDF\",\"        vectorizer = TfidfVectorizer(ngram_range = (3,3))\",\"        X2 = vectorizer.fit_transform(txt1)\",\"        scores = (X2.toarray())\",\"        # Getting top ranking features\",\"        logging.info('Getting Top 50 Grams')\",\"        sums = X2.sum(axis = 0)\",\"        data1 = []\",\"        for col, term in enumerate(features):\",\"            data1.append( (term, sums[0,col] ))\",\"        ranking = pd.DataFrame(data1, columns = ['term','rank'])\",\"        words = (ranking.sort_values('rank', ascending = False))\",\"        top50df = words.nlargest(50,'rank')\",\"        top50 = words['term'].tolist()\",\"       \",\"        distinctText = list(set(txt1))\",\"        count=0\",\"        totalRecords = len(distinctText)\",\"        logging.info('Mapping Text to Gram')\",\"        logging.info('Total Unique Values: {0}'.format(totalRecords))\",\"        ngramDict = {}\",\"        for item in distinctText:\",\"            matchingGrams = [gram for gram in top50 if gram in item]\",\"            if len(matchingGrams) >0:\",\"                ngramDict[item] = matchingGrams[0]\",\"            count = count+1\",\"            if count%1000 ==0:\",\"                logging.info('{0} rows mapped'.format(count))\",\"    \",\"        logging.info('Mapping Tickets')\",\"        \",\"        for row in dataset:\",\"            row['ngram'] = ngramDict.get(row['clean_text'],'')\",\"        return dataset\"]},\"position_x\":\"510\",\"position_y\":\"100\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in1\",\"position\":\"LeftMiddle\",\"elementId\":\"uNaPq\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out1\",\"position\":\"RightMiddle\",\"elementId\":\"LLDFc\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in1\",\"in2\"],\"outputEndpoints\":[\"out1\",\"out2\"],\"requiredJars\":[],\"formats\":{\"script\":\"textarea\"},\"context\":[{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-07-27 10:51:41\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-07-27 10:51:41\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"Select number, CAST(clean_text as CHAR) as clean_text from @projectname_tickets_enriched where clean_text is not null and clean_text <> '' \",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"}}]},{\"id\":\"LLDFc\",\"alias\":\"Dataset  Loader\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"alias\":\"ngramout\",\"name\":\"OL3XLSBIY5\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-07-27 10:51:41\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-07-27 10:51:41\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"Select number, ngram from @projectname_ngram\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"overwrite\",\"params\":\"{}\",\"tableName\":\"@projectname_ngram\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"}},\"position_x\":\"820\",\"position_y\":\"100\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"uOOHr\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\"},\"context\":[{\"script\":[\"import logging\",\"from sklearn.feature_extraction.text import CountVectorizer, TfidfVectorizer\",\"import pandas as pd\",\"import numpy as np\",\"from datetime import datetime\",\"class CustomPythonClass():\",\"    def __main__(self, dataset):\",\"        txt1 =[]\",\"        for row in dataset:\",\"            txt1.append(row['clean_text'])\",\"        logging.info('Generating NGrams')\",\"        # Getting trigrams \",\"        vectorizer = CountVectorizer(ngram_range = (3,3))\",\"        X1 = vectorizer.fit_transform(txt1) \",\"        features = (vectorizer.get_feature_names())\",\"        # Applying TFIDF\",\"        vectorizer = TfidfVectorizer(ngram_range = (3,3))\",\"        X2 = vectorizer.fit_transform(txt1)\",\"        scores = (X2.toarray())\",\"        # Getting top ranking features\",\"        logging.info('Getting Top 50 Grams')\",\"        sums = X2.sum(axis = 0)\",\"        data1 = []\",\"        for col, term in enumerate(features):\",\"            data1.append( (term, sums[0,col] ))\",\"        ranking = pd.DataFrame(data1, columns = ['term','rank'])\",\"        words = (ranking.sort_values('rank', ascending = False))\",\"        top50df = words.nlargest(50,'rank')\",\"        top50 = words['term'].tolist()\",\"       \",\"        distinctText = list(set(txt1))\",\"        count=0\",\"        totalRecords = len(distinctText)\",\"        logging.info('Mapping Text to Gram')\",\"        logging.info('Total Unique Values: {0}'.format(totalRecords))\",\"        ngramDict = {}\",\"        for item in distinctText:\",\"            matchingGrams = [gram for gram in top50 if gram in item]\",\"            if len(matchingGrams) >0:\",\"                ngramDict[item] = matchingGrams[0]\",\"            count = count+1\",\"            if count%1000 ==0:\",\"                logging.info('{0} rows mapped'.format(count))\",\"    \",\"        logging.info('Mapping Tickets')\",\"        \",\"        for row in dataset:\",\"            row['ngram'] = ngramDict.get(row['clean_text'],'')\",\"        return dataset\"]},{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-07-27 10:51:41\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-07-27 10:51:41\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"Select number, CAST(clean_text as CHAR) as clean_text from @projectname_tickets_enriched where clean_text is not null and clean_text <> '' \",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"}}]}]}","NULL","NGram","NULL","ACMNGRMN92761","leo1311","DragNDropLite","NULL"
"admin","2021-06-28 17:52:30.054000","false","Spark less Phrase Extraction","NULL","{\"elements\":[{\"id\":\"FqRsj\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Tickets\",\"name\":\"Tickets\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-07-27 10:51:41\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-07-27 10:51:41\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, CAST(clean_text as CHAR) as clean_text FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text <> ''  Order by Clean_text\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"}},\"position_x\":\"180\",\"position_y\":\"50\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"XlASA\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\"},\"context\":[]},{\"id\":\"XlASA\",\"alias\":\"Extract Phrases\",\"name\":\"Python  Script  Transformer\",\"classname\":\"PythonScriptTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"script\":[\"import logging\",\"import spacy\",\"import pytextrank\",\"from datetime import datetime\",\"class CustomPythonClass():\",\"    def __main__(self, dataset):\",\"        nlp = spacy.load('en_core_web_sm')\",\"        nlp.add_pipe('textrank')\",\"        timenow = datetime.now()\",\"        totalRecords = len(dataset)\",\"        logging.info('Fetched {0} records'.format(totalRecords))\",\"        count =0\",\"        textPhraseMappings = {}\",\"        for row in dataset:\",\"            try:\",\"                text = row['clean_text']\",\"                if textPhraseMappings.get(text,'') != '':\",\"                    row['extracted_phrase'] = textPhraseMappings[text]\",\"                    break\",\"                doc = nlp(text)\",\"                phrase =''\",\"                if len(doc._.phrases)>0:\",\"                    for item in doc._.phrases:\",\"                        withoutSpace = item.text.replace(' ' ,'')\",\"                        if not withoutSpace.isdigit() and len(item.text.split(' ')) >1:\",\"                            phrase = item.text\",\"                            break\",\"                if phrase != '':\",\"                    row['extracted_phrase'] = phrase\",\"                else:\",\"                    row['extracted_phrase'] = text\",\"            except Exception as ex:\",\"                logging.info(ex)\",\"                row['extracted_phrase'] = text\",\"            row['last_updated'] = timenow\",\"            row['mapped_phrase'] = ''\",\"            row['mapped_phrase_confidennce'] = ''\",\"            count = count+1\",\"            percentage = (count/totalRecords)*100 \",\"            if percentage%10 ==0:\",\"                logging.info('{0}% Completed'.format(percentage))\",\"        \",\"        return dataset\"]},\"position_x\":\"440\",\"position_y\":\"50\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in1\",\"position\":\"LeftMiddle\",\"elementId\":\"FqRsj\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out1\",\"position\":\"RightMiddle\",\"elementId\":\"JdZtY\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in1\",\"in2\"],\"outputEndpoints\":[\"out1\",\"out2\"],\"requiredJars\":[],\"formats\":{\"script\":\"textarea\"},\"context\":[{\"dataset\":{\"alias\":\"Tickets\",\"name\":\"Tickets\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-07-27 10:51:41\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-07-27 10:51:41\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, CAST(clean_text as CHAR) as clean_text FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text <> ''  Order by Clean_text\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"}}]},{\"id\":\"JdZtY\",\"alias\":\"Dataset  Loader\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Phrases\",\"name\":\"TH2VXIBQRT\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-07-27 10:51:41\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-07-27 10:51:41\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select number, extracted_phrase, mapped_phrase, mapped_phrase_confidennce, last_updated from @projectname_phrase_extraction\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"overwrite\",\"params\":\"{}\",\"tableName\":\"@projectname_phrase_extraction\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"}},\"position_x\":\"740\",\"position_y\":\"50\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"XlASA\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\"},\"context\":[{\"script\":[\"import logging\",\"import spacy\",\"import pytextrank\",\"from datetime import datetime\",\"class CustomPythonClass():\",\"    def __main__(self, dataset):\",\"        nlp = spacy.load('en_core_web_sm')\",\"        nlp.add_pipe('textrank')\",\"        timenow = datetime.now()\",\"        totalRecords = len(dataset)\",\"        logging.info('Fetched {0} records'.format(totalRecords))\",\"        count =0\",\"        textPhraseMappings = {}\",\"        for row in dataset:\",\"            try:\",\"                text = row['clean_text']\",\"                if textPhraseMappings.get(text,'') != '':\",\"                    row['extracted_phrase'] = textPhraseMappings[text]\",\"                    break\",\"                doc = nlp(text)\",\"                phrase =''\",\"                if len(doc._.phrases)>0:\",\"                    for item in doc._.phrases:\",\"                        withoutSpace = item.text.replace(' ' ,'')\",\"                        if not withoutSpace.isdigit() and len(item.text.split(' ')) >1:\",\"                            phrase = item.text\",\"                            break\",\"                if phrase != '':\",\"                    row['extracted_phrase'] = phrase\",\"                else:\",\"                    row['extracted_phrase'] = text\",\"            except Exception as ex:\",\"                logging.info(ex)\",\"                row['extracted_phrase'] = text\",\"            row['last_updated'] = timenow\",\"            row['mapped_phrase'] = ''\",\"            row['mapped_phrase_confidennce'] = ''\",\"            count = count+1\",\"            percentage = (count/totalRecords)*100 \",\"            if percentage%10 ==0:\",\"                logging.info('{0}% Completed'.format(percentage))\",\"        \",\"        return dataset\"]},{\"dataset\":{\"alias\":\"Tickets\",\"name\":\"Tickets\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-07-27 10:51:41\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MSSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-07-27 10:51:41\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, CAST(clean_text as CHAR) as clean_text FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text <> ''  Order by Clean_text\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"}}]}]}","admin","Phrase Extraction Lite","2021-06-28 17:53:11","ACMPHRSX57460","leo1311","DragNDropLite","NULL"