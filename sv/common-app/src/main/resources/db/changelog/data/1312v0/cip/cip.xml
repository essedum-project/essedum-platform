<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xmlns:pro="http://www.liquibase.org/xml/ns/pro" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/pro http://www.liquibase.org/xml/ns/pro/liquibase-pro-4.1.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.1.xsd">
	<changeSet author="Leap" id="1312v0-cip-3663241">
		<sql dbms="h2,mssql" splitStatements="true" stripComments="true">  
            DELETE FROM mlworkflowspec WHERE id=1 AND wkname='VolumeForecast';
            UPDATE mldataset SET attributes='{"filter":"","mode":"query","Query":"select * from @projectname_EASEMapping","Cacheable":false,"isStreaming":"false","Headers":"","defaultValues":"","QueryParams":"","writeMode":"append","params":"{}","tableName":"@projectname_EASEMapping","uniqueIdentifier":""}'  WHERE NAME='ACMESMPN85731' AND ORGANIZATION='leo1311';

		</sql>	
		<sql dbms="mysql" splitStatements="true" stripComments="true">  
            DELETE FROM mlworkflowspec WHERE id=1 AND wkname='VolumeForecast';
            UPDATE mldataset SET attributes='{"filter":"","mode":"query","Query":"select * from @projectname_EASEMapping","Cacheable":false,"isStreaming":"false","Headers":"","defaultValues":"","QueryParams":"","writeMode":"append","params":"{}","tableName":"@projectname_EASEMapping","uniqueIdentifier":""}'  WHERE NAME='ACMESMPN85731' AND ORGANIZATION='leo1311';

		</sql>				
	</changeSet>
	<changeSet author="Leap" id="1312v0-cip-postgres-3663241">	
		<sql dbms="postgresql" splitStatements="true" stripComments="true">  
            DELETE FROM core.mlworkflowspec WHERE id=1 AND wkname='VolumeForecast';
            UPDATE core.mldataset SET attributes='{"filter":"","mode":"query","Query":"select * from @projectname_EASEMapping","Cacheable":false,"isStreaming":"false","Headers":"","defaultValues":"","QueryParams":"","writeMode":"append","params":"{}","tableName":"@projectname_EASEMapping","uniqueIdentifier":""}'  WHERE NAME='ACMESMPN85731' AND ORGANIZATION='leo1311';
       </sql>				
	</changeSet>
	<changeSet author="Leap (generated)" id="1312v0-cip-364">
    	<sql dbms="mssql">
			SET IDENTITY_INSERT mlworkflowspec OFF;
		</sql>
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="db/changelog/data/1312v0/cip/mlworkflowspec.csv" quotchar="&quot;" separator="," tableName="mlworkflowspec">
            <column header="wkname" name="wkname" type="STRING"/>
            <column header="wkspec" name="wkspec" type="STRING"/>
        </loadData>
        <sql dbms="mssql">
			SET IDENTITY_INSERT mlworkflowspec OFF;
		</sql>
    </changeSet>
    <changeSet author="Leap (generated)" id="1312v0-cip-365">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="db/changelog/data/1312v0/cip/mldataset.csv" quotchar="&quot;" separator="," tableName="mldataset">
            <column header="id" name="id" type="NUMERIC"/>
            <column header="name" name="name" type="STRING"/>
            <column header="alias" name="alias" type="STRING"/>
            <column header="description" name="description" type="STRING"/>
            <column header="attributes" name="attributes" type="STRING"/>
            <column header="exp_status" name="exp_status" type="NUMERIC"/>
            <column header="organization" name="organization" type="STRING"/>
            <column header="schemajson" name="schemajson" type="STRING"/>
            <column header="type" name="type" type="STRING"/>
            <column header="backing_dataset" name="backing_dataset" type="skip"/>
            <column header="dataset_schema" name="dataset_schema" type="STRING"/>
            <column header="datasource" name="datasource" type="STRING"/>
            <column header="lastmodifiedby" name="lastmodifiedby" type="STRING"/>
            <column header="lastmodifieddate" name="lastmodifieddate" type="DATE"/>
            <column header="views" name="views" type="STRING"/>
            <column name="is_inbox_required" defaultValueBoolean="false"
				type="boolean" />
			<column name="is_audit_required" defaultValueBoolean="false"
				type="boolean" />
        </loadData>
    </changeSet>
 
     <changeSet dbms="mysql,postgresql" author="Leap (generated)" id="1312v0-cip-366">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="db/changelog/data/1312v0/cip/mldatasource.csv" quotchar="&quot;" separator="," tableName="mldatasource">
            <column header="id" name="id" type="NUMERIC"/>
            <column header="connectiondetails" name="connectiondetails" type="STRING"/>
            <column header="description" name="description" type="STRING"/>
            <column header="dshashcode" name="dshashcode" type="STRING"/>
            <column header="name" name="name" type="STRING"/>
            <column header="organization" name="organization" type="STRING"/>
            <column header="salt" name="salt" type="STRING"/>
            <column header="type" name="type" type="STRING"/>
            <column header="category" name="category" type="STRING"/>
            <column header="activetime" name="activetime" type="skip"/>
            <column header="lastmodifiedby" name="lastmodifiedby" type="STRING"/>
            <column header="lastmodifieddate" name="lastmodifieddate" type="DATE"/>
            <column header="alias" name="alias" type="STRING"/>
        </loadData>
    </changeSet>
        <changeSet author="sumeet.rao (generated)" id="1312v0-cip-3664">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="db/changelog/data/1312v0/cip/mlchains.csv" quotchar="&quot;" separator="," tableName="mlchains">
            <column header="id" name="id" type="NUMERIC"/>
            <column header="description" name="description" type="STRING"/>
            <column header="job_name" name="job_name" type="STRING"/>
            <column header="json_content" name="json_content" type="STRING"/>
            <column header="organization" name="organization" type="STRING"/>
            <column header="parallelchain" name="parallelchain" type="NUMERIC"/>
        </loadData>
    </changeSet>
    <changeSet author="Leap (generated)" id="1312v0-cip-36665">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="db/changelog/data/1312v0/cip/mleventjobmapping.csv" quotchar="&quot;" separator="," tableName="mleventjobmapping">
            <column header="id" name="id" type="NUMERIC"/>
            <column header="body" name="body" type="STRING"/>
            <column header="description" name="description" type="STRING"/>
            <column header="eventname" name="eventname" type="STRING"/>
            <column header="jobdetails" name="jobdetails" type="STRING"/>
            <column header="organization" name="organization" type="STRING"/>
        </loadData>
    </changeSet>
    <changeSet dbms="mysql,h2" author="Leap (generated)" id="1312v0-cip-366316">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="db/changelog/data/1312v0/cip/mlpipeline.csv" quotchar="&quot;" separator="," tableName="mlpipeline">
            <column header="cid" name="cid" type="NUMERIC"/>
            <column header="created_by" name="created_by" type="STRING"/>
            <column header="created_date" name="created_date" type="datetime(6)"/>
            <column header="deleted" name="deleted" type="BOOLEAN"/>
            <column header="description" name="description" type="STRING"/>
            <column header="job_id" name="job_id" type="skip"/>
            <column header="json_content" name="json_content" type="STRING"/>
            <column header="lastmodifiedby" name="lastmodifiedby" type="STRING"/>
            <column header="alias" name="alias" type="STRING"/>
            <column header="lastmodifieddate" name="lastmodifieddate" type="datetime"/>
            <column header="name" name="name" type="STRING"/>
            <column header="organization" name="organization" type="STRING"/>
            <column header="type" name="type" type="STRING"/>
            <column header="version" name="version" type="skip"/>
        </loadData>
    </changeSet>
    
    <changeSet author="Leap (generated)" id="1312v0-cip-366314">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="db/changelog/data/1312v0/cip/mlgroupmodel.csv" quotchar="&quot;" separator="," tableName="mlgroupmodel">
            <column header="id" name="id" type="NUMERIC"/>
            <column header="entity" name="entity" type="STRING"/>
            <column header="entity_type" name="entity_type" type="STRING"/>
            <column header="model_group" name="model_group" type="STRING"/>
            <column header="organization" name="organization" type="STRING"/>
        </loadData>
    </changeSet>  
    <changeSet author="Leap (generated)" id="1312v0-cip-366319">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="db/changelog/data/1312v0/cip/mlschemaregistry.csv" quotchar="&quot;" separator="," tableName="mlschemaregistry">
            <column header="id" name="id" type="NUMERIC"/>
            <column header="formtemplate" name="formtemplate" type="STRING"/>
            <column header="name" name="name" type="STRING"/>
            <column header="organization" name="organization" type="STRING"/>
            <column header="schemavalue" name="schemavalue" type="STRING"/>
       	    <column header="lastmodifiedby" name="lastmodifiedby" type="STRING"/>
            <column header="lastmodifieddate" name="lastmodifieddate" type="DATE"/>
            <column header="alias" name="alias" type="STRING"/>
        </loadData>
    </changeSet>
    <changeSet author="Leap" id="1312v0-cip-366320">
		<sql dbms="h2,mssql" splitStatements="true" stripComments="true">  
			UPDATE mldataset SET schemajson='[{"templateName":"Ease Mapping Form","templateTags":[],"components":[{"label":"ID","tableView":true,"key":"id","type":"textfield","input":true},{"label":"Key_Word","tableView":true,"key":"Key_Word","type":"textfield","input":true},{"label":"Category","tableView":true,"key":"category","type":"textfield","input":true},{"label":"Ease","widget":"choicesjs","tableView":true,"data":{"values":[{"label":"Shift Left","value":"Shift Left"},{"label":"Enable User","value":"Enable User"},{"label":"Eliminate","value":"Eliminate"},{"label":"Automate","value":"Automate"},{"label":"NA","value":"NA"}]},"key":"ease","type":"select","input":true},{"label":"Support_Level","tableView":true,"data":{"values":[{"label":"L1","value":"L1"},{"label":"L2","value":"L2"},{"label":"L3","value":"L3"},{"label":"NA","value":"NA"}]},"key":"Support_Level","type":"select","input":true},{"label":"Ranks","tableView":true,"data":{"values":[{"label":"1","value":"1"},{"label":"2","value":"2"},{"label":"3","value":"3"}]},"key":"rank","type":"select","input":true},{"label":"Typical_Resolution","tableView":true,"key":"Typical_Resolution","type":"textfield","input":true},{"label":"Business_Impact","tableView":true,"key":"Business_Impact","type":"textfield","input":true},{"label":"Account","tableView":true,"key":"account","type":"textfield","input":true},{"label":"BotName","tableView":true,"key":"botName","type":"textfield","input":true},{"label":"Submit","action":"custom","showValidations":false,"tableView":false,"key":"submit","type":"button","custom":"let clickCountsubmit = Number(document.getElementById(\"formio-btnclk-submit\").innerHTML); document.getElementById(\"formio-btnclk-submit\").innerHTML=(clickCountsubmit+1);","input":true}]}]' WHERE NAME='ACMESMPN85731' AND ORGANIZATION='leo1311';
			update mlschemaregistry set formtemplate='[{"templateName":"Ease Mapping Form","templateTags":[],"components":[{"label":"ID","tableView":true,"key":"id","type":"textfield","input":true},{"label":"Key_Word","tableView":true,"key":"Key_Word","type":"textfield","input":true},{"label":"Category","tableView":true,"key":"category","type":"textfield","input":true},{"label":"Ease","widget":"choicesjs","tableView":true,"data":{"values":[{"label":"Shift Left","value":"Shift Left"},{"label":"Enable User","value":"Enable User"},{"label":"Eliminate","value":"Eliminate"},{"label":"Automate","value":"Automate"},{"label":"NA","value":"NA"}]},"key":"ease","type":"select","input":true},{"label":"Support_Level","tableView":true,"data":{"values":[{"label":"L1","value":"L1"},{"label":"L2","value":"L2"},{"label":"L3","value":"L3"},{"label":"NA","value":"NA"}]},"key":"Support_Level","type":"select","input":true},{"label":"Ranks","tableView":true,"data":{"values":[{"label":"1","value":"1"},{"label":"2","value":"2"},{"label":"3","value":"3"}]},"key":"rank","type":"select","input":true},{"label":"Typical_Resolution","tableView":true,"key":"Typical_Resolution","type":"textfield","input":true},{"label":"Business_Impact","tableView":true,"key":"Business_Impact","type":"textfield","input":true},{"label":"Account","tableView":true,"key":"account","type":"textfield","input":true},{"label":"BotName","tableView":true,"key":"botName","type":"textfield","input":true},{"label":"Submit","action":"custom","showValidations":false,"tableView":false,"key":"submit","type":"button","custom":"let clickCountsubmit = Number(document.getElementById(\"formio-btnclk-submit\").innerHTML); document.getElementById(\"formio-btnclk-submit\").innerHTML=(clickCountsubmit+1);","input":true}]}]' where name='ACMESMPN94605' and organization='leo1311';
		</sql>
			
	</changeSet>
	<changeSet author="Leap" id="1312v0-cip-366321">
		<sql dbms="mysql" splitStatements="true" stripComments="true">  
			UPDATE mldataset SET schemajson='[{\"templateName\":\"Ease Mapping Form\",\"templateTags\":[],\"components\":[{\"label\":\"ID\",\"tableView\":true,\"key\":\"id\",\"type\":\"textfield\",\"input\":true},{\"label\":\"Key_Word\",\"tableView\":true,\"key\":\"Key_Word\",\"type\":\"textfield\",\"input\":true},{\"label\":\"Category\",\"tableView\":true,\"key\":\"category\",\"type\":\"textfield\",\"input\":true},{\"label\":\"Ease\",\"widget\":\"choicesjs\",\"tableView\":true,\"data\":{\"values\":[{\"label\":\"Shift Left\",\"value\":\"Shift Left\"},{\"label\":\"Enable User\",\"value\":\"Enable User\"},{\"label\":\"Eliminate\",\"value\":\"Eliminate\"},{\"label\":\"Automate\",\"value\":\"Automate\"},{\"label\":\"NA\",\"value\":\"NA\"}]},\"key\":\"ease\",\"type\":\"select\",\"input\":true},{\"label\":\"Support_Level\",\"tableView\":true,\"data\":{\"values\":[{\"label\":\"L1\",\"value\":\"L1\"},{\"label\":\"L2\",\"value\":\"L2\"},{\"label\":\"L3\",\"value\":\"L3\"},{\"label\":\"NA\",\"value\":\"NA\"}]},\"key\":\"Support_Level\",\"type\":\"select\",\"input\":true},{\"label\":\"Ranks\",\"tableView\":true,\"data\":{\"values\":[{\"label\":\"1\",\"value\":\"1\"},{\"label\":\"2\",\"value\":\"2\"},{\"label\":\"3\",\"value\":\"3\"}]},\"key\":\"rank\",\"type\":\"select\",\"input\":true},{\"label\":\"Typical_Resolution\",\"tableView\":true,\"key\":\"Typical_Resolution\",\"type\":\"textfield\",\"input\":true},{\"label\":\"Business_Impact\",\"tableView\":true,\"key\":\"Business_Impact\",\"type\":\"textfield\",\"input\":true},{\"label\":\"Account\",\"tableView\":true,\"key\":\"account\",\"type\":\"textfield\",\"input\":true},{\"label\":\"BotName\",\"tableView\":true,\"key\":\"botName\",\"type\":\"textfield\",\"input\":true},{\"label\":\"Submit\",\"action\":\"custom\",\"showValidations\":false,\"tableView\":false,\"key\":\"submit\",\"type\":\"button\",\"custom\":\"let clickCountsubmit = Number(document.getElementById(\\\"formio-btnclk-submit\\\").innerHTML); document.getElementById(\\\"formio-btnclk-submit\\\").innerHTML=(clickCountsubmit+1);\",\"input\":true}]}]' WHERE NAME='ACMESMPN85731' AND ORGANIZATION='leo1311';
			update mlschemaregistry set formtemplate='[{\"templateName\":\"Ease Mapping Form\",\"templateTags\":[],\"components\":[{\"label\":\"ID\",\"tableView\":true,\"key\":\"id\",\"type\":\"textfield\",\"input\":true},{\"label\":\"Key_Word\",\"tableView\":true,\"key\":\"Key_Word\",\"type\":\"textfield\",\"input\":true},{\"label\":\"Category\",\"tableView\":true,\"key\":\"category\",\"type\":\"textfield\",\"input\":true},{\"label\":\"Ease\",\"widget\":\"choicesjs\",\"tableView\":true,\"data\":{\"values\":[{\"label\":\"Shift Left\",\"value\":\"Shift Left\"},{\"label\":\"Enable User\",\"value\":\"Enable User\"},{\"label\":\"Eliminate\",\"value\":\"Eliminate\"},{\"label\":\"Automate\",\"value\":\"Automate\"},{\"label\":\"NA\",\"value\":\"NA\"}]},\"key\":\"ease\",\"type\":\"select\",\"input\":true},{\"label\":\"Support_Level\",\"tableView\":true,\"data\":{\"values\":[{\"label\":\"L1\",\"value\":\"L1\"},{\"label\":\"L2\",\"value\":\"L2\"},{\"label\":\"L3\",\"value\":\"L3\"},{\"label\":\"NA\",\"value\":\"NA\"}]},\"key\":\"Support_Level\",\"type\":\"select\",\"input\":true},{\"label\":\"Ranks\",\"tableView\":true,\"data\":{\"values\":[{\"label\":\"1\",\"value\":\"1\"},{\"label\":\"2\",\"value\":\"2\"},{\"label\":\"3\",\"value\":\"3\"}]},\"key\":\"rank\",\"type\":\"select\",\"input\":true},{\"label\":\"Typical_Resolution\",\"tableView\":true,\"key\":\"Typical_Resolution\",\"type\":\"textfield\",\"input\":true},{\"label\":\"Business_Impact\",\"tableView\":true,\"key\":\"Business_Impact\",\"type\":\"textfield\",\"input\":true},{\"label\":\"Account\",\"tableView\":true,\"key\":\"account\",\"type\":\"textfield\",\"input\":true},{\"label\":\"BotName\",\"tableView\":true,\"key\":\"botName\",\"type\":\"textfield\",\"input\":true},{\"label\":\"Submit\",\"action\":\"custom\",\"showValidations\":false,\"tableView\":false,\"key\":\"submit\",\"type\":\"button\",\"custom\":\"let clickCountsubmit = Number(document.getElementById(\\\"formio-btnclk-submit\\\").innerHTML); document.getElementById(\\\"formio-btnclk-submit\\\").innerHTML=(clickCountsubmit+1);\",\"input\":true}]}]' where name='ACMESMPN94605' and organization='leo1311';
		</sql>
	</changeSet>
	
	 <changeSet author="Leap" id="1312v0-cip-postgres-366321">
		<sql dbms="postgresql" splitStatements="true" stripComments="true">  
			UPDATE core.mldataset SET schemajson='[{\"templateName\":\"Ease Mapping Form\",\"templateTags\":[],\"components\":[{\"label\":\"ID\",\"tableView\":true,\"key\":\"id\",\"type\":\"textfield\",\"input\":true},{\"label\":\"Key_Word\",\"tableView\":true,\"key\":\"Key_Word\",\"type\":\"textfield\",\"input\":true},{\"label\":\"Category\",\"tableView\":true,\"key\":\"category\",\"type\":\"textfield\",\"input\":true},{\"label\":\"Ease\",\"widget\":\"choicesjs\",\"tableView\":true,\"data\":{\"values\":[{\"label\":\"Shift Left\",\"value\":\"Shift Left\"},{\"label\":\"Enable User\",\"value\":\"Enable User\"},{\"label\":\"Eliminate\",\"value\":\"Eliminate\"},{\"label\":\"Automate\",\"value\":\"Automate\"},{\"label\":\"NA\",\"value\":\"NA\"}]},\"key\":\"ease\",\"type\":\"select\",\"input\":true},{\"label\":\"Support_Level\",\"tableView\":true,\"data\":{\"values\":[{\"label\":\"L1\",\"value\":\"L1\"},{\"label\":\"L2\",\"value\":\"L2\"},{\"label\":\"L3\",\"value\":\"L3\"},{\"label\":\"NA\",\"value\":\"NA\"}]},\"key\":\"Support_Level\",\"type\":\"select\",\"input\":true},{\"label\":\"Ranks\",\"tableView\":true,\"data\":{\"values\":[{\"label\":\"1\",\"value\":\"1\"},{\"label\":\"2\",\"value\":\"2\"},{\"label\":\"3\",\"value\":\"3\"}]},\"key\":\"rank\",\"type\":\"select\",\"input\":true},{\"label\":\"Typical_Resolution\",\"tableView\":true,\"key\":\"Typical_Resolution\",\"type\":\"textfield\",\"input\":true},{\"label\":\"Business_Impact\",\"tableView\":true,\"key\":\"Business_Impact\",\"type\":\"textfield\",\"input\":true},{\"label\":\"Account\",\"tableView\":true,\"key\":\"account\",\"type\":\"textfield\",\"input\":true},{\"label\":\"BotName\",\"tableView\":true,\"key\":\"botName\",\"type\":\"textfield\",\"input\":true},{\"label\":\"Submit\",\"action\":\"custom\",\"showValidations\":false,\"tableView\":false,\"key\":\"submit\",\"type\":\"button\",\"custom\":\"let clickCountsubmit = Number(document.getElementById(\\\"formio-btnclk-submit\\\").innerHTML); document.getElementById(\\\"formio-btnclk-submit\\\").innerHTML=(clickCountsubmit+1);\",\"input\":true}]}]' WHERE NAME='ACMESMPN85731' AND ORGANIZATION='leo1311';
			update core.mlschemaregistry set formtemplate='[{\"templateName\":\"Ease Mapping Form\",\"templateTags\":[],\"components\":[{\"label\":\"ID\",\"tableView\":true,\"key\":\"id\",\"type\":\"textfield\",\"input\":true},{\"label\":\"Key_Word\",\"tableView\":true,\"key\":\"Key_Word\",\"type\":\"textfield\",\"input\":true},{\"label\":\"Category\",\"tableView\":true,\"key\":\"category\",\"type\":\"textfield\",\"input\":true},{\"label\":\"Ease\",\"widget\":\"choicesjs\",\"tableView\":true,\"data\":{\"values\":[{\"label\":\"Shift Left\",\"value\":\"Shift Left\"},{\"label\":\"Enable User\",\"value\":\"Enable User\"},{\"label\":\"Eliminate\",\"value\":\"Eliminate\"},{\"label\":\"Automate\",\"value\":\"Automate\"},{\"label\":\"NA\",\"value\":\"NA\"}]},\"key\":\"ease\",\"type\":\"select\",\"input\":true},{\"label\":\"Support_Level\",\"tableView\":true,\"data\":{\"values\":[{\"label\":\"L1\",\"value\":\"L1\"},{\"label\":\"L2\",\"value\":\"L2\"},{\"label\":\"L3\",\"value\":\"L3\"},{\"label\":\"NA\",\"value\":\"NA\"}]},\"key\":\"Support_Level\",\"type\":\"select\",\"input\":true},{\"label\":\"Ranks\",\"tableView\":true,\"data\":{\"values\":[{\"label\":\"1\",\"value\":\"1\"},{\"label\":\"2\",\"value\":\"2\"},{\"label\":\"3\",\"value\":\"3\"}]},\"key\":\"rank\",\"type\":\"select\",\"input\":true},{\"label\":\"Typical_Resolution\",\"tableView\":true,\"key\":\"Typical_Resolution\",\"type\":\"textfield\",\"input\":true},{\"label\":\"Business_Impact\",\"tableView\":true,\"key\":\"Business_Impact\",\"type\":\"textfield\",\"input\":true},{\"label\":\"Account\",\"tableView\":true,\"key\":\"account\",\"type\":\"textfield\",\"input\":true},{\"label\":\"BotName\",\"tableView\":true,\"key\":\"botName\",\"type\":\"textfield\",\"input\":true},{\"label\":\"Submit\",\"action\":\"custom\",\"showValidations\":false,\"tableView\":false,\"key\":\"submit\",\"type\":\"button\",\"custom\":\"let clickCountsubmit = Number(document.getElementById(\\\"formio-btnclk-submit\\\").innerHTML); document.getElementById(\\\"formio-btnclk-submit\\\").innerHTML=(clickCountsubmit+1);\",\"input\":true}]}]' where name='ACMESMPN94605' and organization='leo1311';
		</sql>		
	</changeSet>
	
	<changeSet dbms="mssql" author="Leap (generated)" id="1312v0-cip-366323">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="db/changelog/data/1312v0/cip/mlpipelinenativescriptentity-mssql.csv" quotchar="&quot;" separator="," tableName="mlpipelinenativescriptentity">
            <column header="id" name="id" type="NUMERIC"/>
            <column header="cname" name="cname" type="STRING"/>
            <column header="filename" name="filename" type="STRING"/>
            <column header="filescript" name="filescript" type="BLOB"/>
            <column header="organization" name="organization" type="STRING"/>
        </loadData>
    </changeSet>
    <changeSet author="Leap" id="1312v0-cip-366324">
		<sql dbms="mssql" splitStatements="true" stripComments="true">  
			UPDATE mlpipeline SET json_content='{"elements":[{"id":"BRljv","alias":"unassigned ticktes","name":"Dataset  Extractor","classname":"DatasetExtractorConfig","category":"ExtractorConfig","attributes":{"dataset":{"alias":"unassigned ticktes","name":"","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT number, configurationItem FROM @projectname_tickets","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"groups":[],"backingDataset":""},"isValidation":"","samplingRatio":"","applySchema":false},"position_x":"110","position_y":"160","connectors":[{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"BYjfm","elementPosition":"LeftMiddle"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"dataset":"dropdown","isValidation":"checkbox","samplingRatio":"text","applySchema":"checkbox"},"context":[]},{"id":"thKAM","alias":"Dataset  Loader","name":"Dataset  Loader","classname":"DatasetLoaderConfig","category":"LoaderConfig","attributes":{"dataset":{"alias":"assigned tickets","name":"","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"select number, predicted_assignment_group, predicted_assignee from @projectname_tickets_enriched","isStreaming":"false","defaultValues":"","writeMode":"update","params":"{}","tableName":"@projectname_tickets_enriched","uniqueIdentifier":""},"expStatus":0,"groups":"","backingDataset":""},"applySchema":false},"position_x":"890","position_y":"130","connectors":[{"type":"target","endpoint":"in","position":"LeftMiddle","elementId":"WUowg","elementPosition":"RightMiddle"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"dataset":"dropdown","applySchema":"checkbox"},"context":[{"script":["import logging\r","from pyspark.sql.functions import *\r","class CustomPythonClass():\r","    def __main__(self, dataset):\r","        dataset = dataset.select(''number'',col(''assignmentgroup'').alias(''predicted_assignment_group''),col(''user'').alias(''predicted_assignee''))    \r","        return dataset\r","\r"]},{"params":"","script":["import logging\r","class CustomPythonClass():\r","    def __main__(self, dataset1,dataset2,dataset3):\r","        dataset = dataset1.join(dataset3, (''configurationItem''))\r","        dataset.show()\r","        dataset = dataset.join(dataset2, (''assignmentgroup''))\r","        dataset.show()\r","        return dataset\r"]},{"dataset":{"alias":"unassigned ticktes","name":"","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT number, configurationItem FROM @projectname_tickets","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"groups":[],"backingDataset":""},"isValidation":"","samplingRatio":"","applySchema":false},{"dataset":{"alias":"Assignment Config","name":"","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT DISTINCT configurationItem, assignmentgroup  FROM @projectname_assignment_config","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"groups":[],"backingDataset":""},"isValidation":"","samplingRatio":"","applySchema":false},{"dataset":{"alias":"shift roster","name":"D0YCX6A4OQ","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT assignmentgroup , user as ''user'', isAvailable FROM @projectname_shift_roster WHERE user != '''' AND assignmentgroup != ''''  AND assignmentgroup IS NOT NULL group by assignmentgroup,isAvailable","Cacheable":"","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":""},"expStatus":0,"isAuditRequired":false,"isPermissionManaged":false,"isApprovalRequired":false,"isInboxRequired":false,"groups":[],"backingDataset":""},"isValidation":"","samplingRatio":"","applySchema":false}]},{"id":"BYjfm","alias":"Pre  Processing  Script","name":"Pre  Processing  Script","classname":"PreProcessingScriptConfig","category":"BaseConfig","attributes":{"params":"","script":["import logging\r","class CustomPythonClass():\r","    def __main__(self, dataset1,dataset2,dataset3):\r","        dataset = dataset1.join(dataset3, (''configurationItem''))\r","        dataset.show()\r","        dataset = dataset.join(dataset2, (''assignmentgroup''))\r","        dataset.show()\r","        return dataset\r"]},"position_x":"350","position_y":"120","connectors":[{"type":"target","endpoint":"dataset1","position":"LeftMiddle","elementId":"BRljv","elementPosition":"RightMiddle"},{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"WUowg","elementPosition":"LeftMiddle"},{"type":"target","endpoint":"dataset3","position":"BottomCenter","elementId":"qOpVw","elementPosition":"RightMiddle"},{"type":"target","endpoint":"dataset2","position":"TopCenter","elementId":"GSgRJ","elementPosition":"RightMiddle"}],"inputEndpoints":["dataset1","dataset2","dataset3"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"params":"textarea","script":"textarea"},"context":[{"dataset":{"alias":"unassigned ticktes","name":"","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT number, configurationItem FROM @projectname_tickets","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"groups":[],"backingDataset":""},"isValidation":"","samplingRatio":"","applySchema":false},{"dataset":{"alias":"Assignment Config","name":"","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT DISTINCT configurationItem, assignmentgroup  FROM @projectname_assignment_config","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"groups":[],"backingDataset":""},"isValidation":"","samplingRatio":"","applySchema":false},{"dataset":{"alias":"shift roster","name":"D0YCX6A4OQ","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT assignmentgroup , user as ''user'', isAvailable FROM @projectname_shift_roster WHERE user != '''' AND assignmentgroup != ''''  AND assignmentgroup IS NOT NULL group by assignmentgroup,isAvailable","Cacheable":"","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":""},"expStatus":0,"isAuditRequired":false,"isPermissionManaged":false,"isApprovalRequired":false,"isInboxRequired":false,"groups":[],"backingDataset":""},"isValidation":"","samplingRatio":"","applySchema":false}]},{"id":"qOpVw","alias":"assignment config","name":"Dataset  Extractor","classname":"DatasetExtractorConfig","category":"ExtractorConfig","attributes":{"dataset":{"alias":"Assignment Config","name":"","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT DISTINCT configurationItem, assignmentgroup  FROM @projectname_assignment_config","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"groups":[],"backingDataset":""},"isValidation":"","samplingRatio":"","applySchema":false},"position_x":"100","position_y":"310","connectors":[{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"BYjfm","elementPosition":"BottomCenter"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"dataset":"dropdown","isValidation":"checkbox","samplingRatio":"text","applySchema":"checkbox"},"context":[]},{"id":"WUowg","alias":"Python  Script  Transformer","name":"Python  Script  Transformer","classname":"PythonScriptTransformerConfig","category":"TransformerConfig","attributes":{"script":["import logging\r","from pyspark.sql.functions import *\r","class CustomPythonClass():\r","    def __main__(self, dataset):\r","        dataset = dataset.select(''number'',col(''assignmentgroup'').alias(''predicted_assignment_group''),col(''user'').alias(''predicted_assignee''))    \r","        return dataset\r","\r"]},"position_x":"570","position_y":"130","connectors":[{"type":"target","endpoint":"in","position":"LeftMiddle","elementId":"BYjfm","elementPosition":"RightMiddle"},{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"thKAM","elementPosition":"LeftMiddle"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"script":"textarea"},"context":[{"params":"","script":["import logging\r","class CustomPythonClass():\r","    def __main__(self, dataset1,dataset2,dataset3):\r","        dataset = dataset1.join(dataset3, (''configurationItem''))\r","        dataset.show()\r","        dataset = dataset.join(dataset2, (''assignmentgroup''))\r","        dataset.show()\r","        return dataset\r"]},{"dataset":{"alias":"unassigned ticktes","name":"","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT number, configurationItem FROM @projectname_tickets","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"groups":[],"backingDataset":""},"isValidation":"","samplingRatio":"","applySchema":false},{"dataset":{"alias":"Assignment Config","name":"","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT DISTINCT configurationItem, assignmentgroup  FROM @projectname_assignment_config","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"groups":[],"backingDataset":""},"isValidation":"","samplingRatio":"","applySchema":false},{"dataset":{"alias":"shift roster","name":"D0YCX6A4OQ","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT assignmentgroup , user as ''user'', isAvailable FROM @projectname_shift_roster WHERE user != '''' AND assignmentgroup != ''''  AND assignmentgroup IS NOT NULL group by assignmentgroup,isAvailable","Cacheable":"","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":""},"expStatus":0,"isAuditRequired":false,"isPermissionManaged":false,"isApprovalRequired":false,"isInboxRequired":false,"groups":[],"backingDataset":""},"isValidation":"","samplingRatio":"","applySchema":false}]},{"id":"GSgRJ","alias":"shift roster","name":"Dataset  Extractor","classname":"DatasetExtractorConfig","category":"ExtractorConfig","attributes":{"dataset":{"alias":"shift roster","name":"D0YCX6A4OQ","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT assignmentgroup , user as ''user'', isAvailable FROM @projectname_shift_roster WHERE user != '''' AND assignmentgroup != ''''  AND assignmentgroup IS NOT NULL group by assignmentgroup,isAvailable","Cacheable":"","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":""},"expStatus":0,"isAuditRequired":false,"isPermissionManaged":false,"isApprovalRequired":false,"isInboxRequired":false,"groups":[],"backingDataset":""},"isValidation":"","samplingRatio":"","applySchema":false},"position_x":"100","position_y":"30","connectors":[{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"BYjfm","elementPosition":"TopCenter"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"dataset":"dropdown","isValidation":"checkbox","samplingRatio":"text","applySchema":"checkbox"},"context":[]}]}' WHERE name='ACMATSGN51350' AND organization='leo1311'
		</sql>			
	</changeSet>
	<changeSet author="Leap" id="1312v0-cip-366325">
		<sql dbms="mssql" splitStatements="true" stripComments="true">  
			UPDATE mlpipeline SET json_content='{"elements":[{"id":"UEeVc","alias":"Dataset  Extractor","name":"Dataset  Extractor","classname":"DatasetExtractorConfig","category":"ExtractorConfig","attributes":{"dataset":{"name":"ZPVLYWVANZ","alias":"Tickets","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-11 08:32:13","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encvBQOC5yizoW7x+rkuw/6JG8nmcwszpOHF2o=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leap1311_data\"}","salt":"VlJy2CHz9GHmCzcFEbjoeXAcOhW33TiLagZ9HVAj3/KcaGWdmdJW/12k2VruMpxw1BOQK4C9K0N3ghm394mWFQ==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-11 08:32:13","category":"SQL"},"schema":null,"type":"r","attributes":{"filter":"","mode":"query","Query":"Select number, shortdescription, configurationItem as group_by_field from @projectname_tickets where shortdescription != '''' and   shortdescription is not Null  ","Cacheable":"","isStreaming":"false","writeMode":"append","params":"{}","tableName":"","defaultValues":"","uniqueIdentifier":""},"datasetType":"MYSQL","backingDataset":"","organization":"leo1311","expStatus":0,"groups":[]},"isValidation":"","samplingRatio":"","applySchema":false},"position_x":"40","position_y":"30","connectors":[{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"ffQic","elementPosition":"LeftMiddle"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"dataset":"dropdown","isValidation":"checkbox","samplingRatio":"text","applySchema":"checkbox"},"context":[]},{"id":"HYOWn","alias":"Dataset  Loader","name":"Dataset  Loader","classname":"DatasetLoaderConfig","category":"LoaderConfig","attributes":{"dataset":{"name":"CleanText","alias":"Clean text","description":"Clean Text","schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"select number, clean_text, group_by_field, last_updated from @projectname_tickets_enriched","Cacheable":"","isStreaming":"false","writeMode":"update","params":"{}","tableName":"@projectname_tickets_enriched","defaultValues":"","uniqueIdentifier":""},"expStatus":0,"datasetType":"MYSQL","groups":"","backingDataset":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-11 08:32:13","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encvBQOC5yizoW7x+rkuw/6JG8nmcwszpOHF2o=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leap1311_data\"}","salt":"VlJy2CHz9GHmCzcFEbjoeXAcOhW33TiLagZ9HVAj3/KcaGWdmdJW/12k2VruMpxw1BOQK4C9K0N3ghm394mWFQ==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-11 08:32:13","category":"SQL"}},"applySchema":false},"position_x":"780","position_y":"200","connectors":[{"type":"target","endpoint":"in","position":"LeftMiddle","elementId":"fPAbp","elementPosition":"RightMiddle"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"dataset":"dropdown","applySchema":"checkbox"},"context":[{"script":["import logging\r","from pyspark.sql.functions import *\r","from pyspark.sql.types import *\r","from nltk.stem import WordNetLemmatizer\r","from datetime import datetime\r","\r","class CustomPythonClass():\r","    def __main__(self, dataset):\r","      \r","        def lemmatize(tokens):\r","            wordnet_lemmatizer = WordNetLemmatizer()\r","            lemmatizedTokens = []\r","            for word in tokens:\r","                lemmatizedTokens.append(wordnet_lemmatizer.lemmatize(word, pos=''v''))\r","            return '' ''.join(lemmatizedTokens)\r","        \r","        udfLemmetize = udf(lemmatize, StringType())\r","        dataset = dataset.withColumn(''clean_text'',udfLemmetize(''clean_tokens''))\r","        dataset = dataset.select(''number'',''clean_text'', ''group_by_field'')\r","        dataset = dataset.withColumn(''last_updated'',lit(datetime.now()))\r","        dataset = dataset.repartition(100)\r","        return dataset\r","\r","\r","\r","\r"],"outputCols":"lemmatizedText"},{"inputCol":"tokens","outputCol":"clean_tokens","stopWords":"id"},{"inputCol":"cleanText","outputCol":"tokens"},{"params":"","script":["import logging as logger\r","from pyspark.sql.functions import *\r","from pyspark.sql.types import *\r","import re\r","\r","\r","class CustomPythonClass():\r","    def __main__(self, dataset):\r","        \r","        def alphaNum(text):\r","            alphanumeric = ''''\r","            for character in text:\r","                if character.isalnum():\r","                    alphanumeric += character\r","                else:\r","                    alphanumeric += '' ''\r","            alphanumeric = re.sub('' +'', '' '', alphanumeric)\r","            finalTokens = [t for t in alphanumeric.split('' '') if not t.isnumeric()]\r","            return '' ''.join(finalTokens)\r","        udfAlpaNum = udf(alphaNum, StringType())\r","        dataset = dataset.withColumn(''cleanText'',udfAlpaNum(''shortdescription''))\r","        dataset = dataset.select(''number'',''shortdescription'',''group_by_field'', ''cleanText'' )\r","        \r","        return dataset\r","\r","\r","\r","\r"],"outputCols":"number,shortdescription,cleanText,group_by_field"},{"dataset":{"name":"ZPVLYWVANZ","alias":"Tickets","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-11 08:32:13","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encvBQOC5yizoW7x+rkuw/6JG8nmcwszpOHF2o=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leap1311_data\"}","salt":"VlJy2CHz9GHmCzcFEbjoeXAcOhW33TiLagZ9HVAj3/KcaGWdmdJW/12k2VruMpxw1BOQK4C9K0N3ghm394mWFQ==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-11 08:32:13","category":"SQL"},"schema":null,"type":"r","attributes":{"filter":"","mode":"query","Query":"Select number, shortdescription, configurationItem as group_by_field from @projectname_tickets where shortdescription != '''' and   shortdescription is not Null  ","Cacheable":"","isStreaming":"false","writeMode":"append","params":"{}","tableName":"","defaultValues":"","uniqueIdentifier":""},"datasetType":"MYSQL","backingDataset":"","organization":"leo1311","expStatus":0,"groups":[]},"isValidation":"","samplingRatio":"","applySchema":false}]},{"id":"ffQic","alias":"Clean Text","name":"Pre  Processing  Script","classname":"PreProcessingScriptConfig","category":"BaseConfig","attributes":{"params":"","script":["import logging as logger\r","from pyspark.sql.functions import *\r","from pyspark.sql.types import *\r","import re\r","\r","\r","class CustomPythonClass():\r","    def __main__(self, dataset):\r","        \r","        def alphaNum(text):\r","            alphanumeric = ''''\r","            for character in text:\r","                if character.isalnum():\r","                    alphanumeric += character\r","                else:\r","                    alphanumeric += '' ''\r","            alphanumeric = re.sub('' +'', '' '', alphanumeric)\r","            finalTokens = [t for t in alphanumeric.split('' '') if not t.isnumeric()]\r","            return '' ''.join(finalTokens)\r","        udfAlpaNum = udf(alphaNum, StringType())\r","        dataset = dataset.withColumn(''cleanText'',udfAlpaNum(''shortdescription''))\r","        dataset = dataset.select(''number'',''shortdescription'',''group_by_field'', ''cleanText'' )\r","        \r","        return dataset\r","\r","\r","\r","\r"],"outputCols":"number,shortdescription,cleanText,group_by_field"},"position_x":"260","position_y":"30","connectors":[{"type":"target","endpoint":"dataset1","position":"LeftMiddle","elementId":"UEeVc","elementPosition":"RightMiddle"},{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"cMPGE","elementPosition":"LeftMiddle"}],"inputEndpoints":["dataset1","dataset2","dataset3"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"params":"textarea","script":"textarea","outputCols":"text"},"context":[{"dataset":{"name":"ZPVLYWVANZ","alias":"Tickets","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-11 08:32:13","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encvBQOC5yizoW7x+rkuw/6JG8nmcwszpOHF2o=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leap1311_data\"}","salt":"VlJy2CHz9GHmCzcFEbjoeXAcOhW33TiLagZ9HVAj3/KcaGWdmdJW/12k2VruMpxw1BOQK4C9K0N3ghm394mWFQ==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-11 08:32:13","category":"SQL"},"schema":null,"type":"r","attributes":{"filter":"","mode":"query","Query":"Select number, shortdescription, configurationItem as group_by_field from @projectname_tickets where shortdescription != '''' and   shortdescription is not Null  ","Cacheable":"","isStreaming":"false","writeMode":"append","params":"{}","tableName":"","defaultValues":"","uniqueIdentifier":""},"datasetType":"MYSQL","backingDataset":"","organization":"leo1311","expStatus":0,"groups":[]},"isValidation":"","samplingRatio":"","applySchema":false}]},{"id":"cMPGE","alias":"Tokenizer","name":"Tokenizer","classname":"TokenizerTransformerConfig","category":"TransformerConfig","attributes":{"inputCol":"cleanText","outputCol":"tokens"},"position_x":"520","position_y":"30","connectors":[{"type":"target","endpoint":"in","position":"LeftMiddle","elementId":"ffQic","elementPosition":"RightMiddle"},{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"IgGTx","elementPosition":"LeftMiddle"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"inputCol":"text","outputCol":"text"},"context":[{"params":"","script":["import logging as logger\r","from pyspark.sql.functions import *\r","from pyspark.sql.types import *\r","import re\r","\r","\r","class CustomPythonClass():\r","    def __main__(self, dataset):\r","        \r","        def alphaNum(text):\r","            alphanumeric = ''''\r","            for character in text:\r","                if character.isalnum():\r","                    alphanumeric += character\r","                else:\r","                    alphanumeric += '' ''\r","            alphanumeric = re.sub('' +'', '' '', alphanumeric)\r","            finalTokens = [t for t in alphanumeric.split('' '') if not t.isnumeric()]\r","            return '' ''.join(finalTokens)\r","        udfAlpaNum = udf(alphaNum, StringType())\r","        dataset = dataset.withColumn(''cleanText'',udfAlpaNum(''shortdescription''))\r","        dataset = dataset.select(''number'',''shortdescription'',''group_by_field'', ''cleanText'' )\r","        \r","        return dataset\r","\r","\r","\r","\r"],"outputCols":"number,shortdescription,cleanText,group_by_field"},{"dataset":{"name":"ZPVLYWVANZ","alias":"Tickets","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-11 08:32:13","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encvBQOC5yizoW7x+rkuw/6JG8nmcwszpOHF2o=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leap1311_data\"}","salt":"VlJy2CHz9GHmCzcFEbjoeXAcOhW33TiLagZ9HVAj3/KcaGWdmdJW/12k2VruMpxw1BOQK4C9K0N3ghm394mWFQ==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-11 08:32:13","category":"SQL"},"schema":null,"type":"r","attributes":{"filter":"","mode":"query","Query":"Select number, shortdescription, configurationItem as group_by_field from @projectname_tickets where shortdescription != '''' and   shortdescription is not Null  ","Cacheable":"","isStreaming":"false","writeMode":"append","params":"{}","tableName":"","defaultValues":"","uniqueIdentifier":""},"datasetType":"MYSQL","backingDataset":"","organization":"leo1311","expStatus":0,"groups":[]},"isValidation":"","samplingRatio":"","applySchema":false}]},{"id":"IgGTx","alias":"Stop  Words  Remover","name":"Stop  Words  Remover","classname":"StopWordsRemoverTransformerConfig","category":"TransformerConfig","attributes":{"inputCol":"tokens","outputCol":"clean_tokens","stopWords":"id"},"position_x":"760","position_y":"30","connectors":[{"type":"target","endpoint":"in","position":"LeftMiddle","elementId":"cMPGE","elementPosition":"RightMiddle"},{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"fPAbp","elementPosition":"LeftMiddle"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"inputCol":"text","outputCol":"text","stopWords":"text"},"context":[{"inputCol":"cleanText","outputCol":"tokens"},{"params":"","script":["import logging as logger\r","from pyspark.sql.functions import *\r","from pyspark.sql.types import *\r","import re\r","\r","\r","class CustomPythonClass():\r","    def __main__(self, dataset):\r","        \r","        def alphaNum(text):\r","            alphanumeric = ''''\r","            for character in text:\r","                if character.isalnum():\r","                    alphanumeric += character\r","                else:\r","                    alphanumeric += '' ''\r","            alphanumeric = re.sub('' +'', '' '', alphanumeric)\r","            finalTokens = [t for t in alphanumeric.split('' '') if not t.isnumeric()]\r","            return '' ''.join(finalTokens)\r","        udfAlpaNum = udf(alphaNum, StringType())\r","        dataset = dataset.withColumn(''cleanText'',udfAlpaNum(''shortdescription''))\r","        dataset = dataset.select(''number'',''shortdescription'',''group_by_field'', ''cleanText'' )\r","        \r","        return dataset\r","\r","\r","\r","\r"],"outputCols":"number,shortdescription,cleanText,group_by_field"},{"dataset":{"name":"ZPVLYWVANZ","alias":"Tickets","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-11 08:32:13","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encvBQOC5yizoW7x+rkuw/6JG8nmcwszpOHF2o=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leap1311_data\"}","salt":"VlJy2CHz9GHmCzcFEbjoeXAcOhW33TiLagZ9HVAj3/KcaGWdmdJW/12k2VruMpxw1BOQK4C9K0N3ghm394mWFQ==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-11 08:32:13","category":"SQL"},"schema":null,"type":"r","attributes":{"filter":"","mode":"query","Query":"Select number, shortdescription, configurationItem as group_by_field from @projectname_tickets where shortdescription != '''' and   shortdescription is not Null  ","Cacheable":"","isStreaming":"false","writeMode":"append","params":"{}","tableName":"","defaultValues":"","uniqueIdentifier":""},"datasetType":"MYSQL","backingDataset":"","organization":"leo1311","expStatus":0,"groups":[]},"isValidation":"","samplingRatio":"","applySchema":false}]},{"id":"fPAbp","alias":"Lemmetizer","name":"Python  Script  Transformer","classname":"PythonScriptTransformerConfig","category":"TransformerConfig","attributes":{"script":["import logging\r","from pyspark.sql.functions import *\r","from pyspark.sql.types import *\r","from nltk.stem import WordNetLemmatizer\r","from datetime import datetime\r","\r","class CustomPythonClass():\r","    def __main__(self, dataset):\r","      \r","        def lemmatize(tokens):\r","            wordnet_lemmatizer = WordNetLemmatizer()\r","            lemmatizedTokens = []\r","            for word in tokens:\r","                lemmatizedTokens.append(wordnet_lemmatizer.lemmatize(word, pos=''v''))\r","            return '' ''.join(lemmatizedTokens)\r","        \r","        udfLemmetize = udf(lemmatize, StringType())\r","        dataset = dataset.withColumn(''clean_text'',udfLemmetize(''clean_tokens''))\r","        dataset = dataset.select(''number'',''clean_text'', ''group_by_field'')\r","        dataset = dataset.withColumn(''last_updated'',lit(datetime.now()))\r","        dataset = dataset.repartition(100)\r","        return dataset\r","\r","\r","\r","\r"],"outputCols":"lemmatizedText"},"position_x":"70","position_y":"200","connectors":[{"type":"target","endpoint":"in","position":"LeftMiddle","elementId":"IgGTx","elementPosition":"RightMiddle"},{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"HYOWn","elementPosition":"LeftMiddle"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"script":"textarea","outputCols":"text"},"context":[{"inputCol":"tokens","outputCol":"clean_tokens","stopWords":"id"},{"inputCol":"cleanText","outputCol":"tokens"},{"params":"","script":["import logging as logger\r","from pyspark.sql.functions import *\r","from pyspark.sql.types import *\r","import re\r","\r","\r","class CustomPythonClass():\r","    def __main__(self, dataset):\r","        \r","        def alphaNum(text):\r","            alphanumeric = ''''\r","            for character in text:\r","                if character.isalnum():\r","                    alphanumeric += character\r","                else:\r","                    alphanumeric += '' ''\r","            alphanumeric = re.sub('' +'', '' '', alphanumeric)\r","            finalTokens = [t for t in alphanumeric.split('' '') if not t.isnumeric()]\r","            return '' ''.join(finalTokens)\r","        udfAlpaNum = udf(alphaNum, StringType())\r","        dataset = dataset.withColumn(''cleanText'',udfAlpaNum(''shortdescription''))\r","        dataset = dataset.select(''number'',''shortdescription'',''group_by_field'', ''cleanText'' )\r","        \r","        return dataset\r","\r","\r","\r","\r"],"outputCols":"number,shortdescription,cleanText,group_by_field"},{"dataset":{"name":"ZPVLYWVANZ","alias":"Tickets","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-11 08:32:13","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encvBQOC5yizoW7x+rkuw/6JG8nmcwszpOHF2o=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leap1311_data\"}","salt":"VlJy2CHz9GHmCzcFEbjoeXAcOhW33TiLagZ9HVAj3/KcaGWdmdJW/12k2VruMpxw1BOQK4C9K0N3ghm394mWFQ==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-11 08:32:13","category":"SQL"},"schema":null,"type":"r","attributes":{"filter":"","mode":"query","Query":"Select number, shortdescription, configurationItem as group_by_field from @projectname_tickets where shortdescription != '''' and   shortdescription is not Null  ","Cacheable":"","isStreaming":"false","writeMode":"append","params":"{}","tableName":"","defaultValues":"","uniqueIdentifier":""},"datasetType":"MYSQL","backingDataset":"","organization":"leo1311","expStatus":0,"groups":[]},"isValidation":"","samplingRatio":"","applySchema":false}]}]}' WHERE name='ACMCLNTC99308' AND organization='leo1311';
			UPDATE mlpipeline SET json_content='{"elements":[{"id":"PiYva","alias":"Tickets","name":"Dataset  Extractor","classname":"DatasetExtractorConfig","category":"ExtractorConfig","attributes":{"dataset":{"id":39032,"name":"input","alias":"input","description":"Tickets with soundex of Short description","schema":null,"attributes":{"filter":"","mode":"query","Query":"SELECT number, clean_text, Soundex(clean_text) as sound, CASE WHEN group_by_field IS NULL THEN '''' ELSE group_by_field END AS group_by_field FROM @projectname_tickets_enriched  WHERE clean_text is not null and  Soundex(clean_text) != '''' and clean_text != ''''","Cacheable":"false","isStreaming":"false","writeMode":"append","params":"{}","tableName":"","defaultValues":"","uniqueIdentifier":""},"type":"r","backingDataset":"","organization":"leo1311","datasetType":"MYSQL","expStatus":0,"datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"groups":""},"isValidation":"","samplingRatio":"","applySchema":false,"restnode":true},"position_x":"170","position_y":"80","connectors":[{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"CSUzm","elementPosition":"LeftMiddle"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"dataset":"dropdown","isValidation":"checkbox","samplingRatio":"text","applySchema":"checkbox"},"context":[]},{"id":"CSUzm","alias":"Create Clusters","name":"Python  Script  Transformer","classname":"PythonScriptTransformerConfig","category":"TransformerConfig","attributes":{"script":["import logging\r","from datetime import datetime\r","from pyspark.sql.types import *\r","from pyspark.sql.functions import *\r","import re\r","class CustomPythonClass():\r","    def __main__(self, dataset):\r","        soundDf = dataset.groupBy(''group_by_field'',''sound'').agg(collect_list(''number'').alias(''numberList''), collect_list(''clean_text'').alias(''text_list''))\r","\r","       \r","        soundDf = soundDf.withColumn(''numberListSize'', size(''numberList''))\r","        soundDf = soundDf.filter(soundDf[''numberListSize'']>=5)\r","        soundDf = soundDf.withColumn(''cluster'' , soundDf[''text_list''].getItem(0)).drop(''text_list'')\r","        \r","        soundDf = soundDf.select(''group_by_field'', ''cluster'', ''numberList'',''sound'')\r","        soundDf = soundDf.withColumn(''number'',explode(''numberList'')).drop(''numberList'')\r","        soundDf = soundDf.withColumn(''last_updated'',lit(datetime.now()))\r","\r","        soundDf = soundDf.select(''number'',col(''cluster'').alias(''soundex_cluster''),''last_updated'')\r","\r","        \r","        soundDf = soundDf.repartition(50)\r","        return soundDf\r","\r","\r","\r","\r","\r","\r","\r","\r","\r","\r","\r"]},"position_x":"460","position_y":"80","connectors":[{"type":"target","endpoint":"in","position":"LeftMiddle","elementId":"PiYva","elementPosition":"RightMiddle"},{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"MNpqZ","elementPosition":"LeftMiddle"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"script":"textarea"},"context":[{"dataset":{"id":39032,"name":"input","alias":"input","description":"Tickets with soundex of Short description","schema":null,"attributes":{"filter":"","mode":"query","Query":"SELECT number, clean_text, Soundex(clean_text) as sound, CASE WHEN group_by_field IS NULL THEN '''' ELSE group_by_field END AS group_by_field FROM @projectname_tickets_enriched  WHERE clean_text is not null and  Soundex(clean_text) != '''' and clean_text != ''''","Cacheable":"false","isStreaming":"false","writeMode":"append","params":"{}","tableName":"","defaultValues":"","uniqueIdentifier":""},"type":"r","backingDataset":"","organization":"leo1311","datasetType":"MYSQL","expStatus":0,"datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"groups":""},"isValidation":"","samplingRatio":"","applySchema":false,"restnode":true}]},{"id":"MNpqZ","alias":"Clusters","name":"Dataset  Loader","classname":"DatasetLoaderConfig","category":"LoaderConfig","attributes":{"dataset":{"id":39032,"name":"DJR9U1LGA5","alias":"Cluster","description":"Tickets with soundex of Short description","schema":null,"attributes":{"filter":"","mode":"query","Query":"Select  number , soundex_cluster, last_updated from @projectname_soundex","Cacheable":"false","isStreaming":"false","writeMode":"overwrite","params":"{}","tableName":"@projectname_soundex","defaultValues":"","uniqueIdentifier":""},"type":"rw","backingDataset":"","organization":"leo1311","datasetType":"MYSQL","groups":[],"expStatus":0,"datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"}},"applySchema":false},"position_x":"770","position_y":"80","connectors":[{"type":"target","endpoint":"in","position":"LeftMiddle","elementId":"CSUzm","elementPosition":"RightMiddle"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"dataset":"dropdown","applySchema":"checkbox"},"context":[{"script":["import logging\r","from datetime import datetime\r","from pyspark.sql.types import *\r","from pyspark.sql.functions import *\r","import re\r","class CustomPythonClass():\r","    def __main__(self, dataset):\r","        soundDf = dataset.groupBy(''group_by_field'',''sound'').agg(collect_list(''number'').alias(''numberList''), collect_list(''clean_text'').alias(''text_list''))\r","\r","       \r","        soundDf = soundDf.withColumn(''numberListSize'', size(''numberList''))\r","        soundDf = soundDf.filter(soundDf[''numberListSize'']>=5)\r","        soundDf = soundDf.withColumn(''cluster'' , soundDf[''text_list''].getItem(0)).drop(''text_list'')\r","        \r","        soundDf = soundDf.select(''group_by_field'', ''cluster'', ''numberList'',''sound'')\r","        soundDf = soundDf.withColumn(''number'',explode(''numberList'')).drop(''numberList'')\r","        soundDf = soundDf.withColumn(''last_updated'',lit(datetime.now()))\r","\r","        soundDf = soundDf.select(''number'',col(''cluster'').alias(''soundex_cluster''),''last_updated'')\r","\r","        \r","        soundDf = soundDf.repartition(50)\r","        return soundDf\r","\r","\r","\r","\r","\r","\r","\r","\r","\r","\r","\r"]},{"dataset":{"id":39032,"name":"input","alias":"input","description":"Tickets with soundex of Short description","schema":null,"attributes":{"filter":"","mode":"query","Query":"SELECT number, clean_text, Soundex(clean_text) as sound, CASE WHEN group_by_field IS NULL THEN '''' ELSE group_by_field END AS group_by_field FROM @projectname_tickets_enriched  WHERE clean_text is not null and  Soundex(clean_text) != '''' and clean_text != ''''","Cacheable":"false","isStreaming":"false","writeMode":"append","params":"{}","tableName":"","defaultValues":"","uniqueIdentifier":""},"type":"r","backingDataset":"","organization":"leo1311","datasetType":"MYSQL","expStatus":0,"datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"groups":""},"isValidation":"","samplingRatio":"","applySchema":false,"restnode":true}]}]}' WHERE name='ACMCLSTR99942' AND organization='leo1311';
			UPDATE mlpipeline SET json_content='{"elements":[{"id":"OxxDW","alias":"Filter Dataset","name":"Pre  Processing  Script","classname":"PreProcessingScriptConfig","category":"BaseConfig","attributes":{"params":"{}","script":["import logging as logger\r","from pyspark.sql.functions import *\r","from pyspark.sql.types import *\r","class CustomPythonClass():\r","    def __main__(self, dataset):\r","        data = dataset.withColumn(''cluster_Type'',lit(''LDA''))\r","        filteredCIs = data.groupBy(''group_by_field'').count().filter((col(''count'') >=50) ).select(''group_by_field'')\r","        ciList= filteredCIs.rdd.map(lambda r: r[0]).collect()\r","        if ciList is not None and len(ciList) ==0:\r","            logger.info(''No data for clustering'')\r","            logger.info(''Completed'')\r","            print(''Completed'')\r","            exit()\r","        filtereddf = data.filter(col(''group_by_field'').isin(ciList))\r","        return filtereddf\r"]},"position_x":"340","position_y":"100","connectors":[{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"sXmyX","elementPosition":"LeftMiddle"},{"type":"target","endpoint":"dataset1","position":"LeftMiddle","elementId":"LREJS","elementPosition":"RightMiddle"}],"inputEndpoints":["dataset1","dataset2","dataset3"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"params":"textarea","script":"textarea"},"context":[{"dataset":{"alias":"Input","name":"","description":"Tickets for LDA Clustering","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":{"lastmodifiedby":"admin","lastmodifieddate":"2021-05-25 07:58:24","alias":"LDA Cluster","id":7,"name":"ACMLDCLS54038","schemavalue":"[{\"columntype\":\"string\",\"columnorder\":1,\"recordcolumnname\":\"number\",\"recordcolumndisplayname\":\"number\"},{\"columntype\":\"string\",\"columnorder\":2,\"recordcolumnname\":\"clean_text\",\"recordcolumndisplayname\":\"clean_text\"},{\"columntype\":\"string\",\"columnorder\":3,\"recordcolumnname\":\"group_by_field\",\"recordcolumndisplayname\":\"group_by_field\"}]","organization":"leo1311","formtemplate":"[]"},"type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT number, clean_text, CASE WHEN group_by_field IS NULL THEN '''' ELSE group_by_field END AS group_by_field  FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != ''''","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":""},"expStatus":0,"groups":"","backingDataset":""},"isValidation":"","samplingRatio":"","applySchema":false}]},{"id":"IUlqx","alias":"Post  Processing  Script","name":"Post  Processing  Script","classname":"PostProcessingScriptConfig","category":"BaseConfig","attributes":{"params":"","script":["import logging\r","from pyspark.sql.types import *\r","from pyspark.sql.functions import *\r","from datetime import datetime\r","class CustomPythonClass():\r","    def __main__(self,model, dataset):\r","        dataset = dataset[''out'']\r","        dataset = dataset.select(''number'',col(''cluster_name'').alias(''lda_cluster'') )\r","        dataset = dataset.withColumn(''last_updated'',lit(datetime.now()))\r","        dataset = dataset.repartition(200)\r","        return dataset\r","\r","\r","\r","\r","\r","\r","\r"]},"position_x":"720","position_y":"240","connectors":[{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"XJUTb","elementPosition":"LeftMiddle"},{"type":"target","endpoint":"in","position":"LeftMiddle","elementId":"sXmyX","elementPosition":"BottomCenter"}],"inputEndpoints":["in"],"outputEndpoints":["out","out2"],"requiredJars":[],"formats":{"params":"textarea","script":"textarea"},"context":[{"UniqueIdColumn":"number","GroupByColumn":"group_by_field","TextColumn":"clean_text","customStopWords":"","vocabSize":"10000","ClusterCount":"10","checkPointInterval":"10","saveModels":""},{"params":"{}","script":["import logging as logger\r","from pyspark.sql.functions import *\r","from pyspark.sql.types import *\r","class CustomPythonClass():\r","    def __main__(self, dataset):\r","        data = dataset.withColumn(''cluster_Type'',lit(''LDA''))\r","        filteredCIs = data.groupBy(''group_by_field'').count().filter((col(''count'') >=50) ).select(''group_by_field'')\r","        ciList= filteredCIs.rdd.map(lambda r: r[0]).collect()\r","        if ciList is not None and len(ciList) ==0:\r","            logger.info(''No data for clustering'')\r","            logger.info(''Completed'')\r","            print(''Completed'')\r","            exit()\r","        filtereddf = data.filter(col(''group_by_field'').isin(ciList))\r","        return filtereddf\r"]},{"dataset":{"alias":"Input","name":"","description":"Tickets for LDA Clustering","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":{"lastmodifiedby":"admin","lastmodifieddate":"2021-05-25 07:58:24","alias":"LDA Cluster","id":7,"name":"ACMLDCLS54038","schemavalue":"[{\"columntype\":\"string\",\"columnorder\":1,\"recordcolumnname\":\"number\",\"recordcolumndisplayname\":\"number\"},{\"columntype\":\"string\",\"columnorder\":2,\"recordcolumnname\":\"clean_text\",\"recordcolumndisplayname\":\"clean_text\"},{\"columntype\":\"string\",\"columnorder\":3,\"recordcolumnname\":\"group_by_field\",\"recordcolumndisplayname\":\"group_by_field\"}]","organization":"leo1311","formtemplate":"[]"},"type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT number, clean_text, CASE WHEN group_by_field IS NULL THEN '''' ELSE group_by_field END AS group_by_field  FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != ''''","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":""},"expStatus":0,"groups":"","backingDataset":""},"isValidation":"","samplingRatio":"","applySchema":false}]},{"id":"hPWgu","alias":"Dataset  Loader","name":"Dataset  Loader","classname":"DatasetLoaderConfig","category":"LoaderConfig","attributes":{"dataset":{"alias":"Topics","name":"","description":"Clustering topics vocab","schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"Select * from @projectname_clustering_topics","isStreaming":"false","defaultValues":"","writeMode":"overwrite","params":"{}","tableName":"@projectname_clustering_topics","uniqueIdentifier":""},"expStatus":0,"groups":"","backingDataset":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"}},"applySchema":false},"position_x":"840","position_y":"100","connectors":[{"type":"target","endpoint":"in","position":"LeftMiddle","elementId":"sXmyX","elementPosition":"RightMiddle"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"dataset":"dropdown","applySchema":"checkbox"},"context":[{"UniqueIdColumn":"number","GroupByColumn":"group_by_field","TextColumn":"clean_text","customStopWords":"","vocabSize":"10000","ClusterCount":"10","checkPointInterval":"10","saveModels":""},{"params":"{}","script":["import logging as logger\r","from pyspark.sql.functions import *\r","from pyspark.sql.types import *\r","class CustomPythonClass():\r","    def __main__(self, dataset):\r","        data = dataset.withColumn(''cluster_Type'',lit(''LDA''))\r","        filteredCIs = data.groupBy(''group_by_field'').count().filter((col(''count'') >=50) ).select(''group_by_field'')\r","        ciList= filteredCIs.rdd.map(lambda r: r[0]).collect()\r","        if ciList is not None and len(ciList) ==0:\r","            logger.info(''No data for clustering'')\r","            logger.info(''Completed'')\r","            print(''Completed'')\r","            exit()\r","        filtereddf = data.filter(col(''group_by_field'').isin(ciList))\r","        return filtereddf\r"]},{"dataset":{"alias":"Input","name":"","description":"Tickets for LDA Clustering","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":{"lastmodifiedby":"admin","lastmodifieddate":"2021-05-25 07:58:24","alias":"LDA Cluster","id":7,"name":"ACMLDCLS54038","schemavalue":"[{\"columntype\":\"string\",\"columnorder\":1,\"recordcolumnname\":\"number\",\"recordcolumndisplayname\":\"number\"},{\"columntype\":\"string\",\"columnorder\":2,\"recordcolumnname\":\"clean_text\",\"recordcolumndisplayname\":\"clean_text\"},{\"columntype\":\"string\",\"columnorder\":3,\"recordcolumnname\":\"group_by_field\",\"recordcolumndisplayname\":\"group_by_field\"}]","organization":"leo1311","formtemplate":"[]"},"type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT number, clean_text, CASE WHEN group_by_field IS NULL THEN '''' ELSE group_by_field END AS group_by_field  FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != ''''","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":""},"expStatus":0,"groups":"","backingDataset":""},"isValidation":"","samplingRatio":"","applySchema":false}]},{"id":"XJUTb","alias":"Dataset  Loader","name":"Dataset  Loader","classname":"DatasetLoaderConfig","category":"LoaderConfig","attributes":{"dataset":{"alias":"Clusters","name":"KBJUD4APBG","description":"LDA clusters","schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT  number , lda_cluster,lda_cluster_confidence, last_updated  from  @projectname_lda","isStreaming":"false","defaultValues":"","writeMode":"overwrite","params":"{}","tableName":"@projectname_lda","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"groups":[],"backingDataset":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"}},"applySchema":false},"position_x":"950","position_y":"240","connectors":[{"type":"target","endpoint":"in","position":"LeftMiddle","elementId":"IUlqx","elementPosition":"RightMiddle"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"dataset":"dropdown","applySchema":"checkbox"},"context":[{"params":"","script":["import logging\r","from pyspark.sql.types import *\r","from pyspark.sql.functions import *\r","from datetime import datetime\r","class CustomPythonClass():\r","    def __main__(self,model, dataset):\r","        dataset = dataset[''out'']\r","        dataset = dataset.select(''number'',col(''cluster_name'').alias(''lda_cluster'') )\r","        dataset = dataset.withColumn(''last_updated'',lit(datetime.now()))\r","        dataset = dataset.repartition(200)\r","        return dataset\r","\r","\r","\r","\r","\r","\r","\r"]},{"UniqueIdColumn":"number","GroupByColumn":"group_by_field","TextColumn":"clean_text","customStopWords":"","vocabSize":"10000","ClusterCount":"10","checkPointInterval":"10","saveModels":""},{"params":"{}","script":["import logging as logger\r","from pyspark.sql.functions import *\r","from pyspark.sql.types import *\r","class CustomPythonClass():\r","    def __main__(self, dataset):\r","        data = dataset.withColumn(''cluster_Type'',lit(''LDA''))\r","        filteredCIs = data.groupBy(''group_by_field'').count().filter((col(''count'') >=50) ).select(''group_by_field'')\r","        ciList= filteredCIs.rdd.map(lambda r: r[0]).collect()\r","        if ciList is not None and len(ciList) ==0:\r","            logger.info(''No data for clustering'')\r","            logger.info(''Completed'')\r","            print(''Completed'')\r","            exit()\r","        filtereddf = data.filter(col(''group_by_field'').isin(ciList))\r","        return filtereddf\r"]},{"dataset":{"alias":"Input","name":"","description":"Tickets for LDA Clustering","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":{"lastmodifiedby":"admin","lastmodifieddate":"2021-05-25 07:58:24","alias":"LDA Cluster","id":7,"name":"ACMLDCLS54038","schemavalue":"[{\"columntype\":\"string\",\"columnorder\":1,\"recordcolumnname\":\"number\",\"recordcolumndisplayname\":\"number\"},{\"columntype\":\"string\",\"columnorder\":2,\"recordcolumnname\":\"clean_text\",\"recordcolumndisplayname\":\"clean_text\"},{\"columntype\":\"string\",\"columnorder\":3,\"recordcolumnname\":\"group_by_field\",\"recordcolumndisplayname\":\"group_by_field\"}]","organization":"leo1311","formtemplate":"[]"},"type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT number, clean_text, CASE WHEN group_by_field IS NULL THEN '''' ELSE group_by_field END AS group_by_field  FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != ''''","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":""},"expStatus":0,"groups":"","backingDataset":""},"isValidation":"","samplingRatio":"","applySchema":false}]},{"id":"LREJS","alias":"Dataset  Extractor","name":"Dataset  Extractor","classname":"DatasetExtractorConfig","category":"ExtractorConfig","attributes":{"dataset":{"alias":"Input","name":"","description":"Tickets for LDA Clustering","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":{"lastmodifiedby":"admin","lastmodifieddate":"2021-05-25 07:58:24","alias":"LDA Cluster","id":7,"name":"ACMLDCLS54038","schemavalue":"[{\"columntype\":\"string\",\"columnorder\":1,\"recordcolumnname\":\"number\",\"recordcolumndisplayname\":\"number\"},{\"columntype\":\"string\",\"columnorder\":2,\"recordcolumnname\":\"clean_text\",\"recordcolumndisplayname\":\"clean_text\"},{\"columntype\":\"string\",\"columnorder\":3,\"recordcolumnname\":\"group_by_field\",\"recordcolumndisplayname\":\"group_by_field\"}]","organization":"leo1311","formtemplate":"[]"},"type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT number, clean_text, CASE WHEN group_by_field IS NULL THEN '''' ELSE group_by_field END AS group_by_field  FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != ''''","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":""},"expStatus":0,"groups":"","backingDataset":""},"isValidation":"","samplingRatio":"","applySchema":false},"position_x":"60","position_y":"100","connectors":[{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"OxxDW","elementPosition":"LeftMiddle"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"dataset":"dropdown","isValidation":"checkbox","samplingRatio":"text","applySchema":"checkbox"},"context":[]},{"id":"sXmyX","alias":"Incident  Clustering","name":"Incident  Clustering","classname":"IncidentClusteringLDAConfig","category":"DomainSolutionConfig","attributes":{"UniqueIdColumn":"number","GroupByColumn":"group_by_field","TextColumn":"clean_text","customStopWords":"","vocabSize":"10000","ClusterCount":"10","checkPointInterval":"10","saveModels":""},"position_x":"590","position_y":"100","connectors":[{"type":"target","endpoint":"in","position":"LeftMiddle","elementId":"OxxDW","elementPosition":"RightMiddle"},{"type":"source","endpoint":"topics","position":"RightMiddle","elementId":"hPWgu","elementPosition":"LeftMiddle"},{"type":"source","endpoint":"out","position":"BottomCenter","elementId":"IUlqx","elementPosition":"LeftMiddle"}],"inputEndpoints":["in"],"outputEndpoints":["topics","out"],"requiredJars":[],"formats":{"UniqueIdColumn":"text","GroupByColumn":"text","TextColumn":"text","customStopWords":"text","vocabSize":"text","ClusterCount":"text","checkPointInterval":"text","saveModels":"checkbox"},"context":[{"params":"{}","script":["import logging as logger\r","from pyspark.sql.functions import *\r","from pyspark.sql.types import *\r","class CustomPythonClass():\r","    def __main__(self, dataset):\r","        data = dataset.withColumn(''cluster_Type'',lit(''LDA''))\r","        filteredCIs = data.groupBy(''group_by_field'').count().filter((col(''count'') >=50) ).select(''group_by_field'')\r","        ciList= filteredCIs.rdd.map(lambda r: r[0]).collect()\r","        if ciList is not None and len(ciList) ==0:\r","            logger.info(''No data for clustering'')\r","            logger.info(''Completed'')\r","            print(''Completed'')\r","            exit()\r","        filtereddf = data.filter(col(''group_by_field'').isin(ciList))\r","        return filtereddf\r"]},{"dataset":{"alias":"Input","name":"","description":"Tickets for LDA Clustering","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":{"lastmodifiedby":"admin","lastmodifieddate":"2021-05-25 07:58:24","alias":"LDA Cluster","id":7,"name":"ACMLDCLS54038","schemavalue":"[{\"columntype\":\"string\",\"columnorder\":1,\"recordcolumnname\":\"number\",\"recordcolumndisplayname\":\"number\"},{\"columntype\":\"string\",\"columnorder\":2,\"recordcolumnname\":\"clean_text\",\"recordcolumndisplayname\":\"clean_text\"},{\"columntype\":\"string\",\"columnorder\":3,\"recordcolumnname\":\"group_by_field\",\"recordcolumndisplayname\":\"group_by_field\"}]","organization":"leo1311","formtemplate":"[]"},"type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT number, clean_text, CASE WHEN group_by_field IS NULL THEN '''' ELSE group_by_field END AS group_by_field  FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != ''''","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":""},"expStatus":0,"groups":"","backingDataset":""},"isValidation":"","samplingRatio":"","applySchema":false}]}]}' WHERE name='ACMCLSTR21224' AND organization='leo1311';
			UPDATE mlpipeline SET json_content='{"elements":[{"id":"UEeVc","alias":"Dataset  Extractor","name":"Dataset  Extractor","classname":"DatasetExtractorConfig","category":"ExtractorConfig","attributes":{"dataset":{"name":"ZK0CN34C9S","alias":"Tickets","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":null,"type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT number, clean_text FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != ''''","Cacheable":"","isStreaming":"false","writeMode":"append","params":"{}","tableName":"","defaultValues":"","uniqueIdentifier":""},"datasetType":"MYSQL","backingDataset":"","organization":"leo1311","expStatus":0,"groups":""},"isValidation":"","samplingRatio":"","applySchema":false},"position_x":"40","position_y":"30","connectors":[{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"XQVmY","elementPosition":"LeftMiddle"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"dataset":"dropdown","isValidation":"checkbox","samplingRatio":"text","applySchema":"checkbox"},"context":[]},{"id":"HYOWn","alias":"Dataset  Loader","name":"Dataset  Loader","classname":"DatasetLoaderConfig","category":"LoaderConfig","attributes":{"dataset":{"name":"RGQTFH97NN","alias":"Phrases","description":"Phrases","schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"select number, extracted_phrase, mapped_phrase, mapped_phrase_confidennce, last_updated from @projectname_phrase_extraction","Cacheable":"","isStreaming":"false","writeMode":"overwrite","params":"{}","tableName":"@projectname_phrase_extraction","defaultValues":"","uniqueIdentifier":""},"expStatus":0,"datasetType":"MYSQL","groups":[],"backingDataset":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"}},"applySchema":false},"position_x":"730","position_y":"30","connectors":[{"type":"target","endpoint":"in","position":"LeftMiddle","elementId":"XQVmY","elementPosition":"RightMiddle"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"dataset":"dropdown","applySchema":"checkbox"},"context":[{"script":["import logging\r","from pyspark.sql.functions import *\r","from pyspark.sql.types import *\r","import spacy\r","import pytextrank\r","from datetime import datetime\r","from pyspark.sql import SparkSession\r","\r","class CustomPythonClass():\r","    def __main__(self, dataset):\r","        spark = SparkSession.builder.getOrCreate()\r","        nlp = spacy.load(''en_core_web_sm'')\r","        nlp.add_pipe(''textrank'')\r","        nlp_broadcast = spark.sparkContext.broadcast(nlp)\r","\r","        def getPharase(text):\r","            doc = nlp_broadcast.value(text)\r","            phrase =''''\r","            if len(doc._.phrases)>0:\r","                for item in doc._.phrases:\r","                    withoutSpace = item.text.replace('' '' ,'''')\r","                    if not withoutSpace.isdigit() and len(item.text.split('' '')) >1:\r","                        phrase = item.text\r","                        break\r","                return phrase\r","            else:\r","                return text\r","        \r","        udfPhrases = udf(getPharase,StringType())\r","        dataset.show()\r","        dataset = dataset.withColumn(''extracted_phrase'',udfPhrases(''clean_text''))\r","        dataset = dataset.select(''number'',''extracted_phrase'')\r","        dataset = dataset.withColumn(''mapped_phrase'',lit('' ''))\r","        dataset = dataset.withColumn(''mapped_phrase_confidennce'',lit('' ''))\r","        dataset = dataset.withColumn(''last_updated'',lit(datetime.now()))\r","        dataset.show()\r","\r","        return dataset\r","\r","\r","\r","\r","\r","\r"],"outputCols":"text"},{"dataset":{"name":"ZK0CN34C9S","alias":"Tickets","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":null,"type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT number, clean_text FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != ''''","Cacheable":"","isStreaming":"false","writeMode":"append","params":"{}","tableName":"","defaultValues":"","uniqueIdentifier":""},"datasetType":"MYSQL","backingDataset":"","organization":"leo1311","expStatus":0,"groups":""},"isValidation":"","samplingRatio":"","applySchema":false}]},{"id":"XQVmY","alias":"Phrase extraction","name":"Python  Script  Transformer","classname":"PythonScriptTransformerConfig","category":"TransformerConfig","attributes":{"script":["import logging\r","from pyspark.sql.functions import *\r","from pyspark.sql.types import *\r","import spacy\r","import pytextrank\r","from datetime import datetime\r","from pyspark.sql import SparkSession\r","\r","class CustomPythonClass():\r","    def __main__(self, dataset):\r","        spark = SparkSession.builder.getOrCreate()\r","        nlp = spacy.load(''en_core_web_sm'')\r","        nlp.add_pipe(''textrank'')\r","        nlp_broadcast = spark.sparkContext.broadcast(nlp)\r","\r","        def getPharase(text):\r","            doc = nlp_broadcast.value(text)\r","            phrase =''''\r","            if len(doc._.phrases)>0:\r","                for item in doc._.phrases:\r","                    withoutSpace = item.text.replace('' '' ,'''')\r","                    if not withoutSpace.isdigit() and len(item.text.split('' '')) >1:\r","                        phrase = item.text\r","                        break\r","                return phrase\r","            else:\r","                return text\r","        \r","        udfPhrases = udf(getPharase,StringType())\r","        dataset.show()\r","        dataset = dataset.withColumn(''extracted_phrase'',udfPhrases(''clean_text''))\r","        dataset = dataset.select(''number'',''extracted_phrase'')\r","        dataset = dataset.withColumn(''mapped_phrase'',lit('' ''))\r","        dataset = dataset.withColumn(''mapped_phrase_confidennce'',lit('' ''))\r","        dataset = dataset.withColumn(''last_updated'',lit(datetime.now()))\r","        dataset.show()\r","\r","        return dataset\r","\r","\r","\r","\r","\r","\r"],"outputCols":"text"},"position_x":"330","position_y":"30","connectors":[{"type":"target","endpoint":"in","position":"LeftMiddle","elementId":"UEeVc","elementPosition":"RightMiddle"},{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"HYOWn","elementPosition":"LeftMiddle"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"script":"textarea","outputCols":"text"},"context":[{"dataset":{"name":"ZK0CN34C9S","alias":"Tickets","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":null,"type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT number, clean_text FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != ''''","Cacheable":"","isStreaming":"false","writeMode":"append","params":"{}","tableName":"","defaultValues":"","uniqueIdentifier":""},"datasetType":"MYSQL","backingDataset":"","organization":"leo1311","expStatus":0,"groups":""},"isValidation":"","samplingRatio":"","applySchema":false}]}]}' WHERE name='ACMPHRSX44652' AND organization='leo1311';
			UPDATE mlpipeline SET json_content='{"elements":[{"id":"FqRsj","alias":"Dataset  Extractor","name":"Dataset  Extractor","classname":"DatasetExtractorConfig","category":"ExtractorConfig","attributes":{"dataset":{"alias":"Tickets","name":"Tickets","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT number, CAST(clean_text as CHAR) as clean_text FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != ''''  Order by Clean_text","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":""},"expStatus":0,"groups":"","backingDataset":""}},"position_x":"180","position_y":"50","connectors":[{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"XlASA","elementPosition":"LeftMiddle"}],"inputEndpoints":[],"outputEndpoints":["out"],"requiredJars":[],"formats":{"dataset":"dropdown"},"context":[]},{"id":"XlASA","alias":"Extract Phrases","name":"Python  Script  Transformer","classname":"PythonScriptTransformerConfig","category":"TransformerConfig","attributes":{"script":["import logging","import spacy","import pytextrank","from datetime import datetime","class CustomPythonClass():","    def __main__(self, dataset):","        nlp = spacy.load(''en_core_web_sm'')","        nlp.add_pipe(''textrank'')","        timenow = datetime.now()","        totalRecords = len(dataset)","        logging.info(''Fetched {0} records''.format(totalRecords))","        count =0","        textPhraseMappings = {}","        for row in dataset:","            try:","                text = row[''clean_text'']","                if textPhraseMappings.get(text,'''') != '''':","                    row[''extracted_phrase''] = textPhraseMappings[text]","                    break","                doc = nlp(text)","                phrase =''''","                if len(doc._.phrases)>0:","                    for item in doc._.phrases:","                        withoutSpace = item.text.replace('' '' ,'''')","                        if not withoutSpace.isdigit() and len(item.text.split('' '')) >1:","                            phrase = item.text","                            break","                if phrase != '''':","                    row[''extracted_phrase''] = phrase","                else:","                    row[''extracted_phrase''] = text","            except Exception as ex:","                logging.info(ex)","                row[''extracted_phrase''] = text","            row[''last_updated''] = timenow","            row[''mapped_phrase''] = ''''","            row[''mapped_phrase_confidennce''] = ''''","            count = count+1","            percentage = (count/totalRecords)*100 ","            if percentage%10 ==0:","                logging.info(''{0}% Completed''.format(percentage))","        ","        return dataset"]},"position_x":"440","position_y":"50","connectors":[{"type":"target","endpoint":"in1","position":"LeftMiddle","elementId":"FqRsj","elementPosition":"RightMiddle"},{"type":"source","endpoint":"out1","position":"RightMiddle","elementId":"JdZtY","elementPosition":"LeftMiddle"}],"inputEndpoints":["in1","in2"],"outputEndpoints":["out1","out2"],"requiredJars":[],"formats":{"script":"textarea"},"context":[{"dataset":{"alias":"Tickets","name":"Tickets","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2021-07-27 10:51:41","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MYSQL","connectionDetails":"{\"password\":\"@datasourcepass\",\"datasource\":\"\",\"userName\":\"@datasourceuser\",\"url\":\"@datasourceurl/leapmaster_data\"}","salt":"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==","organization":"leo1311","dshashcode":"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210","activetime":"2021-07-27 10:51:41","category":"SQL"},"schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT number, CAST(clean_text as CHAR) as clean_text FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != ''''  Order by Clean_text","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":""},"expStatus":0,"groups":"","backingDataset":""}}]},{"id":"JdZtY","alias":"Dataset  Loader","name":"Dataset  Loader","classname":"DatasetLoaderConfig","category":"LoaderConfig","attributes":{"dataset":{"alias":"Phrases","name":"TH2VXIBQRT","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"select number, extracted_phrase, mapped_phrase, mapped_phrase_confidennce, last_updated from @projectname_phrase_extraction","isStreaming":"false","defaultValues":"","writeMode":"overwrite","params":"{}","tableName":"@projectname_phrase_extraction","uniqueIdentifier":""},"expStatus":0,"groups":"","backingDataset":""}},"position_x":"740","position_y":"50","connectors":[{"type":"target","endpoint":"in","position":"LeftMiddle","elementId":"XlASA","elementPosition":"RightMiddle"}],"inputEndpoints":["in"],"outputEndpoints":[],"requiredJars":[],"formats":{"dataset":"dropdown"},"context":[{"script":["import logging","import spacy","import pytextrank","from datetime import datetime","class CustomPythonClass():","    def __main__(self, dataset):","        nlp = spacy.load(''en_core_web_sm'')","        nlp.add_pipe(''textrank'')","        timenow = datetime.now()","        totalRecords = len(dataset)","        logging.info(''Fetched {0} records''.format(totalRecords))","        count =0","        textPhraseMappings = {}","        for row in dataset:","            try:","                text = row[''clean_text'']","                if textPhraseMappings.get(text,'''') != '''':","                    row[''extracted_phrase''] = textPhraseMappings[text]","                    break","                doc = nlp(text)","                phrase =''''","                if len(doc._.phrases)>0:","                    for item in doc._.phrases:","                        withoutSpace = item.text.replace('' '' ,'''')","                        if not withoutSpace.isdigit() and len(item.text.split('' '')) >1:","                            phrase = item.text","                            break","                if phrase != '''':","                    row[''extracted_phrase''] = phrase","                else:","                    row[''extracted_phrase''] = text","            except Exception as ex:","                logging.info(ex)","                row[''extracted_phrase''] = text","            row[''last_updated''] = timenow","            row[''mapped_phrase''] = ''''","            row[''mapped_phrase_confidennce''] = ''''","            count = count+1","            percentage = (count/totalRecords)*100 ","            if percentage%10 ==0:","                logging.info(''{0}% Completed''.format(percentage))","        ","        return dataset"]},{"dataset":{"alias":"Tickets","name":"Tickets","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2021-07-27 10:51:41","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MYSQL","connectionDetails":"{\"password\":\"@datasourcepass\",\"datasource\":\"\",\"userName\":\"@datasourceuser\",\"url\":\"@datasourceurl/leapmaster_data\"}","salt":"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==","organization":"leo1311","dshashcode":"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210","activetime":"2021-07-27 10:51:41","category":"SQL"},"schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT number, CAST(clean_text as CHAR) as clean_text FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != ''''  Order by Clean_text","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":""},"expStatus":0,"groups":"","backingDataset":""}}]}]}' WHERE name='ACMPHRSX57460' AND organization='leo1311';
			UPDATE mlpipeline SET json_content='{"elements":[{"id":"WZFCq","alias":"Dataset  Extractor","name":"Dataset  Extractor","classname":"DatasetExtractorConfig","category":"ExtractorConfig","attributes":{"dataset":{"alias":"Clusters","name":"LPD29OS8SS","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":null,"type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT cast(t.number as char) AS number, tags AS tags, ng.ngram, sound.soundex_cluster FROM @projectname_tickets t LEFT\nJOIN @projectname_ngram ng ON t.number=cast(ng.number as char) LEFT JOIN @projectname_soundex sound ON t.number=cast(sound.number as char)","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"backingDataset":"","organization":"leo1311","groups":""},"isValidation":"","samplingRatio":"","applySchema":false},"position_x":"170","position_y":"160","connectors":[{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"nUpLq","elementPosition":"LeftMiddle"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"dataset":"dropdown","isValidation":"checkbox","samplingRatio":"text","applySchema":"checkbox"},"context":[]},{"id":"mNtFe","alias":"Python  Script  Transformer","name":"Python  Script  Transformer","classname":"PythonScriptTransformerConfig","category":"TransformerConfig","attributes":{"script":["import logging","from datetime import datetime","from pyspark.sql.functions import *","from pyspark.sql.types import *","class CustomPythonClass():","    def __main__(self, dataset):","        def getCluster(tags,ngram,soundex_cluster, lda_cluster,mapped_phrase  ):","            cluster = ''''","            if tags is not None and tags != '''':","                cluster = tags","            elif ngram is not None and ngram != '''':","                cluster = ngram","            elif soundex_cluster is not None and soundex_cluster != '''':","                cluster = soundex_cluster","            elif mapped_phrase is not None and mapped_phrase != '''':","                cluster = mapped_phrase","            elif lda_cluster is not None and lda_cluster != '''':","                cluster = lda_cluster","            return cluster","        udfGetCluster = udf(getCluster, StringType())","        dataset.show()","        dataset = dataset.withColumn(''post_ranking_cluster'', udfGetCluster(''tags'',''ngram'',''soundex_cluster'',''lda_cluster'',''mapped_phrase''))","        dataset = dataset.withColumn(''last_updated'', lit(datetime.now()))","        dataset.show()","        dataset = dataset.select(''number'',''ngram'',''soundex_cluster'',''lda_cluster'',''mapped_phrase'',''last_updated'',''post_ranking_cluster'')","        return dataset"]},"position_x":"650","position_y":"160","connectors":[{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"rOEhB","elementPosition":"LeftMiddle"},{"type":"target","endpoint":"in","position":"LeftMiddle","elementId":"nUpLq","elementPosition":"RightMiddle"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"script":"textarea"},"context":[{"params":"","script":["import logging as logger","from pyspark.sql.functions import *","from pyspark.sql.types import *","class CustomPythonClass():","    def __main__(self, dataset1, dataset2, dataset3):","        dataset = dataset1.join(dataset2 , [''number''], how=''left'')","        dataset = dataset.join(dataset3, [''number''], how=''left'')","        ","        return dataset"]},{"dataset":{"alias":"Clusters","name":"LPD29OS8SS","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":null,"type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT cast(t.number as char) AS number, tags AS tags, ng.ngram, sound.soundex_cluster FROM @projectname_tickets t LEFT\nJOIN @projectname_ngram ng ON t.number=cast(ng.number as char) LEFT JOIN @projectname_soundex sound ON t.number=cast(sound.number as char)","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"backingDataset":"","organization":"leo1311","groups":""},"isValidation":"","samplingRatio":"","applySchema":false},{"dataset":{"alias":"LDA Clusters","name":"263RBVB8BD","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":null,"type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT t.number, ldatopics.alias AS lda_cluster FROM @projectname_tickets_enriched t LEFT JOIN @projectname_lda lda on t.number=cast(lda.number as char) LEFT JOIN @projectname_clustering_topics ldatopics ON lda.lda_cluster = ldatopics.words","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"backingDataset":"","organization":"leo1311","groups":""},"isValidation":"","samplingRatio":"","applySchema":false},{"dataset":{"alias":"Phrase Extraction","name":"DYV83OFE7R","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT cast(t.number as char) as number, case when cast(cast(pe.mapped_phrase_confidennce as char) as float) > 0.4 THEN  pe.extracted_phrase ELSE '''' END as  mapped_phrase FROM @projectname_tickets_enriched t left join @projectname_phrase_extraction pe on t.number = cast(pe.number as char)","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"groups":"","backingDataset":""},"isValidation":"","samplingRatio":"","applySchema":false}]},{"id":"rOEhB","alias":"Dataset  Loader","name":"Dataset  Loader","classname":"DatasetLoaderConfig","category":"LoaderConfig","attributes":{"dataset":{"alias":"Prioritized Cluster","name":"VWT0JK2U1N","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":null,"type":"r","attributes":{"filter":"","mode":"query","Query":"Select number , ngram, soundex_cluster, lda_cluster, mapped_phrase, last_updated, post_ranking_cluster from @projectname_tickets_enriched","isStreaming":"false","defaultValues":"","writeMode":"update","params":"{}","tableName":"@projectname_tickets_enriched","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"backingDataset":"","organization":"leo1311","groups":""},"applySchema":false},"position_x":"900","position_y":"160","connectors":[{"type":"target","endpoint":"in","position":"LeftMiddle","elementId":"mNtFe","elementPosition":"RightMiddle"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"dataset":"dropdown","applySchema":"checkbox"},"context":[{"script":["import logging","from datetime import datetime","from pyspark.sql.functions import *","from pyspark.sql.types import *","class CustomPythonClass():","    def __main__(self, dataset):","        def getCluster(tags,ngram,soundex_cluster, lda_cluster,mapped_phrase  ):","            cluster = ''''","            if tags is not None and tags != '''':","                cluster = tags","            elif ngram is not None and ngram != '''':","                cluster = ngram","            elif soundex_cluster is not None and soundex_cluster != '''':","                cluster = soundex_cluster","            elif mapped_phrase is not None and mapped_phrase != '''':","                cluster = mapped_phrase","            elif lda_cluster is not None and lda_cluster != '''':","                cluster = lda_cluster","            return cluster","        udfGetCluster = udf(getCluster, StringType())","        dataset.show()","        dataset = dataset.withColumn(''post_ranking_cluster'', udfGetCluster(''tags'',''ngram'',''soundex_cluster'',''lda_cluster'',''mapped_phrase''))","        dataset = dataset.withColumn(''last_updated'', lit(datetime.now()))","        dataset.show()","        dataset = dataset.select(''number'',''ngram'',''soundex_cluster'',''lda_cluster'',''mapped_phrase'',''last_updated'',''post_ranking_cluster'')","        return dataset"]},{"params":"","script":["import logging as logger","from pyspark.sql.functions import *","from pyspark.sql.types import *","class CustomPythonClass():","    def __main__(self, dataset1, dataset2, dataset3):","        dataset = dataset1.join(dataset2 , [''number''], how=''left'')","        dataset = dataset.join(dataset3, [''number''], how=''left'')","        ","        return dataset"]},{"dataset":{"alias":"Clusters","name":"LPD29OS8SS","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":null,"type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT cast(t.number as char) AS number, tags AS tags, ng.ngram, sound.soundex_cluster FROM @projectname_tickets t LEFT\nJOIN @projectname_ngram ng ON t.number=cast(ng.number as char) LEFT JOIN @projectname_soundex sound ON t.number=cast(sound.number as char)","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"backingDataset":"","organization":"leo1311","groups":""},"isValidation":"","samplingRatio":"","applySchema":false},{"dataset":{"alias":"LDA Clusters","name":"263RBVB8BD","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":null,"type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT t.number, ldatopics.alias AS lda_cluster FROM @projectname_tickets_enriched t LEFT JOIN @projectname_lda lda on t.number=cast(lda.number as char) LEFT JOIN @projectname_clustering_topics ldatopics ON lda.lda_cluster = ldatopics.words","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"backingDataset":"","organization":"leo1311","groups":""},"isValidation":"","samplingRatio":"","applySchema":false},{"dataset":{"alias":"Phrase Extraction","name":"DYV83OFE7R","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT cast(t.number as char) as number, case when cast(cast(pe.mapped_phrase_confidennce as char) as float) > 0.4 THEN  pe.extracted_phrase ELSE '''' END as  mapped_phrase FROM @projectname_tickets_enriched t left join @projectname_phrase_extraction pe on t.number = cast(pe.number as char)","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"groups":"","backingDataset":""},"isValidation":"","samplingRatio":"","applySchema":false}]},{"id":"RADSx","alias":"Dataset  Extractor","name":"Dataset  Extractor","classname":"DatasetExtractorConfig","category":"ExtractorConfig","attributes":{"dataset":{"alias":"LDA Clusters","name":"263RBVB8BD","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":null,"type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT t.number, ldatopics.alias AS lda_cluster FROM @projectname_tickets_enriched t LEFT JOIN @projectname_lda lda on t.number=cast(lda.number as char) LEFT JOIN @projectname_clustering_topics ldatopics ON lda.lda_cluster = ldatopics.words","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"backingDataset":"","organization":"leo1311","groups":""},"isValidation":"","samplingRatio":"","applySchema":false},"position_x":"170","position_y":"30","connectors":[{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"nUpLq","elementPosition":"TopCenter"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"dataset":"dropdown","isValidation":"checkbox","samplingRatio":"text","applySchema":"checkbox"},"context":[]},{"id":"zJRXl","alias":"Dataset  Extractor","name":"Dataset  Extractor","classname":"DatasetExtractorConfig","category":"ExtractorConfig","attributes":{"dataset":{"alias":"Phrase Extraction","name":"DYV83OFE7R","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT cast(t.number as char) as number, case when cast(cast(pe.mapped_phrase_confidennce as char) as float) > 0.4 THEN  pe.extracted_phrase ELSE '''' END as  mapped_phrase FROM @projectname_tickets_enriched t left join @projectname_phrase_extraction pe on t.number = cast(pe.number as char)","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"groups":"","backingDataset":""},"isValidation":"","samplingRatio":"","applySchema":false},"position_x":"170","position_y":"300","connectors":[{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"nUpLq","elementPosition":"BottomCenter"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"dataset":"dropdown","isValidation":"checkbox","samplingRatio":"text","applySchema":"checkbox"},"context":[]},{"id":"nUpLq","alias":"Pre  Processing  Script","name":"Pre  Processing  Script","classname":"PreProcessingScriptConfig","category":"BaseConfig","attributes":{"params":"","script":["import logging as logger","from pyspark.sql.functions import *","from pyspark.sql.types import *","class CustomPythonClass():","    def __main__(self, dataset1, dataset2, dataset3):","        dataset = dataset1.join(dataset2 , [''number''], how=''left'')","        dataset = dataset.join(dataset3, [''number''], how=''left'')","        ","        return dataset"]},"position_x":"410","position_y":"160","connectors":[{"type":"target","endpoint":"dataset1","position":"LeftMiddle","elementId":"WZFCq","elementPosition":"RightMiddle"},{"type":"target","endpoint":"dataset2","position":"TopCenter","elementId":"RADSx","elementPosition":"RightMiddle"},{"type":"target","endpoint":"dataset3","position":"BottomCenter","elementId":"zJRXl","elementPosition":"RightMiddle"},{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"mNtFe","elementPosition":"LeftMiddle"}],"inputEndpoints":["dataset1","dataset2","dataset3"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"params":"textarea","script":"textarea"},"context":[{"dataset":{"alias":"Clusters","name":"LPD29OS8SS","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":null,"type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT cast(t.number as char) AS number, tags AS tags, ng.ngram, sound.soundex_cluster FROM @projectname_tickets t LEFT\nJOIN @projectname_ngram ng ON t.number=cast(ng.number as char) LEFT JOIN @projectname_soundex sound ON t.number=cast(sound.number as char)","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"backingDataset":"","organization":"leo1311","groups":""},"isValidation":"","samplingRatio":"","applySchema":false},{"dataset":{"alias":"LDA Clusters","name":"263RBVB8BD","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":null,"type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT t.number, ldatopics.alias AS lda_cluster FROM @projectname_tickets_enriched t LEFT JOIN @projectname_lda lda on t.number=cast(lda.number as char) LEFT JOIN @projectname_clustering_topics ldatopics ON lda.lda_cluster = ldatopics.words","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"backingDataset":"","organization":"leo1311","groups":""},"isValidation":"","samplingRatio":"","applySchema":false},{"dataset":{"alias":"Phrase Extraction","name":"DYV83OFE7R","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"SELECT cast(t.number as char) as number, case when cast(cast(pe.mapped_phrase_confidennce as char) as float) > 0.4 THEN  pe.extracted_phrase ELSE '''' END as  mapped_phrase FROM @projectname_tickets_enriched t left join @projectname_phrase_extraction pe on t.number = cast(pe.number as char)","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"groups":"","backingDataset":""},"isValidation":"","samplingRatio":"","applySchema":false}]}]}' WHERE name='ACMCLSTR52976' AND organization='leo1311';
			UPDATE mlpipeline SET json_content='{"elements":[{"id":"uNaPq","alias":"Dataset  Extractor","name":"Dataset  Extractor","classname":"DatasetExtractorConfig","category":"ExtractorConfig","attributes":{"dataset":{"alias":"Input","name":"","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"Select number, CAST(clean_text as CHAR) as clean_text from @projectname_tickets_enriched where clean_text is not null and clean_text != '''' ","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":""},"expStatus":0,"groups":"","backingDataset":""}},"position_x":"180","position_y":"110","connectors":[{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"uOOHr","elementPosition":"LeftMiddle"}],"inputEndpoints":[],"outputEndpoints":["out"],"requiredJars":[],"formats":{"dataset":"dropdown"},"context":[]},{"id":"uOOHr","alias":"Python  Script  Transformer","name":"Python  Script  Transformer","classname":"PythonScriptTransformerConfig","category":"TransformerConfig","attributes":{"script":["import logging","from sklearn.feature_extraction.text import CountVectorizer, TfidfVectorizer","import pandas as pd","import numpy as np","from datetime import datetime","class CustomPythonClass():","    def __main__(self, dataset):","        txt1 =[]","        for row in dataset:","            txt1.append(row[''clean_text''])","        logging.info(''Generating NGrams'')","        # Getting trigrams ","        vectorizer = CountVectorizer(ngram_range = (3,3))","        X1 = vectorizer.fit_transform(txt1) ","        features = (vectorizer.get_feature_names())","        # Applying TFIDF","        vectorizer = TfidfVectorizer(ngram_range = (3,3))","        X2 = vectorizer.fit_transform(txt1)","        scores = (X2.toarray())","        # Getting top ranking features","        logging.info(''Getting Top 50 Grams'')","        sums = X2.sum(axis = 0)","        data1 = []","        for col, term in enumerate(features):","            data1.append( (term, sums[0,col] ))","        ranking = pd.DataFrame(data1, columns = [''term'',''rank''])","        words = (ranking.sort_values(''rank'', ascending = False))","        top50df = words.nlargest(50,''rank'')","        top50 = words[''term''].tolist()","       ","        distinctText = list(set(txt1))","        count=0","        totalRecords = len(distinctText)","        logging.info(''Mapping Text to Gram'')","        logging.info(''Total Unique Values: {0}''.format(totalRecords))","        ngramDict = {}","        for item in distinctText:","            matchingGrams = [gram for gram in top50 if gram in item]","            if len(matchingGrams) >0:","                ngramDict[item] = matchingGrams[0]","            count = count+1","            if count%1000 ==0:","                logging.info(''{0} rows mapped''.format(count))","    ","        logging.info(''Mapping Tickets'')","        ","        for row in dataset:","            row[''ngram''] = ngramDict.get(row[''clean_text''],'''')","        return dataset"]},"position_x":"510","position_y":"100","connectors":[{"type":"target","endpoint":"in1","position":"LeftMiddle","elementId":"uNaPq","elementPosition":"RightMiddle"},{"type":"source","endpoint":"out1","position":"RightMiddle","elementId":"LLDFc","elementPosition":"LeftMiddle"}],"inputEndpoints":["in1","in2"],"outputEndpoints":["out1","out2"],"requiredJars":[],"formats":{"script":"textarea"},"context":[{"dataset":{"alias":"Input","name":"","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"Select number, CAST(clean_text as CHAR) as clean_text from @projectname_tickets_enriched where clean_text is not null and clean_text != '''' ","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":""},"expStatus":0,"groups":"","backingDataset":""}}]},{"id":"LLDFc","alias":"Dataset  Loader","name":"Dataset  Loader","classname":"DatasetLoaderConfig","category":"LoaderConfig","attributes":{"dataset":{"alias":"ngramout","name":"OL3XLSBIY5","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"Select number, ngram from @projectname_ngram","isStreaming":"false","defaultValues":"","writeMode":"overwrite","params":"{}","tableName":"@projectname_ngram","uniqueIdentifier":""},"expStatus":0,"groups":"","backingDataset":""}},"position_x":"820","position_y":"100","connectors":[{"type":"target","endpoint":"in","position":"LeftMiddle","elementId":"uOOHr","elementPosition":"RightMiddle"}],"inputEndpoints":["in"],"outputEndpoints":[],"requiredJars":[],"formats":{"dataset":"dropdown"},"context":[{"script":["import logging","from sklearn.feature_extraction.text import CountVectorizer, TfidfVectorizer","import pandas as pd","import numpy as np","from datetime import datetime","class CustomPythonClass():","    def __main__(self, dataset):","        txt1 =[]","        for row in dataset:","            txt1.append(row[''clean_text''])","        logging.info(''Generating NGrams'')","        # Getting trigrams ","        vectorizer = CountVectorizer(ngram_range = (3,3))","        X1 = vectorizer.fit_transform(txt1) ","        features = (vectorizer.get_feature_names())","        # Applying TFIDF","        vectorizer = TfidfVectorizer(ngram_range = (3,3))","        X2 = vectorizer.fit_transform(txt1)","        scores = (X2.toarray())","        # Getting top ranking features","        logging.info(''Getting Top 50 Grams'')","        sums = X2.sum(axis = 0)","        data1 = []","        for col, term in enumerate(features):","            data1.append( (term, sums[0,col] ))","        ranking = pd.DataFrame(data1, columns = [''term'',''rank''])","        words = (ranking.sort_values(''rank'', ascending = False))","        top50df = words.nlargest(50,''rank'')","        top50 = words[''term''].tolist()","       ","        distinctText = list(set(txt1))","        count=0","        totalRecords = len(distinctText)","        logging.info(''Mapping Text to Gram'')","        logging.info(''Total Unique Values: {0}''.format(totalRecords))","        ngramDict = {}","        for item in distinctText:","            matchingGrams = [gram for gram in top50 if gram in item]","            if len(matchingGrams) >0:","                ngramDict[item] = matchingGrams[0]","            count = count+1","            if count%1000 ==0:","                logging.info(''{0} rows mapped''.format(count))","    ","        logging.info(''Mapping Tickets'')","        ","        for row in dataset:","            row[''ngram''] = ngramDict.get(row[''clean_text''],'''')","        return dataset"]},{"dataset":{"alias":"Input","name":"","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2022-01-05 08:24:14","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encxpbjYCrvyhMTUvIJ4b0hamGQAEc/5XW4IMs=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"pGUU58kw9H0rnHR0htxf5yNRvxhtriUaEk73Ref+D1g/yTqX0/YQYoQd/ksZNLKpTr5ESwCRBVOUy85ZmBeWzA==","organization":"leo1311","dshashcode":null,"activetime":"2022-01-05 08:24:14","category":"SQL"},"schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"Select number, CAST(clean_text as CHAR) as clean_text from @projectname_tickets_enriched where clean_text is not null and clean_text != '''' ","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":""},"expStatus":0,"groups":"","backingDataset":""}}]}]}' WHERE name='ACMNGRMN92761' AND organization='leo1311';
			UPDATE mldataset SET attributes='{"filter":"","mode":"query","Query":"SELECT EASE,COUNT(*) AS COUNT, ROUND((CAST(COUNT(*) AS FLOAT )/CAST((SELECT COUNT(*) FROM @projectname_tickets ) AS FLOAT))*100,2) AS [PERCENT] FROM @projectname_tickets_enriched te JOIN @projectname_EASEMapping map ON te.mapped_phrase =map.Key_Word  WHERE ease = {ease} GROUP BY ease","Cacheable":"false","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{''ease'':''ease''}","tableName":"","uniqueIdentifier":""}' WHERE name='ease_TotalTickets' AND organization='leo1311';
			UPDATE mldataset SET attributes='{"filter":"","mode":"query","Query":"SELECT mapped_phrase AS KEYWORD, COUNT(*) as COUNT, ROUND((CAST(COUNT(*) AS FLOAT )/CAST((SELECT COUNT(*) FROM @projectname_tickets ) AS FLOAT))*100,2) AS [PERCENT] FROM @projectname_tickets_enriched te JOIN @projectname_EASEMapping map ON te.mapped_phrase =map.Key_Word  WHERE  ease = {ease} GROUP BY mapped_phrase ORDER BY COUNT(*) DESC","Cacheable":"false","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{''ease'':''ease''}","tableName":"","uniqueIdentifier":""}' WHERE name='ease_distributionByKeyword' AND organization='leo1311';			
		</sql>			
	</changeSet>
	<changeSet author="Leap" id="1312v0-cip-366326">
		<sql dbms="mysql" splitStatements="true" stripComments="true">  
			UPDATE mlpipeline SET json_content='{\"elements\":[{\"id\":\"PiYva\",\"alias\":\"Tickets\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"id\":39032,\"name\":\"input\",\"alias\":\"input\",\"description\":\"Tickets with soundex of Short description\",\"schema\":null,\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, Soundex(clean_text) as sound, CASE WHEN group_by_field IS NULL THEN \'\' ELSE group_by_field END AS group_by_field FROM @projectname_tickets_enriched  WHERE clean_text is not null and  Soundex(clean_text) != \'\' and clean_text != \'\'\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MYSQL\",\"expStatus\":0,\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":false},\"position_x\":\"170\",\"position_y\":\"80\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"CSUzm\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"CSUzm\",\"alias\":\"Create Clusters\",\"name\":\"Python  Script  Transformer\",\"classname\":\"PythonScriptTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"script\":[\"import logging\\r\",\"from datetime import datetime\\r\",\"from pyspark.sql.types import *\\r\",\"from pyspark.sql.functions import *\\r\",\"import re\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        soundDf = dataset.groupBy(\'group_by_field\',\'sound\').agg(collect_list(\'number\').alias(\'numberList\'), collect_list(\'clean_text\').alias(\'text_list\'))\\r\",\"\\r\",\"       \\r\",\"        soundDf = soundDf.withColumn(\'numberListSize\', size(\'numberList\'))\\r\",\"        soundDf = soundDf.filter(soundDf[\'numberListSize\']>=5)\\r\",\"        soundDf = soundDf.withColumn(\'cluster\' , soundDf[\'text_list\'].getItem(0)).drop(\'text_list\')\\r\",\"        \\r\",\"        soundDf = soundDf.select(\'group_by_field\', \'cluster\', \'numberList\',\'sound\')\\r\",\"        soundDf = soundDf.withColumn(\'number\',explode(\'numberList\')).drop(\'numberList\')\\r\",\"        soundDf = soundDf.withColumn(\'last_updated\',lit(datetime.now()))\\r\",\"\\r\",\"        soundDf = soundDf.select(\'number\',col(\'cluster\').alias(\'soundex_cluster\'),\'last_updated\')\\r\",\"\\r\",\"        \\r\",\"        soundDf = soundDf.repartition(50)\\r\",\"        return soundDf\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},\"position_x\":\"460\",\"position_y\":\"80\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"PiYva\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"MNpqZ\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"script\":\"textarea\"},\"context\":[{\"dataset\":{\"id\":39032,\"name\":\"input\",\"alias\":\"input\",\"description\":\"Tickets with soundex of Short description\",\"schema\":null,\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, Soundex(clean_text) as sound, CASE WHEN group_by_field IS NULL THEN \'\' ELSE group_by_field END AS group_by_field FROM @projectname_tickets_enriched  WHERE clean_text is not null and  Soundex(clean_text) != \'\' and clean_text != \'\'\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MYSQL\",\"expStatus\":0,\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":false}]},{\"id\":\"MNpqZ\",\"alias\":\"Clusters\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"id\":39032,\"name\":\"DJR9U1LGA5\",\"alias\":\"Cluster\",\"description\":\"Tickets with soundex of Short description\",\"schema\":null,\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"Select  number , soundex_cluster, last_updated from @projectname_soundex\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"overwrite\",\"params\":\"{}\",\"tableName\":\"@projectname_soundex\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"rw\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MYSQL\",\"groups\":[],\"expStatus\":0,\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"}},\"applySchema\":false},\"position_x\":\"770\",\"position_y\":\"80\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"CSUzm\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"applySchema\":\"checkbox\"},\"context\":[{\"script\":[\"import logging\\r\",\"from datetime import datetime\\r\",\"from pyspark.sql.types import *\\r\",\"from pyspark.sql.functions import *\\r\",\"import re\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        soundDf = dataset.groupBy(\'group_by_field\',\'sound\').agg(collect_list(\'number\').alias(\'numberList\'), collect_list(\'clean_text\').alias(\'text_list\'))\\r\",\"\\r\",\"       \\r\",\"        soundDf = soundDf.withColumn(\'numberListSize\', size(\'numberList\'))\\r\",\"        soundDf = soundDf.filter(soundDf[\'numberListSize\']>=5)\\r\",\"        soundDf = soundDf.withColumn(\'cluster\' , soundDf[\'text_list\'].getItem(0)).drop(\'text_list\')\\r\",\"        \\r\",\"        soundDf = soundDf.select(\'group_by_field\', \'cluster\', \'numberList\',\'sound\')\\r\",\"        soundDf = soundDf.withColumn(\'number\',explode(\'numberList\')).drop(\'numberList\')\\r\",\"        soundDf = soundDf.withColumn(\'last_updated\',lit(datetime.now()))\\r\",\"\\r\",\"        soundDf = soundDf.select(\'number\',col(\'cluster\').alias(\'soundex_cluster\'),\'last_updated\')\\r\",\"\\r\",\"        \\r\",\"        soundDf = soundDf.repartition(50)\\r\",\"        return soundDf\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},{\"dataset\":{\"id\":39032,\"name\":\"input\",\"alias\":\"input\",\"description\":\"Tickets with soundex of Short description\",\"schema\":null,\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, Soundex(clean_text) as sound, CASE WHEN group_by_field IS NULL THEN \'\' ELSE group_by_field END AS group_by_field FROM @projectname_tickets_enriched  WHERE clean_text is not null and  Soundex(clean_text) != \'\' and clean_text != \'\'\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MYSQL\",\"expStatus\":0,\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":false}]}]}' WHERE name='ACMCLSTR99942' AND organization='leo1311';
			UPDATE mlpipeline SET json_content='{\"elements\":[{\"id\":\"OxxDW\",\"alias\":\"Filter Dataset\",\"name\":\"Pre  Processing  Script\",\"classname\":\"PreProcessingScriptConfig\",\"category\":\"BaseConfig\",\"attributes\":{\"params\":\"{}\",\"script\":[\"import logging as logger\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        data = dataset.withColumn(\'cluster_Type\',lit(\'LDA\'))\\r\",\"        filteredCIs = data.groupBy(\'group_by_field\').count().filter((col(\'count\') >=50) ).select(\'group_by_field\')\\r\",\"        ciList= filteredCIs.rdd.map(lambda r: r[0]).collect()\\r\",\"        if ciList is not None and len(ciList) ==0:\\r\",\"            logger.info(\'No data for clustering\')\\r\",\"            logger.info(\'Completed\')\\r\",\"            print(\'Completed\')\\r\",\"            exit()\\r\",\"        filtereddf = data.filter(col(\'group_by_field\').isin(ciList))\\r\",\"        return filtereddf\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},\"position_x\":\"340\",\"position_y\":\"100\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"sXmyX\",\"elementPosition\":\"LeftMiddle\"},{\"type\":\"target\",\"endpoint\":\"dataset1\",\"position\":\"LeftMiddle\",\"elementId\":\"LREJS\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"dataset1\",\"dataset2\",\"dataset3\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"params\":\"textarea\",\"script\":\"textarea\"},\"context\":[{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"Tickets for LDA Clustering\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-05-25 07:58:24\",\"alias\":\"LDA Cluster\",\"id\":7,\"name\":\"ACMLDCLS54038\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"clean_text\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"group_by_field\\\",\\\"recordcolumndisplayname\\\":\\\"group_by_field\\\"}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, CASE WHEN group_by_field IS NULL THEN \'\' ELSE group_by_field END AS group_by_field  FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != \'\'\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"IUlqx\",\"alias\":\"Post  Processing  Script\",\"name\":\"Post  Processing  Script\",\"classname\":\"PostProcessingScriptConfig\",\"category\":\"BaseConfig\",\"attributes\":{\"params\":\"\",\"script\":[\"import logging\\r\",\"from pyspark.sql.types import *\\r\",\"from pyspark.sql.functions import *\\r\",\"from datetime import datetime\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self,model, dataset):\\r\",\"        dataset = dataset[\'out\']\\r\",\"        dataset = dataset.select(\'number\',col(\'cluster_name\').alias(\'lda_cluster\') )\\r\",\"        dataset = dataset.withColumn(\'last_updated\',lit(datetime.now()))\\r\",\"        dataset = dataset.repartition(200)\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},\"position_x\":\"720\",\"position_y\":\"240\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"XJUTb\",\"elementPosition\":\"LeftMiddle\"},{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"sXmyX\",\"elementPosition\":\"BottomCenter\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\",\"out2\"],\"requiredJars\":[],\"formats\":{\"params\":\"textarea\",\"script\":\"textarea\"},\"context\":[{\"UniqueIdColumn\":\"number\",\"GroupByColumn\":\"group_by_field\",\"TextColumn\":\"clean_text\",\"customStopWords\":\"\",\"vocabSize\":\"10000\",\"ClusterCount\":\"10\",\"checkPointInterval\":\"10\",\"saveModels\":\"\"},{\"params\":\"{}\",\"script\":[\"import logging as logger\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        data = dataset.withColumn(\'cluster_Type\',lit(\'LDA\'))\\r\",\"        filteredCIs = data.groupBy(\'group_by_field\').count().filter((col(\'count\') >=50) ).select(\'group_by_field\')\\r\",\"        ciList= filteredCIs.rdd.map(lambda r: r[0]).collect()\\r\",\"        if ciList is not None and len(ciList) ==0:\\r\",\"            logger.info(\'No data for clustering\')\\r\",\"            logger.info(\'Completed\')\\r\",\"            print(\'Completed\')\\r\",\"            exit()\\r\",\"        filtereddf = data.filter(col(\'group_by_field\').isin(ciList))\\r\",\"        return filtereddf\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"Tickets for LDA Clustering\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-05-25 07:58:24\",\"alias\":\"LDA Cluster\",\"id\":7,\"name\":\"ACMLDCLS54038\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"clean_text\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"group_by_field\\\",\\\"recordcolumndisplayname\\\":\\\"group_by_field\\\"}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, CASE WHEN group_by_field IS NULL THEN \'\' ELSE group_by_field END AS group_by_field  FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != \'\'\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"hPWgu\",\"alias\":\"Dataset  Loader\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Topics\",\"name\":\"\",\"description\":\"Clustering topics vocab\",\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"Select * from @projectname_clustering_topics\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"overwrite\",\"params\":\"{}\",\"tableName\":\"@projectname_clustering_topics\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":[],\"backingDataset\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"}},\"applySchema\":false},\"position_x\":\"840\",\"position_y\":\"100\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"sXmyX\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"applySchema\":\"checkbox\"},\"context\":[{\"UniqueIdColumn\":\"number\",\"GroupByColumn\":\"group_by_field\",\"TextColumn\":\"clean_text\",\"customStopWords\":\"\",\"vocabSize\":\"10000\",\"ClusterCount\":\"10\",\"checkPointInterval\":\"10\",\"saveModels\":\"\"},{\"params\":\"{}\",\"script\":[\"import logging as logger\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        data = dataset.withColumn(\'cluster_Type\',lit(\'LDA\'))\\r\",\"        filteredCIs = data.groupBy(\'group_by_field\').count().filter((col(\'count\') >=50) ).select(\'group_by_field\')\\r\",\"        ciList= filteredCIs.rdd.map(lambda r: r[0]).collect()\\r\",\"        if ciList is not None and len(ciList) ==0:\\r\",\"            logger.info(\'No data for clustering\')\\r\",\"            logger.info(\'Completed\')\\r\",\"            print(\'Completed\')\\r\",\"            exit()\\r\",\"        filtereddf = data.filter(col(\'group_by_field\').isin(ciList))\\r\",\"        return filtereddf\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"Tickets for LDA Clustering\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-05-25 07:58:24\",\"alias\":\"LDA Cluster\",\"id\":7,\"name\":\"ACMLDCLS54038\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"clean_text\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"group_by_field\\\",\\\"recordcolumndisplayname\\\":\\\"group_by_field\\\"}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, CASE WHEN group_by_field IS NULL THEN \'\' ELSE group_by_field END AS group_by_field  FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != \'\'\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"XJUTb\",\"alias\":\"Dataset  Loader\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Clusters\",\"name\":\"KBJUD4APBG\",\"description\":\"LDA clusters\",\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT  number , lda_cluster,lda_cluster_confidence, last_updated  from  @projectname_lda\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"overwrite\",\"params\":\"{}\",\"tableName\":\"@projectname_lda\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"}},\"applySchema\":false},\"position_x\":\"950\",\"position_y\":\"240\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"IUlqx\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"applySchema\":\"checkbox\"},\"context\":[{\"params\":\"\",\"script\":[\"import logging\\r\",\"from pyspark.sql.types import *\\r\",\"from pyspark.sql.functions import *\\r\",\"from datetime import datetime\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self,model, dataset):\\r\",\"        dataset = dataset[\'out\']\\r\",\"        dataset = dataset.select(\'number\',col(\'cluster_name\').alias(\'lda_cluster\') )\\r\",\"        dataset = dataset.withColumn(\'last_updated\',lit(datetime.now()))\\r\",\"        dataset = dataset.repartition(200)\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},{\"UniqueIdColumn\":\"number\",\"GroupByColumn\":\"group_by_field\",\"TextColumn\":\"clean_text\",\"customStopWords\":\"\",\"vocabSize\":\"10000\",\"ClusterCount\":\"10\",\"checkPointInterval\":\"10\",\"saveModels\":\"\"},{\"params\":\"{}\",\"script\":[\"import logging as logger\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        data = dataset.withColumn(\'cluster_Type\',lit(\'LDA\'))\\r\",\"        filteredCIs = data.groupBy(\'group_by_field\').count().filter((col(\'count\') >=50) ).select(\'group_by_field\')\\r\",\"        ciList= filteredCIs.rdd.map(lambda r: r[0]).collect()\\r\",\"        if ciList is not None and len(ciList) ==0:\\r\",\"            logger.info(\'No data for clustering\')\\r\",\"            logger.info(\'Completed\')\\r\",\"            print(\'Completed\')\\r\",\"            exit()\\r\",\"        filtereddf = data.filter(col(\'group_by_field\').isin(ciList))\\r\",\"        return filtereddf\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"Tickets for LDA Clustering\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-05-25 07:58:24\",\"alias\":\"LDA Cluster\",\"id\":7,\"name\":\"ACMLDCLS54038\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"clean_text\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"group_by_field\\\",\\\"recordcolumndisplayname\\\":\\\"group_by_field\\\"}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, CASE WHEN group_by_field IS NULL THEN \'\' ELSE group_by_field END AS group_by_field  FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != \'\'\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"LREJS\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"Tickets for LDA Clustering\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-05-25 07:58:24\",\"alias\":\"LDA Cluster\",\"id\":7,\"name\":\"ACMLDCLS54038\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"clean_text\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"group_by_field\\\",\\\"recordcolumndisplayname\\\":\\\"group_by_field\\\"}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, CASE WHEN group_by_field IS NULL THEN \'\' ELSE group_by_field END AS group_by_field  FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != \'\'\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},\"position_x\":\"60\",\"position_y\":\"100\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"OxxDW\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"sXmyX\",\"alias\":\"Incident  Clustering\",\"name\":\"Incident  Clustering\",\"classname\":\"IncidentClusteringLDAConfig\",\"category\":\"DomainSolutionConfig\",\"attributes\":{\"UniqueIdColumn\":\"number\",\"GroupByColumn\":\"group_by_field\",\"TextColumn\":\"clean_text\",\"customStopWords\":\"\",\"vocabSize\":\"10000\",\"ClusterCount\":\"10\",\"checkPointInterval\":\"10\",\"saveModels\":\"\"},\"position_x\":\"590\",\"position_y\":\"100\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"OxxDW\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"topics\",\"position\":\"RightMiddle\",\"elementId\":\"hPWgu\",\"elementPosition\":\"LeftMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"BottomCenter\",\"elementId\":\"IUlqx\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"topics\",\"out\"],\"requiredJars\":[],\"formats\":{\"UniqueIdColumn\":\"text\",\"GroupByColumn\":\"text\",\"TextColumn\":\"text\",\"customStopWords\":\"text\",\"vocabSize\":\"text\",\"ClusterCount\":\"text\",\"checkPointInterval\":\"text\",\"saveModels\":\"checkbox\"},\"context\":[{\"params\":\"{}\",\"script\":[\"import logging as logger\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        data = dataset.withColumn(\'cluster_Type\',lit(\'LDA\'))\\r\",\"        filteredCIs = data.groupBy(\'group_by_field\').count().filter((col(\'count\') >=50) ).select(\'group_by_field\')\\r\",\"        ciList= filteredCIs.rdd.map(lambda r: r[0]).collect()\\r\",\"        if ciList is not None and len(ciList) ==0:\\r\",\"            logger.info(\'No data for clustering\')\\r\",\"            logger.info(\'Completed\')\\r\",\"            print(\'Completed\')\\r\",\"            exit()\\r\",\"        filtereddf = data.filter(col(\'group_by_field\').isin(ciList))\\r\",\"        return filtereddf\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"Tickets for LDA Clustering\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-05-25 07:58:24\",\"alias\":\"LDA Cluster\",\"id\":7,\"name\":\"ACMLDCLS54038\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"clean_text\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"group_by_field\\\",\\\"recordcolumndisplayname\\\":\\\"group_by_field\\\"}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, CASE WHEN group_by_field IS NULL THEN \'\' ELSE group_by_field END AS group_by_field  FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != \'\'\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"GuvzZ\",\"alias\":\"X Y Z_test\",\"name\":\"X Y Z_test\",\"classname\":\"XYZ_test\",\"category\":\"TransformerConfig\",\"attributes\":{\"arguments\":\"\",\"id\":\"\"},\"position_x\":\"340\",\"position_y\":\"200\",\"connectors\":[],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"arguments\":\"text\",\"id\":\"text\"}}]}' WHERE name='ACMCLSTR21224' AND organization='leo1311';
			UPDATE mlpipeline SET json_content='{\"elements\":[{\"id\":\"UEeVc\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"name\":\"ZK0CN34C9S\",\"alias\":\"Tickets\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != \'\'\",\"Cacheable\":\"\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"datasetType\":\"MYSQL\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"expStatus\":0,\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},\"position_x\":\"40\",\"position_y\":\"30\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"XQVmY\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"HYOWn\",\"alias\":\"Dataset  Loader\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"name\":\"RGQTFH97NN\",\"alias\":\"Phrases\",\"description\":\"Phrases\",\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select number, extracted_phrase, mapped_phrase, mapped_phrase_confidennce, last_updated from @projectname_phrase_extraction\",\"Cacheable\":\"\",\"isStreaming\":\"false\",\"writeMode\":\"overwrite\",\"params\":\"{}\",\"tableName\":\"@projectname_phrase_extraction\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"datasetType\":\"MYSQL\",\"groups\":\"\",\"backingDataset\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"}},\"applySchema\":false},\"position_x\":\"730\",\"position_y\":\"30\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"XQVmY\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"applySchema\":\"checkbox\"},\"context\":[{\"script\":[\"import logging\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"import spacy\\r\",\"import pytextrank\\r\",\"from datetime import datetime\\r\",\"from pyspark.sql import SparkSession\\r\",\"\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        spark = SparkSession.builder.getOrCreate()\\r\",\"        nlp = spacy.load(\'en_core_web_sm\')\\r\",\"        nlp.add_pipe(\'textrank\')\\r\",\"        nlp_broadcast = spark.sparkContext.broadcast(nlp)\\r\",\"\\r\",\"        def getPharase(text):\\r\",\"            doc = nlp_broadcast.value(text)\\r\",\"            phrase =\'\'\\r\",\"            if len(doc._.phrases)>0:\\r\",\"                for item in doc._.phrases:\\r\",\"                    withoutSpace = item.text.replace(\' \' ,\'\')\\r\",\"                    if not withoutSpace.isdigit() and len(item.text.split(\' \')) >1:\\r\",\"                        phrase = item.text\\r\",\"                        break\\r\",\"                return phrase\\r\",\"            else:\\r\",\"                return text\\r\",\"        \\r\",\"        udfPhrases = udf(getPharase,StringType())\\r\",\"        dataset.show()\\r\",\"        dataset = dataset.withColumn(\'extracted_phrase\',udfPhrases(\'clean_text\'))\\r\",\"        dataset = dataset.select(\'number\',\'extracted_phrase\')\\r\",\"        dataset = dataset.withColumn(\'mapped_phrase\',lit(\' \'))\\r\",\"        dataset = dataset.withColumn(\'mapped_phrase_confidennce\',lit(\' \'))\\r\",\"        dataset = dataset.withColumn(\'last_updated\',lit(datetime.now()))\\r\",\"        dataset.show()\\r\",\"\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"],\"outputCols\":\"text\"},{\"dataset\":{\"name\":\"ZK0CN34C9S\",\"alias\":\"Tickets\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != \'\'\",\"Cacheable\":\"\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"datasetType\":\"MYSQL\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"expStatus\":0,\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"XQVmY\",\"alias\":\"Phrase extraction\",\"name\":\"Python  Script  Transformer\",\"classname\":\"PythonScriptTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"script\":[\"import logging\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"import spacy\\r\",\"import pytextrank\\r\",\"from datetime import datetime\\r\",\"from pyspark.sql import SparkSession\\r\",\"\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        spark = SparkSession.builder.getOrCreate()\\r\",\"        nlp = spacy.load(\'en_core_web_sm\')\\r\",\"        nlp.add_pipe(\'textrank\')\\r\",\"        nlp_broadcast = spark.sparkContext.broadcast(nlp)\\r\",\"\\r\",\"        def getPharase(text):\\r\",\"            doc = nlp_broadcast.value(text)\\r\",\"            phrase =\'\'\\r\",\"            if len(doc._.phrases)>0:\\r\",\"                for item in doc._.phrases:\\r\",\"                    withoutSpace = item.text.replace(\' \' ,\'\')\\r\",\"                    if not withoutSpace.isdigit() and len(item.text.split(\' \')) >1:\\r\",\"                        phrase = item.text\\r\",\"                        break\\r\",\"                return phrase\\r\",\"            else:\\r\",\"                return text\\r\",\"        \\r\",\"        udfPhrases = udf(getPharase,StringType())\\r\",\"        dataset.show()\\r\",\"        dataset = dataset.withColumn(\'extracted_phrase\',udfPhrases(\'clean_text\'))\\r\",\"        dataset = dataset.select(\'number\',\'extracted_phrase\')\\r\",\"        dataset = dataset.withColumn(\'mapped_phrase\',lit(\' \'))\\r\",\"        dataset = dataset.withColumn(\'mapped_phrase_confidennce\',lit(\' \'))\\r\",\"        dataset = dataset.withColumn(\'last_updated\',lit(datetime.now()))\\r\",\"        dataset.show()\\r\",\"\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"],\"outputCols\":\"text\"},\"position_x\":\"330\",\"position_y\":\"30\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"UEeVc\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"HYOWn\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"script\":\"textarea\",\"outputCols\":\"text\"},\"context\":[{\"dataset\":{\"name\":\"ZK0CN34C9S\",\"alias\":\"Tickets\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != \'\'\",\"Cacheable\":\"\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"datasetType\":\"MYSQL\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"expStatus\":0,\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]}]}' WHERE name='ACMPHRSX44652' AND organization='leo1311';
			UPDATE mlpipeline SET json_content='{\"elements\":[{\"id\":\"FqRsj\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Tickets\",\"name\":\"Tickets\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, CAST(clean_text as CHAR) as clean_text FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != \'\'  Order by Clean_text\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"}},\"position_x\":\"180\",\"position_y\":\"50\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"XlASA\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\"},\"context\":[]},{\"id\":\"XlASA\",\"alias\":\"Extract Phrases\",\"name\":\"Python  Script  Transformer\",\"classname\":\"PythonScriptTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"script\":[\"import logging\",\"import spacy\",\"import pytextrank\",\"from datetime import datetime\",\"class CustomPythonClass():\",\"    def __main__(self, dataset):\",\"        nlp = spacy.load(\'en_core_web_sm\')\",\"        nlp.add_pipe(\'textrank\')\",\"        timenow = datetime.now()\",\"        totalRecords = len(dataset)\",\"        logging.info(\'Fetched {0} records\'.format(totalRecords))\",\"        count =0\",\"        textPhraseMappings = {}\",\"        for row in dataset:\",\"            try:\",\"                text = row[\'clean_text\']\",\"                if textPhraseMappings.get(text,\'\') != \'\':\",\"                    row[\'extracted_phrase\'] = textPhraseMappings[text]\",\"                    break\",\"                doc = nlp(text)\",\"                phrase =\'\'\",\"                if len(doc._.phrases)>0:\",\"                    for item in doc._.phrases:\",\"                        withoutSpace = item.text.replace(\' \' ,\'\')\",\"                        if not withoutSpace.isdigit() and len(item.text.split(\' \')) >1:\",\"                            phrase = item.text\",\"                            break\",\"                if phrase != \'\':\",\"                    row[\'extracted_phrase\'] = phrase\",\"                else:\",\"                    row[\'extracted_phrase\'] = text\",\"            except Exception as ex:\",\"                logging.info(ex)\",\"                row[\'extracted_phrase\'] = text\",\"            row[\'last_updated\'] = timenow\",\"            row[\'mapped_phrase\'] = \'\'\",\"            row[\'mapped_phrase_confidennce\'] = \'\'\",\"            count = count+1\",\"            percentage = (count/totalRecords)*100 \",\"            if percentage%10 ==0:\",\"                logging.info(\'{0}% Completed\'.format(percentage))\",\"        \",\"        return dataset\"]},\"position_x\":\"440\",\"position_y\":\"50\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in1\",\"position\":\"LeftMiddle\",\"elementId\":\"FqRsj\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out1\",\"position\":\"RightMiddle\",\"elementId\":\"JdZtY\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in1\",\"in2\"],\"outputEndpoints\":[\"out1\",\"out2\"],\"requiredJars\":[],\"formats\":{\"script\":\"textarea\"},\"context\":[{\"dataset\":{\"alias\":\"Tickets\",\"name\":\"Tickets\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-07-27 10:51:41\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-07-27 10:51:41\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, CAST(clean_text as CHAR) as clean_text FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != \'\'  Order by Clean_text\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"}}]},{\"id\":\"JdZtY\",\"alias\":\"Dataset  Loader\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Phrases\",\"name\":\"TH2VXIBQRT\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select number, extracted_phrase, mapped_phrase, mapped_phrase_confidennce, last_updated from @projectname_phrase_extraction\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"overwrite\",\"params\":\"{}\",\"tableName\":\"@projectname_phrase_extraction\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"}},\"position_x\":\"740\",\"position_y\":\"50\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"XlASA\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\"},\"context\":[{\"script\":[\"import logging\",\"import spacy\",\"import pytextrank\",\"from datetime import datetime\",\"class CustomPythonClass():\",\"    def __main__(self, dataset):\",\"        nlp = spacy.load(\'en_core_web_sm\')\",\"        nlp.add_pipe(\'textrank\')\",\"        timenow = datetime.now()\",\"        totalRecords = len(dataset)\",\"        logging.info(\'Fetched {0} records\'.format(totalRecords))\",\"        count =0\",\"        textPhraseMappings = {}\",\"        for row in dataset:\",\"            try:\",\"                text = row[\'clean_text\']\",\"                if textPhraseMappings.get(text,\'\') != \'\':\",\"                    row[\'extracted_phrase\'] = textPhraseMappings[text]\",\"                    break\",\"                doc = nlp(text)\",\"                phrase =\'\'\",\"                if len(doc._.phrases)>0:\",\"                    for item in doc._.phrases:\",\"                        withoutSpace = item.text.replace(\' \' ,\'\')\",\"                        if not withoutSpace.isdigit() and len(item.text.split(\' \')) >1:\",\"                            phrase = item.text\",\"                            break\",\"                if phrase != \'\':\",\"                    row[\'extracted_phrase\'] = phrase\",\"                else:\",\"                    row[\'extracted_phrase\'] = text\",\"            except Exception as ex:\",\"                logging.info(ex)\",\"                row[\'extracted_phrase\'] = text\",\"            row[\'last_updated\'] = timenow\",\"            row[\'mapped_phrase\'] = \'\'\",\"            row[\'mapped_phrase_confidennce\'] = \'\'\",\"            count = count+1\",\"            percentage = (count/totalRecords)*100 \",\"            if percentage%10 ==0:\",\"                logging.info(\'{0}% Completed\'.format(percentage))\",\"        \",\"        return dataset\"]},{\"dataset\":{\"alias\":\"Tickets\",\"name\":\"Tickets\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-07-27 10:51:41\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-07-27 10:51:41\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, CAST(clean_text as CHAR) as clean_text FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != \'\'  Order by Clean_text\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"}}]}]}' WHERE name='ACMPHRSX57460' AND organization='leo1311';
			UPDATE mlpipeline SET json_content='{\"elements\":[{\"id\":\"WZFCq\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Clusters\",\"name\":\"LPD29OS8SS\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT cast(t.number as char) AS number, tags AS tags, ng.ngram, sound.soundex_cluster FROM @projectname_tickets t LEFT\\nJOIN @projectname_ngram ng ON t.number=cast(ng.number as char) LEFT JOIN @projectname_soundex sound ON t.number=cast(sound.number as char)\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},\"position_x\":\"170\",\"position_y\":\"160\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"nUpLq\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"mNtFe\",\"alias\":\"Python  Script  Transformer\",\"name\":\"Python  Script  Transformer\",\"classname\":\"PythonScriptTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"script\":[\"import logging\",\"from datetime import datetime\",\"from pyspark.sql.functions import *\",\"from pyspark.sql.types import *\",\"class CustomPythonClass():\",\"    def __main__(self, dataset):\",\"        def getCluster(tags,ngram,soundex_cluster, lda_cluster,mapped_phrase  ):\",\"            cluster = \'\'\",\"            if tags is not None and tags != \'\':\",\"                cluster = tags\",\"            elif ngram is not None and ngram != \'\':\",\"                cluster = ngram\",\"            elif soundex_cluster is not None and soundex_cluster != \'\':\",\"                cluster = soundex_cluster\",\"            elif mapped_phrase is not None and mapped_phrase != \'\':\",\"                cluster = mapped_phrase\",\"            elif lda_cluster is not None and lda_cluster != \'\':\",\"                cluster = lda_cluster\",\"            return cluster\",\"        udfGetCluster = udf(getCluster, StringType())\",\"        dataset.show()\",\"        dataset = dataset.withColumn(\'post_ranking_cluster\', udfGetCluster(\'tags\',\'ngram\',\'soundex_cluster\',\'lda_cluster\',\'mapped_phrase\'))\",\"        dataset = dataset.withColumn(\'last_updated\', lit(datetime.now()))\",\"        dataset.show()\",\"        dataset = dataset.select(\'number\',\'ngram\',\'soundex_cluster\',\'lda_cluster\',\'mapped_phrase\',\'last_updated\',\'post_ranking_cluster\')\",\"        return dataset\"]},\"position_x\":\"650\",\"position_y\":\"160\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"rOEhB\",\"elementPosition\":\"LeftMiddle\"},{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"nUpLq\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"script\":\"textarea\"},\"context\":[{\"params\":\"\",\"script\":[\"import logging as logger\",\"from pyspark.sql.functions import *\",\"from pyspark.sql.types import *\",\"class CustomPythonClass():\",\"    def __main__(self, dataset1, dataset2, dataset3):\",\"        dataset = dataset1.join(dataset2 , [\'number\'], how=\'left\')\",\"        dataset = dataset.join(dataset3, [\'number\'], how=\'left\')\",\"        \",\"        return dataset\"]},{\"dataset\":{\"alias\":\"Clusters\",\"name\":\"LPD29OS8SS\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT cast(t.number as char) AS number, tags AS tags, ng.ngram, sound.soundex_cluster FROM @projectname_tickets t LEFT\\nJOIN @projectname_ngram ng ON t.number=cast(ng.number as char) LEFT JOIN @projectname_soundex sound ON t.number=cast(sound.number as char)\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"LDA Clusters\",\"name\":\"263RBVB8BD\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT t.number, ldatopics.alias AS lda_cluster FROM @projectname_tickets_enriched t LEFT JOIN @projectname_lda lda on t.number=cast(lda.number as char) LEFT JOIN @projectname_clustering_topics ldatopics ON lda.lda_cluster = ldatopics.words\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"Phrase Extraction\",\"name\":\"DYV83OFE7R\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT cast(t.number as char) as number, case when cast(cast(pe.mapped_phrase_confidennce as char) as float) > 0.4 THEN  pe.extracted_phrase ELSE \'\' END as  mapped_phrase FROM @projectname_tickets_enriched t left join @projectname_phrase_extraction pe on t.number = cast(pe.number as char)\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"rOEhB\",\"alias\":\"Dataset  Loader\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Prioritized Cluster\",\"name\":\"VWT0JK2U1N\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"Select number , ngram, soundex_cluster, lda_cluster, mapped_phrase, last_updated, post_ranking_cluster from @projectname_tickets_enriched\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"update\",\"params\":\"{}\",\"tableName\":\"@projectname_tickets_enriched\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"applySchema\":false},\"position_x\":\"900\",\"position_y\":\"160\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"mNtFe\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"applySchema\":\"checkbox\"},\"context\":[{\"script\":[\"import logging\",\"from datetime import datetime\",\"from pyspark.sql.functions import *\",\"from pyspark.sql.types import *\",\"class CustomPythonClass():\",\"    def __main__(self, dataset):\",\"        def getCluster(tags,ngram,soundex_cluster, lda_cluster,mapped_phrase  ):\",\"            cluster = \'\'\",\"            if tags is not None and tags != \'\':\",\"                cluster = tags\",\"            elif ngram is not None and ngram != \'\':\",\"                cluster = ngram\",\"            elif soundex_cluster is not None and soundex_cluster != \'\':\",\"                cluster = soundex_cluster\",\"            elif mapped_phrase is not None and mapped_phrase != \'\':\",\"                cluster = mapped_phrase\",\"            elif lda_cluster is not None and lda_cluster != \'\':\",\"                cluster = lda_cluster\",\"            return cluster\",\"        udfGetCluster = udf(getCluster, StringType())\",\"        dataset.show()\",\"        dataset = dataset.withColumn(\'post_ranking_cluster\', udfGetCluster(\'tags\',\'ngram\',\'soundex_cluster\',\'lda_cluster\',\'mapped_phrase\'))\",\"        dataset = dataset.withColumn(\'last_updated\', lit(datetime.now()))\",\"        dataset.show()\",\"        dataset = dataset.select(\'number\',\'ngram\',\'soundex_cluster\',\'lda_cluster\',\'mapped_phrase\',\'last_updated\',\'post_ranking_cluster\')\",\"        return dataset\"]},{\"params\":\"\",\"script\":[\"import logging as logger\",\"from pyspark.sql.functions import *\",\"from pyspark.sql.types import *\",\"class CustomPythonClass():\",\"    def __main__(self, dataset1, dataset2, dataset3):\",\"        dataset = dataset1.join(dataset2 , [\'number\'], how=\'left\')\",\"        dataset = dataset.join(dataset3, [\'number\'], how=\'left\')\",\"        \",\"        return dataset\"]},{\"dataset\":{\"alias\":\"Clusters\",\"name\":\"LPD29OS8SS\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT cast(t.number as char) AS number, tags AS tags, ng.ngram, sound.soundex_cluster FROM @projectname_tickets t LEFT\\nJOIN @projectname_ngram ng ON t.number=cast(ng.number as char) LEFT JOIN @projectname_soundex sound ON t.number=cast(sound.number as char)\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"LDA Clusters\",\"name\":\"263RBVB8BD\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT t.number, ldatopics.alias AS lda_cluster FROM @projectname_tickets_enriched t LEFT JOIN @projectname_lda lda on t.number=cast(lda.number as char) LEFT JOIN @projectname_clustering_topics ldatopics ON lda.lda_cluster = ldatopics.words\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"Phrase Extraction\",\"name\":\"DYV83OFE7R\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT cast(t.number as char) as number, case when cast(cast(pe.mapped_phrase_confidennce as char) as float) > 0.4 THEN  pe.extracted_phrase ELSE \'\' END as  mapped_phrase FROM @projectname_tickets_enriched t left join @projectname_phrase_extraction pe on t.number = cast(pe.number as char)\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"RADSx\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"alias\":\"LDA Clusters\",\"name\":\"263RBVB8BD\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT t.number, ldatopics.alias AS lda_cluster FROM @projectname_tickets_enriched t LEFT JOIN @projectname_lda lda on t.number=cast(lda.number as char) LEFT JOIN @projectname_clustering_topics ldatopics ON lda.lda_cluster = ldatopics.words\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},\"position_x\":\"170\",\"position_y\":\"30\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"nUpLq\",\"elementPosition\":\"TopCenter\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"zJRXl\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Phrase Extraction\",\"name\":\"DYV83OFE7R\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT cast(t.number as char) as number, case when cast(cast(pe.mapped_phrase_confidennce as char) as float) > 0.4 THEN  pe.extracted_phrase ELSE \'\' END as  mapped_phrase FROM @projectname_tickets_enriched t left join @projectname_phrase_extraction pe on t.number = cast(pe.number as char)\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},\"position_x\":\"170\",\"position_y\":\"300\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"nUpLq\",\"elementPosition\":\"BottomCenter\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"nUpLq\",\"alias\":\"Pre  Processing  Script\",\"name\":\"Pre  Processing  Script\",\"classname\":\"PreProcessingScriptConfig\",\"category\":\"BaseConfig\",\"attributes\":{\"params\":\"\",\"script\":[\"import logging as logger\",\"from pyspark.sql.functions import *\",\"from pyspark.sql.types import *\",\"class CustomPythonClass():\",\"    def __main__(self, dataset1, dataset2, dataset3):\",\"        dataset = dataset1.join(dataset2 , [\'number\'], how=\'left\')\",\"        dataset = dataset.join(dataset3, [\'number\'], how=\'left\')\",\"        \",\"        return dataset\"]},\"position_x\":\"410\",\"position_y\":\"160\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"dataset1\",\"position\":\"LeftMiddle\",\"elementId\":\"WZFCq\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"target\",\"endpoint\":\"dataset2\",\"position\":\"TopCenter\",\"elementId\":\"RADSx\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"target\",\"endpoint\":\"dataset3\",\"position\":\"BottomCenter\",\"elementId\":\"zJRXl\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"mNtFe\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"dataset1\",\"dataset2\",\"dataset3\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"params\":\"textarea\",\"script\":\"textarea\"},\"context\":[{\"dataset\":{\"alias\":\"Clusters\",\"name\":\"LPD29OS8SS\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT cast(t.number as char) AS number, tags AS tags, ng.ngram, sound.soundex_cluster FROM @projectname_tickets t LEFT\\nJOIN @projectname_ngram ng ON t.number=cast(ng.number as char) LEFT JOIN @projectname_soundex sound ON t.number=cast(sound.number as char)\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"LDA Clusters\",\"name\":\"263RBVB8BD\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT t.number, ldatopics.alias AS lda_cluster FROM @projectname_tickets_enriched t LEFT JOIN @projectname_lda lda on t.number=cast(lda.number as char) LEFT JOIN @projectname_clustering_topics ldatopics ON lda.lda_cluster = ldatopics.words\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"Phrase Extraction\",\"name\":\"DYV83OFE7R\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT cast(t.number as char) as number, case when cast(cast(pe.mapped_phrase_confidennce as char) as float) > 0.4 THEN  pe.extracted_phrase ELSE \'\' END as  mapped_phrase FROM @projectname_tickets_enriched t left join @projectname_phrase_extraction pe on t.number = cast(pe.number as char)\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]}]}' WHERE name='ACMCLSTR52976' AND organization='leo1311';
			UPDATE mlpipeline SET json_content='{\"elements\":[{\"id\":\"uNaPq\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"Select number, CAST(clean_text as CHAR) as clean_text from @projectname_tickets_enriched where clean_text is not null and clean_text != \'\' \",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":[]}},\"position_x\":\"180\",\"position_y\":\"110\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"uOOHr\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\"},\"context\":[]},{\"id\":\"uOOHr\",\"alias\":\"Python  Script  Transformer\",\"name\":\"Python  Script  Transformer\",\"classname\":\"PythonScriptTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"script\":[\"import logging\",\"from sklearn.feature_extraction.text import CountVectorizer, TfidfVectorizer\",\"import pandas as pd\",\"import numpy as np\",\"from datetime import datetime\",\"class CustomPythonClass():\",\"    def __main__(self, dataset):\",\"        txt1 =[]\",\"        for row in dataset:\",\"            txt1.append(row[\'clean_text\'])\",\"        logging.info(\'Generating NGrams\')\",\"        # Getting trigrams \",\"        vectorizer = CountVectorizer(ngram_range = (3,3))\",\"        X1 = vectorizer.fit_transform(txt1) \",\"        features = (vectorizer.get_feature_names())\",\"        # Applying TFIDF\",\"        vectorizer = TfidfVectorizer(ngram_range = (3,3))\",\"        X2 = vectorizer.fit_transform(txt1)\",\"        scores = (X2.toarray())\",\"        # Getting top ranking features\",\"        logging.info(\'Getting Top 50 Grams\')\",\"        sums = X2.sum(axis = 0)\",\"        data1 = []\",\"        for col, term in enumerate(features):\",\"            data1.append( (term, sums[0,col] ))\",\"        ranking = pd.DataFrame(data1, columns = [\'term\',\'rank\'])\",\"        words = (ranking.sort_values(\'rank\', ascending = False))\",\"        top50df = words.nlargest(50,\'rank\')\",\"        top50 = words[\'term\'].tolist()\",\"       \",\"        distinctText = list(set(txt1))\",\"        count=0\",\"        totalRecords = len(distinctText)\",\"        logging.info(\'Mapping Text to Gram\')\",\"        logging.info(\'Total Unique Values: {0}\'.format(totalRecords))\",\"        ngramDict = {}\",\"        for item in distinctText:\",\"            matchingGrams = [gram for gram in top50 if gram in item]\",\"            if len(matchingGrams) >0:\",\"                ngramDict[item] = matchingGrams[0]\",\"            count = count+1\",\"            if count%1000 ==0:\",\"                logging.info(\'{0} rows mapped\'.format(count))\",\"    \",\"        logging.info(\'Mapping Tickets\')\",\"        \",\"        for row in dataset:\",\"            row[\'ngram\'] = ngramDict.get(row[\'clean_text\'],\'\')\",\"        return dataset\"]},\"position_x\":\"510\",\"position_y\":\"100\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in1\",\"position\":\"LeftMiddle\",\"elementId\":\"uNaPq\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out1\",\"position\":\"RightMiddle\",\"elementId\":\"LLDFc\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in1\",\"in2\"],\"outputEndpoints\":[\"out1\",\"out2\"],\"requiredJars\":[],\"formats\":{\"script\":\"textarea\"},\"context\":[{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"Select number, CAST(clean_text as CHAR) as clean_text from @projectname_tickets_enriched where clean_text is not null and clean_text != \'\' \",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":[]}}]},{\"id\":\"LLDFc\",\"alias\":\"Dataset  Loader\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"alias\":\"ngramout\",\"name\":\"OL3XLSBIY5\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"Select number, ngram from @projectname_ngram\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"overwrite\",\"params\":\"{}\",\"tableName\":\"@projectname_ngram\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":[],\"backingDataset\":\"\"}},\"position_x\":\"820\",\"position_y\":\"100\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"uOOHr\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\"},\"context\":[{\"script\":[\"import logging\",\"from sklearn.feature_extraction.text import CountVectorizer, TfidfVectorizer\",\"import pandas as pd\",\"import numpy as np\",\"from datetime import datetime\",\"class CustomPythonClass():\",\"    def __main__(self, dataset):\",\"        txt1 =[]\",\"        for row in dataset:\",\"            txt1.append(row[\'clean_text\'])\",\"        logging.info(\'Generating NGrams\')\",\"        # Getting trigrams \",\"        vectorizer = CountVectorizer(ngram_range = (3,3))\",\"        X1 = vectorizer.fit_transform(txt1) \",\"        features = (vectorizer.get_feature_names())\",\"        # Applying TFIDF\",\"        vectorizer = TfidfVectorizer(ngram_range = (3,3))\",\"        X2 = vectorizer.fit_transform(txt1)\",\"        scores = (X2.toarray())\",\"        # Getting top ranking features\",\"        logging.info(\'Getting Top 50 Grams\')\",\"        sums = X2.sum(axis = 0)\",\"        data1 = []\",\"        for col, term in enumerate(features):\",\"            data1.append( (term, sums[0,col] ))\",\"        ranking = pd.DataFrame(data1, columns = [\'term\',\'rank\'])\",\"        words = (ranking.sort_values(\'rank\', ascending = False))\",\"        top50df = words.nlargest(50,\'rank\')\",\"        top50 = words[\'term\'].tolist()\",\"       \",\"        distinctText = list(set(txt1))\",\"        count=0\",\"        totalRecords = len(distinctText)\",\"        logging.info(\'Mapping Text to Gram\')\",\"        logging.info(\'Total Unique Values: {0}\'.format(totalRecords))\",\"        ngramDict = {}\",\"        for item in distinctText:\",\"            matchingGrams = [gram for gram in top50 if gram in item]\",\"            if len(matchingGrams) >0:\",\"                ngramDict[item] = matchingGrams[0]\",\"            count = count+1\",\"            if count%1000 ==0:\",\"                logging.info(\'{0} rows mapped\'.format(count))\",\"    \",\"        logging.info(\'Mapping Tickets\')\",\"        \",\"        for row in dataset:\",\"            row[\'ngram\'] = ngramDict.get(row[\'clean_text\'],\'\')\",\"        return dataset\"]},{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"Select number, CAST(clean_text as CHAR) as clean_text from @projectname_tickets_enriched where clean_text is not null and clean_text != \'\' \",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":[]}}]}]}' WHERE name='ACMNGRMN92761' AND organization='leo1311';
		</sql>			
	</changeSet>
	
	 <changeSet author="Leap" id="1312v0-cip-postgres-366326">
		<sql dbms="postgresql" splitStatements="true" stripComments="true">  
            UPDATE core.mlpipeline SET json_content='{\"elements\":[{\"id\":\"PiYva\",\"alias\":\"Tickets\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"id\":39032,\"name\":\"input\",\"alias\":\"input\",\"description\":\"Tickets with soundex of Short description\",\"schema\":null,\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, Soundex(clean_text) as sound, CASE WHEN group_by_field IS NULL THEN \''\'' ELSE group_by_field END AS group_by_field FROM @projectname_tickets_enriched  WHERE clean_text is not null and  Soundex(clean_text) != \''\'' and clean_text != \''\''\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MYSQL\",\"expStatus\":0,\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":false},\"position_x\":\"170\",\"position_y\":\"80\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"CSUzm\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"CSUzm\",\"alias\":\"Create Clusters\",\"name\":\"Python  Script  Transformer\",\"classname\":\"PythonScriptTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"script\":[\"import logging\\r\",\"from datetime import datetime\\r\",\"from pyspark.sql.types import *\\r\",\"from pyspark.sql.functions import *\\r\",\"import re\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        soundDf = dataset.groupBy(\''group_by_field\'',\''sound\'').agg(collect_list(\''number\'').alias(\''numberList\''), collect_list(\''clean_text\'').alias(\''text_list\''))\\r\",\"\\r\",\"       \\r\",\"        soundDf = soundDf.withColumn(\''numberListSize\'', size(\''numberList\''))\\r\",\"        soundDf = soundDf.filter(soundDf[\''numberListSize\'']>=5)\\r\",\"        soundDf = soundDf.withColumn(\''cluster\'' , soundDf[\''text_list\''].getItem(0)).drop(\''text_list\'')\\r\",\"        \\r\",\"        soundDf = soundDf.select(\''group_by_field\'', \''cluster\'', \''numberList\'',\''sound\'')\\r\",\"        soundDf = soundDf.withColumn(\''number\'',explode(\''numberList\'')).drop(\''numberList\'')\\r\",\"        soundDf = soundDf.withColumn(\''last_updated\'',lit(datetime.now()))\\r\",\"\\r\",\"        soundDf = soundDf.select(\''number\'',col(\''cluster\'').alias(\''soundex_cluster\''),\''last_updated\'')\\r\",\"\\r\",\"        \\r\",\"        soundDf = soundDf.repartition(50)\\r\",\"        return soundDf\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},\"position_x\":\"460\",\"position_y\":\"80\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"PiYva\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"MNpqZ\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"script\":\"textarea\"},\"context\":[{\"dataset\":{\"id\":39032,\"name\":\"input\",\"alias\":\"input\",\"description\":\"Tickets with soundex of Short description\",\"schema\":null,\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, Soundex(clean_text) as sound, CASE WHEN group_by_field IS NULL THEN \''\'' ELSE group_by_field END AS group_by_field FROM @projectname_tickets_enriched  WHERE clean_text is not null and  Soundex(clean_text) != \''\'' and clean_text != \''\''\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MYSQL\",\"expStatus\":0,\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":false}]},{\"id\":\"MNpqZ\",\"alias\":\"Clusters\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"id\":39032,\"name\":\"DJR9U1LGA5\",\"alias\":\"Cluster\",\"description\":\"Tickets with soundex of Short description\",\"schema\":null,\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"Select  number , soundex_cluster, last_updated from @projectname_soundex\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"overwrite\",\"params\":\"{}\",\"tableName\":\"@projectname_soundex\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"rw\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MYSQL\",\"groups\":[],\"expStatus\":0,\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"}},\"applySchema\":false},\"position_x\":\"770\",\"position_y\":\"80\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"CSUzm\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"applySchema\":\"checkbox\"},\"context\":[{\"script\":[\"import logging\\r\",\"from datetime import datetime\\r\",\"from pyspark.sql.types import *\\r\",\"from pyspark.sql.functions import *\\r\",\"import re\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        soundDf = dataset.groupBy(\''group_by_field\'',\''sound\'').agg(collect_list(\''number\'').alias(\''numberList\''), collect_list(\''clean_text\'').alias(\''text_list\''))\\r\",\"\\r\",\"       \\r\",\"        soundDf = soundDf.withColumn(\''numberListSize\'', size(\''numberList\''))\\r\",\"        soundDf = soundDf.filter(soundDf[\''numberListSize\'']>=5)\\r\",\"        soundDf = soundDf.withColumn(\''cluster\'' , soundDf[\''text_list\''].getItem(0)).drop(\''text_list\'')\\r\",\"        \\r\",\"        soundDf = soundDf.select(\''group_by_field\'', \''cluster\'', \''numberList\'',\''sound\'')\\r\",\"        soundDf = soundDf.withColumn(\''number\'',explode(\''numberList\'')).drop(\''numberList\'')\\r\",\"        soundDf = soundDf.withColumn(\''last_updated\'',lit(datetime.now()))\\r\",\"\\r\",\"        soundDf = soundDf.select(\''number\'',col(\''cluster\'').alias(\''soundex_cluster\''),\''last_updated\'')\\r\",\"\\r\",\"        \\r\",\"        soundDf = soundDf.repartition(50)\\r\",\"        return soundDf\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},{\"dataset\":{\"id\":39032,\"name\":\"input\",\"alias\":\"input\",\"description\":\"Tickets with soundex of Short description\",\"schema\":null,\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, Soundex(clean_text) as sound, CASE WHEN group_by_field IS NULL THEN \''\'' ELSE group_by_field END AS group_by_field FROM @projectname_tickets_enriched  WHERE clean_text is not null and  Soundex(clean_text) != \''\'' and clean_text != \''\''\",\"Cacheable\":\"false\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"type\":\"r\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"datasetType\":\"MYSQL\",\"expStatus\":0,\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false,\"restnode\":false}]}]}' WHERE name='ACMCLSTR99942' AND organization='leo1311';
            UPDATE core.mlpipeline SET json_content='{\"elements\":[{\"id\":\"OxxDW\",\"alias\":\"Filter Dataset\",\"name\":\"Pre  Processing  Script\",\"classname\":\"PreProcessingScriptConfig\",\"category\":\"BaseConfig\",\"attributes\":{\"params\":\"{}\",\"script\":[\"import logging as logger\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        data = dataset.withColumn(\''cluster_Type\'',lit(\''LDA\''))\\r\",\"        filteredCIs = data.groupBy(\''group_by_field\'').count().filter((col(\''count\'') >=50) ).select(\''group_by_field\'')\\r\",\"        ciList= filteredCIs.rdd.map(lambda r: r[0]).collect()\\r\",\"        if ciList is not None and len(ciList) ==0:\\r\",\"            logger.info(\''No data for clustering\'')\\r\",\"            logger.info(\''Completed\'')\\r\",\"            print(\''Completed\'')\\r\",\"            exit()\\r\",\"        filtereddf = data.filter(col(\''group_by_field\'').isin(ciList))\\r\",\"        return filtereddf\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},\"position_x\":\"340\",\"position_y\":\"100\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"sXmyX\",\"elementPosition\":\"LeftMiddle\"},{\"type\":\"target\",\"endpoint\":\"dataset1\",\"position\":\"LeftMiddle\",\"elementId\":\"LREJS\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"dataset1\",\"dataset2\",\"dataset3\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"params\":\"textarea\",\"script\":\"textarea\"},\"context\":[{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"Tickets for LDA Clustering\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-05-25 07:58:24\",\"alias\":\"LDA Cluster\",\"id\":7,\"name\":\"ACMLDCLS54038\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"clean_text\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"group_by_field\\\",\\\"recordcolumndisplayname\\\":\\\"group_by_field\\\"}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, CASE WHEN group_by_field IS NULL THEN \''\'' ELSE group_by_field END AS group_by_field  FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != \''\''\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"IUlqx\",\"alias\":\"Post  Processing  Script\",\"name\":\"Post  Processing  Script\",\"classname\":\"PostProcessingScriptConfig\",\"category\":\"BaseConfig\",\"attributes\":{\"params\":\"\",\"script\":[\"import logging\\r\",\"from pyspark.sql.types import *\\r\",\"from pyspark.sql.functions import *\\r\",\"from datetime import datetime\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self,model, dataset):\\r\",\"        dataset = dataset[\''out\'']\\r\",\"        dataset = dataset.select(\''number\'',col(\''cluster_name\'').alias(\''lda_cluster\'') )\\r\",\"        dataset = dataset.withColumn(\''last_updated\'',lit(datetime.now()))\\r\",\"        dataset = dataset.repartition(200)\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},\"position_x\":\"720\",\"position_y\":\"240\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"XJUTb\",\"elementPosition\":\"LeftMiddle\"},{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"sXmyX\",\"elementPosition\":\"BottomCenter\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\",\"out2\"],\"requiredJars\":[],\"formats\":{\"params\":\"textarea\",\"script\":\"textarea\"},\"context\":[{\"UniqueIdColumn\":\"number\",\"GroupByColumn\":\"group_by_field\",\"TextColumn\":\"clean_text\",\"customStopWords\":\"\",\"vocabSize\":\"10000\",\"ClusterCount\":\"10\",\"checkPointInterval\":\"10\",\"saveModels\":\"\"},{\"params\":\"{}\",\"script\":[\"import logging as logger\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        data = dataset.withColumn(\''cluster_Type\'',lit(\''LDA\''))\\r\",\"        filteredCIs = data.groupBy(\''group_by_field\'').count().filter((col(\''count\'') >=50) ).select(\''group_by_field\'')\\r\",\"        ciList= filteredCIs.rdd.map(lambda r: r[0]).collect()\\r\",\"        if ciList is not None and len(ciList) ==0:\\r\",\"            logger.info(\''No data for clustering\'')\\r\",\"            logger.info(\''Completed\'')\\r\",\"            print(\''Completed\'')\\r\",\"            exit()\\r\",\"        filtereddf = data.filter(col(\''group_by_field\'').isin(ciList))\\r\",\"        return filtereddf\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"Tickets for LDA Clustering\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-05-25 07:58:24\",\"alias\":\"LDA Cluster\",\"id\":7,\"name\":\"ACMLDCLS54038\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"clean_text\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"group_by_field\\\",\\\"recordcolumndisplayname\\\":\\\"group_by_field\\\"}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, CASE WHEN group_by_field IS NULL THEN \''\'' ELSE group_by_field END AS group_by_field  FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != \''\''\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"hPWgu\",\"alias\":\"Dataset  Loader\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Topics\",\"name\":\"\",\"description\":\"Clustering topics vocab\",\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"Select * from @projectname_clustering_topics\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"overwrite\",\"params\":\"{}\",\"tableName\":\"@projectname_clustering_topics\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":[],\"backingDataset\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"}},\"applySchema\":false},\"position_x\":\"840\",\"position_y\":\"100\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"sXmyX\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"applySchema\":\"checkbox\"},\"context\":[{\"UniqueIdColumn\":\"number\",\"GroupByColumn\":\"group_by_field\",\"TextColumn\":\"clean_text\",\"customStopWords\":\"\",\"vocabSize\":\"10000\",\"ClusterCount\":\"10\",\"checkPointInterval\":\"10\",\"saveModels\":\"\"},{\"params\":\"{}\",\"script\":[\"import logging as logger\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        data = dataset.withColumn(\''cluster_Type\'',lit(\''LDA\''))\\r\",\"        filteredCIs = data.groupBy(\''group_by_field\'').count().filter((col(\''count\'') >=50) ).select(\''group_by_field\'')\\r\",\"        ciList= filteredCIs.rdd.map(lambda r: r[0]).collect()\\r\",\"        if ciList is not None and len(ciList) ==0:\\r\",\"            logger.info(\''No data for clustering\'')\\r\",\"            logger.info(\''Completed\'')\\r\",\"            print(\''Completed\'')\\r\",\"            exit()\\r\",\"        filtereddf = data.filter(col(\''group_by_field\'').isin(ciList))\\r\",\"        return filtereddf\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"Tickets for LDA Clustering\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-05-25 07:58:24\",\"alias\":\"LDA Cluster\",\"id\":7,\"name\":\"ACMLDCLS54038\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"clean_text\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"group_by_field\\\",\\\"recordcolumndisplayname\\\":\\\"group_by_field\\\"}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, CASE WHEN group_by_field IS NULL THEN \''\'' ELSE group_by_field END AS group_by_field  FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != \''\''\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"XJUTb\",\"alias\":\"Dataset  Loader\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Clusters\",\"name\":\"KBJUD4APBG\",\"description\":\"LDA clusters\",\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT  number , lda_cluster,lda_cluster_confidence, last_updated  from  @projectname_lda\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"overwrite\",\"params\":\"{}\",\"tableName\":\"@projectname_lda\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"}},\"applySchema\":false},\"position_x\":\"950\",\"position_y\":\"240\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"IUlqx\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"applySchema\":\"checkbox\"},\"context\":[{\"params\":\"\",\"script\":[\"import logging\\r\",\"from pyspark.sql.types import *\\r\",\"from pyspark.sql.functions import *\\r\",\"from datetime import datetime\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self,model, dataset):\\r\",\"        dataset = dataset[\''out\'']\\r\",\"        dataset = dataset.select(\''number\'',col(\''cluster_name\'').alias(\''lda_cluster\'') )\\r\",\"        dataset = dataset.withColumn(\''last_updated\'',lit(datetime.now()))\\r\",\"        dataset = dataset.repartition(200)\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},{\"UniqueIdColumn\":\"number\",\"GroupByColumn\":\"group_by_field\",\"TextColumn\":\"clean_text\",\"customStopWords\":\"\",\"vocabSize\":\"10000\",\"ClusterCount\":\"10\",\"checkPointInterval\":\"10\",\"saveModels\":\"\"},{\"params\":\"{}\",\"script\":[\"import logging as logger\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        data = dataset.withColumn(\''cluster_Type\'',lit(\''LDA\''))\\r\",\"        filteredCIs = data.groupBy(\''group_by_field\'').count().filter((col(\''count\'') >=50) ).select(\''group_by_field\'')\\r\",\"        ciList= filteredCIs.rdd.map(lambda r: r[0]).collect()\\r\",\"        if ciList is not None and len(ciList) ==0:\\r\",\"            logger.info(\''No data for clustering\'')\\r\",\"            logger.info(\''Completed\'')\\r\",\"            print(\''Completed\'')\\r\",\"            exit()\\r\",\"        filtereddf = data.filter(col(\''group_by_field\'').isin(ciList))\\r\",\"        return filtereddf\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"Tickets for LDA Clustering\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-05-25 07:58:24\",\"alias\":\"LDA Cluster\",\"id\":7,\"name\":\"ACMLDCLS54038\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"clean_text\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"group_by_field\\\",\\\"recordcolumndisplayname\\\":\\\"group_by_field\\\"}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, CASE WHEN group_by_field IS NULL THEN \''\'' ELSE group_by_field END AS group_by_field  FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != \''\''\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"LREJS\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"Tickets for LDA Clustering\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-05-25 07:58:24\",\"alias\":\"LDA Cluster\",\"id\":7,\"name\":\"ACMLDCLS54038\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"clean_text\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"group_by_field\\\",\\\"recordcolumndisplayname\\\":\\\"group_by_field\\\"}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, CASE WHEN group_by_field IS NULL THEN \''\'' ELSE group_by_field END AS group_by_field  FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != \''\''\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},\"position_x\":\"60\",\"position_y\":\"100\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"OxxDW\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"sXmyX\",\"alias\":\"Incident  Clustering\",\"name\":\"Incident  Clustering\",\"classname\":\"IncidentClusteringLDAConfig\",\"category\":\"DomainSolutionConfig\",\"attributes\":{\"UniqueIdColumn\":\"number\",\"GroupByColumn\":\"group_by_field\",\"TextColumn\":\"clean_text\",\"customStopWords\":\"\",\"vocabSize\":\"10000\",\"ClusterCount\":\"10\",\"checkPointInterval\":\"10\",\"saveModels\":\"\"},\"position_x\":\"590\",\"position_y\":\"100\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"OxxDW\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"topics\",\"position\":\"RightMiddle\",\"elementId\":\"hPWgu\",\"elementPosition\":\"LeftMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"BottomCenter\",\"elementId\":\"IUlqx\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"topics\",\"out\"],\"requiredJars\":[],\"formats\":{\"UniqueIdColumn\":\"text\",\"GroupByColumn\":\"text\",\"TextColumn\":\"text\",\"customStopWords\":\"text\",\"vocabSize\":\"text\",\"ClusterCount\":\"text\",\"checkPointInterval\":\"text\",\"saveModels\":\"checkbox\"},\"context\":[{\"params\":\"{}\",\"script\":[\"import logging as logger\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        data = dataset.withColumn(\''cluster_Type\'',lit(\''LDA\''))\\r\",\"        filteredCIs = data.groupBy(\''group_by_field\'').count().filter((col(\''count\'') >=50) ).select(\''group_by_field\'')\\r\",\"        ciList= filteredCIs.rdd.map(lambda r: r[0]).collect()\\r\",\"        if ciList is not None and len(ciList) ==0:\\r\",\"            logger.info(\''No data for clustering\'')\\r\",\"            logger.info(\''Completed\'')\\r\",\"            print(\''Completed\'')\\r\",\"            exit()\\r\",\"        filtereddf = data.filter(col(\''group_by_field\'').isin(ciList))\\r\",\"        return filtereddf\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"]},{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"Tickets for LDA Clustering\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-05-25 07:58:24\",\"alias\":\"LDA Cluster\",\"id\":7,\"name\":\"ACMLDCLS54038\",\"schemavalue\":\"[{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":1,\\\"recordcolumnname\\\":\\\"number\\\",\\\"recordcolumndisplayname\\\":\\\"number\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":2,\\\"recordcolumnname\\\":\\\"clean_text\\\",\\\"recordcolumndisplayname\\\":\\\"clean_text\\\"},{\\\"columntype\\\":\\\"string\\\",\\\"columnorder\\\":3,\\\"recordcolumnname\\\":\\\"group_by_field\\\",\\\"recordcolumndisplayname\\\":\\\"group_by_field\\\"}]\",\"organization\":\"leo1311\",\"formtemplate\":\"[]\"},\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text, CASE WHEN group_by_field IS NULL THEN \''\'' ELSE group_by_field END AS group_by_field  FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != \''\''\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"GuvzZ\",\"alias\":\"X Y Z_test\",\"name\":\"X Y Z_test\",\"classname\":\"XYZ_test\",\"category\":\"TransformerConfig\",\"attributes\":{\"arguments\":\"\",\"id\":\"\"},\"position_x\":\"340\",\"position_y\":\"200\",\"connectors\":[],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"arguments\":\"text\",\"id\":\"text\"}}]}' WHERE name='ACMCLSTR21224' AND organization='leo1311';
            UPDATE core.mlpipeline SET json_content='{\"elements\":[{\"id\":\"UEeVc\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"name\":\"ZK0CN34C9S\",\"alias\":\"Tickets\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != \''\''\",\"Cacheable\":\"\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"datasetType\":\"MYSQL\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"expStatus\":0,\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},\"position_x\":\"40\",\"position_y\":\"30\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"XQVmY\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"HYOWn\",\"alias\":\"Dataset  Loader\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"name\":\"RGQTFH97NN\",\"alias\":\"Phrases\",\"description\":\"Phrases\",\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select number, extracted_phrase, mapped_phrase, mapped_phrase_confidennce, last_updated from @projectname_phrase_extraction\",\"Cacheable\":\"\",\"isStreaming\":\"false\",\"writeMode\":\"overwrite\",\"params\":\"{}\",\"tableName\":\"@projectname_phrase_extraction\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"datasetType\":\"MYSQL\",\"groups\":\"\",\"backingDataset\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"}},\"applySchema\":false},\"position_x\":\"730\",\"position_y\":\"30\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"XQVmY\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"applySchema\":\"checkbox\"},\"context\":[{\"script\":[\"import logging\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"import spacy\\r\",\"import pytextrank\\r\",\"from datetime import datetime\\r\",\"from pyspark.sql import SparkSession\\r\",\"\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        spark = SparkSession.builder.getOrCreate()\\r\",\"        nlp = spacy.load(\''en_core_web_sm\'')\\r\",\"        nlp.add_pipe(\''textrank\'')\\r\",\"        nlp_broadcast = spark.sparkContext.broadcast(nlp)\\r\",\"\\r\",\"        def getPharase(text):\\r\",\"            doc = nlp_broadcast.value(text)\\r\",\"            phrase =\''\''\\r\",\"            if len(doc._.phrases)>0:\\r\",\"                for item in doc._.phrases:\\r\",\"                    withoutSpace = item.text.replace(\'' \'' ,\''\'')\\r\",\"                    if not withoutSpace.isdigit() and len(item.text.split(\'' \'')) >1:\\r\",\"                        phrase = item.text\\r\",\"                        break\\r\",\"                return phrase\\r\",\"            else:\\r\",\"                return text\\r\",\"        \\r\",\"        udfPhrases = udf(getPharase,StringType())\\r\",\"        dataset.show()\\r\",\"        dataset = dataset.withColumn(\''extracted_phrase\'',udfPhrases(\''clean_text\''))\\r\",\"        dataset = dataset.select(\''number\'',\''extracted_phrase\'')\\r\",\"        dataset = dataset.withColumn(\''mapped_phrase\'',lit(\'' \''))\\r\",\"        dataset = dataset.withColumn(\''mapped_phrase_confidennce\'',lit(\'' \''))\\r\",\"        dataset = dataset.withColumn(\''last_updated\'',lit(datetime.now()))\\r\",\"        dataset.show()\\r\",\"\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"],\"outputCols\":\"text\"},{\"dataset\":{\"name\":\"ZK0CN34C9S\",\"alias\":\"Tickets\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != \''\''\",\"Cacheable\":\"\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"datasetType\":\"MYSQL\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"expStatus\":0,\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"XQVmY\",\"alias\":\"Phrase extraction\",\"name\":\"Python  Script  Transformer\",\"classname\":\"PythonScriptTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"script\":[\"import logging\\r\",\"from pyspark.sql.functions import *\\r\",\"from pyspark.sql.types import *\\r\",\"import spacy\\r\",\"import pytextrank\\r\",\"from datetime import datetime\\r\",\"from pyspark.sql import SparkSession\\r\",\"\\r\",\"class CustomPythonClass():\\r\",\"    def __main__(self, dataset):\\r\",\"        spark = SparkSession.builder.getOrCreate()\\r\",\"        nlp = spacy.load(\''en_core_web_sm\'')\\r\",\"        nlp.add_pipe(\''textrank\'')\\r\",\"        nlp_broadcast = spark.sparkContext.broadcast(nlp)\\r\",\"\\r\",\"        def getPharase(text):\\r\",\"            doc = nlp_broadcast.value(text)\\r\",\"            phrase =\''\''\\r\",\"            if len(doc._.phrases)>0:\\r\",\"                for item in doc._.phrases:\\r\",\"                    withoutSpace = item.text.replace(\'' \'' ,\''\'')\\r\",\"                    if not withoutSpace.isdigit() and len(item.text.split(\'' \'')) >1:\\r\",\"                        phrase = item.text\\r\",\"                        break\\r\",\"                return phrase\\r\",\"            else:\\r\",\"                return text\\r\",\"        \\r\",\"        udfPhrases = udf(getPharase,StringType())\\r\",\"        dataset.show()\\r\",\"        dataset = dataset.withColumn(\''extracted_phrase\'',udfPhrases(\''clean_text\''))\\r\",\"        dataset = dataset.select(\''number\'',\''extracted_phrase\'')\\r\",\"        dataset = dataset.withColumn(\''mapped_phrase\'',lit(\'' \''))\\r\",\"        dataset = dataset.withColumn(\''mapped_phrase_confidennce\'',lit(\'' \''))\\r\",\"        dataset = dataset.withColumn(\''last_updated\'',lit(datetime.now()))\\r\",\"        dataset.show()\\r\",\"\\r\",\"        return dataset\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\",\"\\r\"],\"outputCols\":\"text\"},\"position_x\":\"330\",\"position_y\":\"30\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"UEeVc\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"HYOWn\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"script\":\"textarea\",\"outputCols\":\"text\"},\"context\":[{\"dataset\":{\"name\":\"ZK0CN34C9S\",\"alias\":\"Tickets\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, clean_text FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != \''\''\",\"Cacheable\":\"\",\"isStreaming\":\"false\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"defaultValues\":\"\",\"uniqueIdentifier\":\"\"},\"datasetType\":\"MYSQL\",\"backingDataset\":\"\",\"organization\":\"leo1311\",\"expStatus\":0,\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]}]}' WHERE name='ACMPHRSX44652' AND organization='leo1311';
            UPDATE core.mlpipeline SET json_content='{\"elements\":[{\"id\":\"FqRsj\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Tickets\",\"name\":\"Tickets\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, CAST(clean_text as CHAR) as clean_text FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != \''\''  Order by Clean_text\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"}},\"position_x\":\"180\",\"position_y\":\"50\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"XlASA\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\"},\"context\":[]},{\"id\":\"XlASA\",\"alias\":\"Extract Phrases\",\"name\":\"Python  Script  Transformer\",\"classname\":\"PythonScriptTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"script\":[\"import logging\",\"import spacy\",\"import pytextrank\",\"from datetime import datetime\",\"class CustomPythonClass():\",\"    def __main__(self, dataset):\",\"        nlp = spacy.load(\''en_core_web_sm\'')\",\"        nlp.add_pipe(\''textrank\'')\",\"        timenow = datetime.now()\",\"        totalRecords = len(dataset)\",\"        logging.info(\''Fetched {0} records\''.format(totalRecords))\",\"        count =0\",\"        textPhraseMappings = {}\",\"        for row in dataset:\",\"            try:\",\"                text = row[\''clean_text\'']\",\"                if textPhraseMappings.get(text,\''\'') != \''\'':\",\"                    row[\''extracted_phrase\''] = textPhraseMappings[text]\",\"                    break\",\"                doc = nlp(text)\",\"                phrase =\''\''\",\"                if len(doc._.phrases)>0:\",\"                    for item in doc._.phrases:\",\"                        withoutSpace = item.text.replace(\'' \'' ,\''\'')\",\"                        if not withoutSpace.isdigit() and len(item.text.split(\'' \'')) >1:\",\"                            phrase = item.text\",\"                            break\",\"                if phrase != \''\'':\",\"                    row[\''extracted_phrase\''] = phrase\",\"                else:\",\"                    row[\''extracted_phrase\''] = text\",\"            except Exception as ex:\",\"                logging.info(ex)\",\"                row[\''extracted_phrase\''] = text\",\"            row[\''last_updated\''] = timenow\",\"            row[\''mapped_phrase\''] = \''\''\",\"            row[\''mapped_phrase_confidennce\''] = \''\''\",\"            count = count+1\",\"            percentage = (count/totalRecords)*100 \",\"            if percentage%10 ==0:\",\"                logging.info(\''{0}% Completed\''.format(percentage))\",\"        \",\"        return dataset\"]},\"position_x\":\"440\",\"position_y\":\"50\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in1\",\"position\":\"LeftMiddle\",\"elementId\":\"FqRsj\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out1\",\"position\":\"RightMiddle\",\"elementId\":\"JdZtY\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in1\",\"in2\"],\"outputEndpoints\":[\"out1\",\"out2\"],\"requiredJars\":[],\"formats\":{\"script\":\"textarea\"},\"context\":[{\"dataset\":{\"alias\":\"Tickets\",\"name\":\"Tickets\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-07-27 10:51:41\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-07-27 10:51:41\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, CAST(clean_text as CHAR) as clean_text FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != \''\''  Order by Clean_text\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"}}]},{\"id\":\"JdZtY\",\"alias\":\"Dataset  Loader\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Phrases\",\"name\":\"TH2VXIBQRT\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"select number, extracted_phrase, mapped_phrase, mapped_phrase_confidennce, last_updated from @projectname_phrase_extraction\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"overwrite\",\"params\":\"{}\",\"tableName\":\"@projectname_phrase_extraction\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"}},\"position_x\":\"740\",\"position_y\":\"50\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"XlASA\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\"},\"context\":[{\"script\":[\"import logging\",\"import spacy\",\"import pytextrank\",\"from datetime import datetime\",\"class CustomPythonClass():\",\"    def __main__(self, dataset):\",\"        nlp = spacy.load(\''en_core_web_sm\'')\",\"        nlp.add_pipe(\''textrank\'')\",\"        timenow = datetime.now()\",\"        totalRecords = len(dataset)\",\"        logging.info(\''Fetched {0} records\''.format(totalRecords))\",\"        count =0\",\"        textPhraseMappings = {}\",\"        for row in dataset:\",\"            try:\",\"                text = row[\''clean_text\'']\",\"                if textPhraseMappings.get(text,\''\'') != \''\'':\",\"                    row[\''extracted_phrase\''] = textPhraseMappings[text]\",\"                    break\",\"                doc = nlp(text)\",\"                phrase =\''\''\",\"                if len(doc._.phrases)>0:\",\"                    for item in doc._.phrases:\",\"                        withoutSpace = item.text.replace(\'' \'' ,\''\'')\",\"                        if not withoutSpace.isdigit() and len(item.text.split(\'' \'')) >1:\",\"                            phrase = item.text\",\"                            break\",\"                if phrase != \''\'':\",\"                    row[\''extracted_phrase\''] = phrase\",\"                else:\",\"                    row[\''extracted_phrase\''] = text\",\"            except Exception as ex:\",\"                logging.info(ex)\",\"                row[\''extracted_phrase\''] = text\",\"            row[\''last_updated\''] = timenow\",\"            row[\''mapped_phrase\''] = \''\''\",\"            row[\''mapped_phrase_confidennce\''] = \''\''\",\"            count = count+1\",\"            percentage = (count/totalRecords)*100 \",\"            if percentage%10 ==0:\",\"                logging.info(\''{0}% Completed\''.format(percentage))\",\"        \",\"        return dataset\"]},{\"dataset\":{\"alias\":\"Tickets\",\"name\":\"Tickets\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-07-27 10:51:41\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"e07111d6404e23b45cc04e28571f1522cbae5d4e1bdb186f5e27f51c1c6a2210\",\"activetime\":\"2021-07-27 10:51:41\",\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT number, CAST(clean_text as CHAR) as clean_text FROM @projectname_tickets_enriched  WHERE clean_text is not null and clean_text != \''\''  Order by Clean_text\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"}}]}]}' WHERE name='ACMPHRSX57460' AND organization='leo1311';
            UPDATE core.mlpipeline SET json_content='{\"elements\":[{\"id\":\"WZFCq\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Clusters\",\"name\":\"LPD29OS8SS\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT cast(t.number as char) AS number, tags AS tags, ng.ngram, sound.soundex_cluster FROM @projectname_tickets t LEFT\\nJOIN @projectname_ngram ng ON t.number=cast(ng.number as char) LEFT JOIN @projectname_soundex sound ON t.number=cast(sound.number as char)\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},\"position_x\":\"170\",\"position_y\":\"160\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"nUpLq\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"mNtFe\",\"alias\":\"Python  Script  Transformer\",\"name\":\"Python  Script  Transformer\",\"classname\":\"PythonScriptTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"script\":[\"import logging\",\"from datetime import datetime\",\"from pyspark.sql.functions import *\",\"from pyspark.sql.types import *\",\"class CustomPythonClass():\",\"    def __main__(self, dataset):\",\"        def getCluster(tags,ngram,soundex_cluster, lda_cluster,mapped_phrase  ):\",\"            cluster = \''\''\",\"            if tags is not None and tags != \''\'':\",\"                cluster = tags\",\"            elif ngram is not None and ngram != \''\'':\",\"                cluster = ngram\",\"            elif soundex_cluster is not None and soundex_cluster != \''\'':\",\"                cluster = soundex_cluster\",\"            elif mapped_phrase is not None and mapped_phrase != \''\'':\",\"                cluster = mapped_phrase\",\"            elif lda_cluster is not None and lda_cluster != \''\'':\",\"                cluster = lda_cluster\",\"            return cluster\",\"        udfGetCluster = udf(getCluster, StringType())\",\"        dataset.show()\",\"        dataset = dataset.withColumn(\''post_ranking_cluster\'', udfGetCluster(\''tags\'',\''ngram\'',\''soundex_cluster\'',\''lda_cluster\'',\''mapped_phrase\''))\",\"        dataset = dataset.withColumn(\''last_updated\'', lit(datetime.now()))\",\"        dataset.show()\",\"        dataset = dataset.select(\''number\'',\''ngram\'',\''soundex_cluster\'',\''lda_cluster\'',\''mapped_phrase\'',\''last_updated\'',\''post_ranking_cluster\'')\",\"        return dataset\"]},\"position_x\":\"650\",\"position_y\":\"160\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"rOEhB\",\"elementPosition\":\"LeftMiddle\"},{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"nUpLq\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"script\":\"textarea\"},\"context\":[{\"params\":\"\",\"script\":[\"import logging as logger\",\"from pyspark.sql.functions import *\",\"from pyspark.sql.types import *\",\"class CustomPythonClass():\",\"    def __main__(self, dataset1, dataset2, dataset3):\",\"        dataset = dataset1.join(dataset2 , [\''number\''], how=\''left\'')\",\"        dataset = dataset.join(dataset3, [\''number\''], how=\''left\'')\",\"        \",\"        return dataset\"]},{\"dataset\":{\"alias\":\"Clusters\",\"name\":\"LPD29OS8SS\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT cast(t.number as char) AS number, tags AS tags, ng.ngram, sound.soundex_cluster FROM @projectname_tickets t LEFT\\nJOIN @projectname_ngram ng ON t.number=cast(ng.number as char) LEFT JOIN @projectname_soundex sound ON t.number=cast(sound.number as char)\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"LDA Clusters\",\"name\":\"263RBVB8BD\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT t.number, ldatopics.alias AS lda_cluster FROM @projectname_tickets_enriched t LEFT JOIN @projectname_lda lda on t.number=cast(lda.number as char) LEFT JOIN @projectname_clustering_topics ldatopics ON lda.lda_cluster = ldatopics.words\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"Phrase Extraction\",\"name\":\"DYV83OFE7R\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT cast(t.number as char) as number, case when cast(cast(pe.mapped_phrase_confidennce as char) as float) > 0.4 THEN  pe.extracted_phrase ELSE \''\'' END as  mapped_phrase FROM @projectname_tickets_enriched t left join @projectname_phrase_extraction pe on t.number = cast(pe.number as char)\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"rOEhB\",\"alias\":\"Dataset  Loader\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Prioritized Cluster\",\"name\":\"VWT0JK2U1N\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"Select number , ngram, soundex_cluster, lda_cluster, mapped_phrase, last_updated, post_ranking_cluster from @projectname_tickets_enriched\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"update\",\"params\":\"{}\",\"tableName\":\"@projectname_tickets_enriched\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"applySchema\":false},\"position_x\":\"900\",\"position_y\":\"160\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"mNtFe\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"applySchema\":\"checkbox\"},\"context\":[{\"script\":[\"import logging\",\"from datetime import datetime\",\"from pyspark.sql.functions import *\",\"from pyspark.sql.types import *\",\"class CustomPythonClass():\",\"    def __main__(self, dataset):\",\"        def getCluster(tags,ngram,soundex_cluster, lda_cluster,mapped_phrase  ):\",\"            cluster = \''\''\",\"            if tags is not None and tags != \''\'':\",\"                cluster = tags\",\"            elif ngram is not None and ngram != \''\'':\",\"                cluster = ngram\",\"            elif soundex_cluster is not None and soundex_cluster != \''\'':\",\"                cluster = soundex_cluster\",\"            elif mapped_phrase is not None and mapped_phrase != \''\'':\",\"                cluster = mapped_phrase\",\"            elif lda_cluster is not None and lda_cluster != \''\'':\",\"                cluster = lda_cluster\",\"            return cluster\",\"        udfGetCluster = udf(getCluster, StringType())\",\"        dataset.show()\",\"        dataset = dataset.withColumn(\''post_ranking_cluster\'', udfGetCluster(\''tags\'',\''ngram\'',\''soundex_cluster\'',\''lda_cluster\'',\''mapped_phrase\''))\",\"        dataset = dataset.withColumn(\''last_updated\'', lit(datetime.now()))\",\"        dataset.show()\",\"        dataset = dataset.select(\''number\'',\''ngram\'',\''soundex_cluster\'',\''lda_cluster\'',\''mapped_phrase\'',\''last_updated\'',\''post_ranking_cluster\'')\",\"        return dataset\"]},{\"params\":\"\",\"script\":[\"import logging as logger\",\"from pyspark.sql.functions import *\",\"from pyspark.sql.types import *\",\"class CustomPythonClass():\",\"    def __main__(self, dataset1, dataset2, dataset3):\",\"        dataset = dataset1.join(dataset2 , [\''number\''], how=\''left\'')\",\"        dataset = dataset.join(dataset3, [\''number\''], how=\''left\'')\",\"        \",\"        return dataset\"]},{\"dataset\":{\"alias\":\"Clusters\",\"name\":\"LPD29OS8SS\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT cast(t.number as char) AS number, tags AS tags, ng.ngram, sound.soundex_cluster FROM @projectname_tickets t LEFT\\nJOIN @projectname_ngram ng ON t.number=cast(ng.number as char) LEFT JOIN @projectname_soundex sound ON t.number=cast(sound.number as char)\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"LDA Clusters\",\"name\":\"263RBVB8BD\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT t.number, ldatopics.alias AS lda_cluster FROM @projectname_tickets_enriched t LEFT JOIN @projectname_lda lda on t.number=cast(lda.number as char) LEFT JOIN @projectname_clustering_topics ldatopics ON lda.lda_cluster = ldatopics.words\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"Phrase Extraction\",\"name\":\"DYV83OFE7R\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT cast(t.number as char) as number, case when cast(cast(pe.mapped_phrase_confidennce as char) as float) > 0.4 THEN  pe.extracted_phrase ELSE \''\'' END as  mapped_phrase FROM @projectname_tickets_enriched t left join @projectname_phrase_extraction pe on t.number = cast(pe.number as char)\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]},{\"id\":\"RADSx\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"alias\":\"LDA Clusters\",\"name\":\"263RBVB8BD\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT t.number, ldatopics.alias AS lda_cluster FROM @projectname_tickets_enriched t LEFT JOIN @projectname_lda lda on t.number=cast(lda.number as char) LEFT JOIN @projectname_clustering_topics ldatopics ON lda.lda_cluster = ldatopics.words\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},\"position_x\":\"170\",\"position_y\":\"30\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"nUpLq\",\"elementPosition\":\"TopCenter\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"zJRXl\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Phrase Extraction\",\"name\":\"DYV83OFE7R\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT cast(t.number as char) as number, case when cast(cast(pe.mapped_phrase_confidennce as char) as float) > 0.4 THEN  pe.extracted_phrase ELSE \''\'' END as  mapped_phrase FROM @projectname_tickets_enriched t left join @projectname_phrase_extraction pe on t.number = cast(pe.number as char)\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},\"position_x\":\"170\",\"position_y\":\"300\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"nUpLq\",\"elementPosition\":\"BottomCenter\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\",\"isValidation\":\"checkbox\",\"samplingRatio\":\"text\",\"applySchema\":\"checkbox\"},\"context\":[]},{\"id\":\"nUpLq\",\"alias\":\"Pre  Processing  Script\",\"name\":\"Pre  Processing  Script\",\"classname\":\"PreProcessingScriptConfig\",\"category\":\"BaseConfig\",\"attributes\":{\"params\":\"\",\"script\":[\"import logging as logger\",\"from pyspark.sql.functions import *\",\"from pyspark.sql.types import *\",\"class CustomPythonClass():\",\"    def __main__(self, dataset1, dataset2, dataset3):\",\"        dataset = dataset1.join(dataset2 , [\''number\''], how=\''left\'')\",\"        dataset = dataset.join(dataset3, [\''number\''], how=\''left\'')\",\"        \",\"        return dataset\"]},\"position_x\":\"410\",\"position_y\":\"160\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"dataset1\",\"position\":\"LeftMiddle\",\"elementId\":\"WZFCq\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"target\",\"endpoint\":\"dataset2\",\"position\":\"TopCenter\",\"elementId\":\"RADSx\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"target\",\"endpoint\":\"dataset3\",\"position\":\"BottomCenter\",\"elementId\":\"zJRXl\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"mNtFe\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"dataset1\",\"dataset2\",\"dataset3\"],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"params\":\"textarea\",\"script\":\"textarea\"},\"context\":[{\"dataset\":{\"alias\":\"Clusters\",\"name\":\"LPD29OS8SS\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT cast(t.number as char) AS number, tags AS tags, ng.ngram, sound.soundex_cluster FROM @projectname_tickets t LEFT\\nJOIN @projectname_ngram ng ON t.number=cast(ng.number as char) LEFT JOIN @projectname_soundex sound ON t.number=cast(sound.number as char)\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"LDA Clusters\",\"name\":\"263RBVB8BD\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT t.number, ldatopics.alias AS lda_cluster FROM @projectname_tickets_enriched t LEFT JOIN @projectname_lda lda on t.number=cast(lda.number as char) LEFT JOIN @projectname_clustering_topics ldatopics ON lda.lda_cluster = ldatopics.words\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false},{\"dataset\":{\"alias\":\"Phrase Extraction\",\"name\":\"DYV83OFE7R\",\"description\":\"\",\"datasource\":{\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/1312_new_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"aeca578b1babdbc7870fef7fb09130681398a7e6eba5555819657acb805cac4a\",\"activetime\":\"2021-11-12 09:35:18\",\"category\":\"SQL\",\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-11-12 09:35:18\",\"alias\":\"leo1311\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT cast(t.number as char) as number, case when cast(cast(pe.mapped_phrase_confidennce as char) as float) > 0.4 THEN  pe.extracted_phrase ELSE \''\'' END as  mapped_phrase FROM @projectname_tickets_enriched t left join @projectname_phrase_extraction pe on t.number = cast(pe.number as char)\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\",\"Cacheable\":\"\"},\"expStatus\":0,\"groups\":\"\",\"backingDataset\":\"\"},\"isValidation\":\"\",\"samplingRatio\":\"\",\"applySchema\":false}]}]}' WHERE name='ACMCLSTR52976' AND organization='leo1311';
 			UPDATE core.mlpipeline SET json_content='{\"elements\":[{\"id\":\"uNaPq\",\"alias\":\"Dataset  Extractor\",\"name\":\"Dataset  Extractor\",\"classname\":\"DatasetExtractorConfig\",\"category\":\"ExtractorConfig\",\"attributes\":{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"Select number, CAST(clean_text as CHAR) as clean_text from @projectname_tickets_enriched where clean_text is not null and clean_text != \''\'' \",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":[]}},\"position_x\":\"180\",\"position_y\":\"110\",\"connectors\":[{\"type\":\"source\",\"endpoint\":\"out\",\"position\":\"RightMiddle\",\"elementId\":\"uOOHr\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[],\"outputEndpoints\":[\"out\"],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\"},\"context\":[]},{\"id\":\"uOOHr\",\"alias\":\"Python  Script  Transformer\",\"name\":\"Python  Script  Transformer\",\"classname\":\"PythonScriptTransformerConfig\",\"category\":\"TransformerConfig\",\"attributes\":{\"script\":[\"import logging\",\"from sklearn.feature_extraction.text import CountVectorizer, TfidfVectorizer\",\"import pandas as pd\",\"import numpy as np\",\"from datetime import datetime\",\"class CustomPythonClass():\",\"    def __main__(self, dataset):\",\"        txt1 =[]\",\"        for row in dataset:\",\"            txt1.append(row[\''clean_text\''])\",\"        logging.info(\''Generating NGrams\'')\",\"        # Getting trigrams \",\"        vectorizer = CountVectorizer(ngram_range = (3,3))\",\"        X1 = vectorizer.fit_transform(txt1) \",\"        features = (vectorizer.get_feature_names())\",\"        # Applying TFIDF\",\"        vectorizer = TfidfVectorizer(ngram_range = (3,3))\",\"        X2 = vectorizer.fit_transform(txt1)\",\"        scores = (X2.toarray())\",\"        # Getting top ranking features\",\"        logging.info(\''Getting Top 50 Grams\'')\",\"        sums = X2.sum(axis = 0)\",\"        data1 = []\",\"        for col, term in enumerate(features):\",\"            data1.append( (term, sums[0,col] ))\",\"        ranking = pd.DataFrame(data1, columns = [\''term\'',\''rank\''])\",\"        words = (ranking.sort_values(\''rank\'', ascending = False))\",\"        top50df = words.nlargest(50,\''rank\'')\",\"        top50 = words[\''term\''].tolist()\",\"       \",\"        distinctText = list(set(txt1))\",\"        count=0\",\"        totalRecords = len(distinctText)\",\"        logging.info(\''Mapping Text to Gram\'')\",\"        logging.info(\''Total Unique Values: {0}\''.format(totalRecords))\",\"        ngramDict = {}\",\"        for item in distinctText:\",\"            matchingGrams = [gram for gram in top50 if gram in item]\",\"            if len(matchingGrams) >0:\",\"                ngramDict[item] = matchingGrams[0]\",\"            count = count+1\",\"            if count%1000 ==0:\",\"                logging.info(\''{0} rows mapped\''.format(count))\",\"    \",\"        logging.info(\''Mapping Tickets\'')\",\"        \",\"        for row in dataset:\",\"            row[\''ngram\''] = ngramDict.get(row[\''clean_text\''],\''\'')\",\"        return dataset\"]},\"position_x\":\"510\",\"position_y\":\"100\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in1\",\"position\":\"LeftMiddle\",\"elementId\":\"uNaPq\",\"elementPosition\":\"RightMiddle\"},{\"type\":\"source\",\"endpoint\":\"out1\",\"position\":\"RightMiddle\",\"elementId\":\"LLDFc\",\"elementPosition\":\"LeftMiddle\"}],\"inputEndpoints\":[\"in1\",\"in2\"],\"outputEndpoints\":[\"out1\",\"out2\"],\"requiredJars\":[],\"formats\":{\"script\":\"textarea\"},\"context\":[{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"Select number, CAST(clean_text as CHAR) as clean_text from @projectname_tickets_enriched where clean_text is not null and clean_text != \''\'' \",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":[]}}]},{\"id\":\"LLDFc\",\"alias\":\"Dataset  Loader\",\"name\":\"Dataset  Loader\",\"classname\":\"DatasetLoaderConfig\",\"category\":\"LoaderConfig\",\"attributes\":{\"dataset\":{\"alias\":\"ngramout\",\"name\":\"OL3XLSBIY5\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":\"\",\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"Select number, ngram from @projectname_ngram\",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"overwrite\",\"params\":\"{}\",\"tableName\":\"@projectname_ngram\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"groups\":[],\"backingDataset\":\"\"}},\"position_x\":\"820\",\"position_y\":\"100\",\"connectors\":[{\"type\":\"target\",\"endpoint\":\"in\",\"position\":\"LeftMiddle\",\"elementId\":\"uOOHr\",\"elementPosition\":\"RightMiddle\"}],\"inputEndpoints\":[\"in\"],\"outputEndpoints\":[],\"requiredJars\":[],\"formats\":{\"dataset\":\"dropdown\"},\"context\":[{\"script\":[\"import logging\",\"from sklearn.feature_extraction.text import CountVectorizer, TfidfVectorizer\",\"import pandas as pd\",\"import numpy as np\",\"from datetime import datetime\",\"class CustomPythonClass():\",\"    def __main__(self, dataset):\",\"        txt1 =[]\",\"        for row in dataset:\",\"            txt1.append(row[\''clean_text\''])\",\"        logging.info(\''Generating NGrams\'')\",\"        # Getting trigrams \",\"        vectorizer = CountVectorizer(ngram_range = (3,3))\",\"        X1 = vectorizer.fit_transform(txt1) \",\"        features = (vectorizer.get_feature_names())\",\"        # Applying TFIDF\",\"        vectorizer = TfidfVectorizer(ngram_range = (3,3))\",\"        X2 = vectorizer.fit_transform(txt1)\",\"        scores = (X2.toarray())\",\"        # Getting top ranking features\",\"        logging.info(\''Getting Top 50 Grams\'')\",\"        sums = X2.sum(axis = 0)\",\"        data1 = []\",\"        for col, term in enumerate(features):\",\"            data1.append( (term, sums[0,col] ))\",\"        ranking = pd.DataFrame(data1, columns = [\''term\'',\''rank\''])\",\"        words = (ranking.sort_values(\''rank\'', ascending = False))\",\"        top50df = words.nlargest(50,\''rank\'')\",\"        top50 = words[\''term\''].tolist()\",\"       \",\"        distinctText = list(set(txt1))\",\"        count=0\",\"        totalRecords = len(distinctText)\",\"        logging.info(\''Mapping Text to Gram\'')\",\"        logging.info(\''Total Unique Values: {0}\''.format(totalRecords))\",\"        ngramDict = {}\",\"        for item in distinctText:\",\"            matchingGrams = [gram for gram in top50 if gram in item]\",\"            if len(matchingGrams) >0:\",\"                ngramDict[item] = matchingGrams[0]\",\"            count = count+1\",\"            if count%1000 ==0:\",\"                logging.info(\''{0} rows mapped\''.format(count))\",\"    \",\"        logging.info(\''Mapping Tickets\'')\",\"        \",\"        for row in dataset:\",\"            row[\''ngram\''] = ngramDict.get(row[\''clean_text\''],\''\'')\",\"        return dataset\"]},{\"dataset\":{\"alias\":\"Input\",\"name\":\"\",\"description\":\"\",\"datasource\":{\"lastmodifiedby\":\"admin\",\"lastmodifieddate\":\"2021-04-09 07:03:18\",\"alias\":\"leo1311\",\"id\":15,\"name\":\"leo1311\",\"description\":\"Local data for setup\",\"type\":\"MYSQL\",\"connectionDetails\":\"{\\\"password\\\":\\\"@datasourcepass\\\",\\\"datasource\\\":\\\"\\\",\\\"userName\\\":\\\"@datasourceuser\\\",\\\"url\\\":\\\"@datasourceurl/leapmaster_ref_data\\\"}\",\"salt\":\"E1uP5fNKX66G/tyeT1Vz304MwyOa8urMohnCakE/bOnYf47zC+u9Q9+8tmjhlUagunL858NTWkxGo3bqHg9tEw==\",\"organization\":\"leo1311\",\"dshashcode\":\"2b057d5ee2557413a31224216f8d9e39708e21676559b1290e6a545f46d59dc8\",\"activetime\":null,\"category\":\"SQL\"},\"schema\":null,\"type\":\"r\",\"attributes\":{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"Select number, CAST(clean_text as CHAR) as clean_text from @projectname_tickets_enriched where clean_text is not null and clean_text != \''\'' \",\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"},\"expStatus\":0,\"backingDataset\":\"\",\"organization\":\"leo1311\",\"groups\":[]}}]}]}' WHERE name='ACMNGRMN92761' AND organization='leo1311';            
		</sql>			
	</changeSet> 
	<changeSet author="Leap" id="1312v0-cip-366327">
		<sql dbms="mysql" splitStatements="true" stripComments="true">  
			UPDATE mlpipeline SET json_content='{\"elements\":[{\"attributes\":{\"filetype\":\"Python3\",\"files\":[\"ACMKYPHR40814_leo1311.py\"],\"arguments\":[{\"name\":\"LEAPDS\",\"value\":\"leo1311\",\"type\":\"Datasource\",\"index\":\"1\"},{\"name\":\"TableName\",\"value\":\"@projectname_phrase_extraction\",\"type\":\"Text\",\"index\":\"2\",\"alias\":\"@projectname_phrase_extraction\"}],\"dataset\":[]}}]}' WHERE name='ACMKYPHR40814' AND organization='leo1311';	
			DELETE FROM mlpipelinenativescriptentity WHERE cname='ACMKYPHR40814' AND organization='leo1311';
			DELETE FROM mlpipelinenativescriptentity WHERE cname='SNOW_Get_API' AND organization='leo1311';
			UPDATE mldataset SET attributes='{"filter":"","mode":"query","Query":"SELECT EASE,COUNT(*) AS COUNT, ROUND((CAST(COUNT(*) AS FLOAT )/CAST((SELECT COUNT(*) FROM @projectname_tickets ) AS FLOAT))*100,2) AS PERCENT FROM @projectname_tickets_enriched te JOIN @projectname_EASEMapping map ON te.mapped_phrase =map.Key_Word  WHERE ease = {ease} GROUP BY ease","Cacheable":"false","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{\'ease\':\'ease\'}","tableName":"","uniqueIdentifier":""}' WHERE name='ease_TotalTickets' AND organization='leo1311';
			UPDATE mldataset SET attributes='{"filter":"","mode":"query","Query":"SELECT mapped_phrase AS KEYWORD, COUNT(*) as COUNT, ROUND((CAST(COUNT(*) AS FLOAT )/CAST((SELECT COUNT(*) FROM @projectname_tickets ) AS FLOAT))*100,2) AS PERCENT FROM @projectname_tickets_enriched te JOIN @projectname_EASEMapping map ON te.mapped_phrase =map.Key_Word  WHERE  ease = {ease} GROUP BY mapped_phrase ORDER BY COUNT(*) DESC","Cacheable":"false","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{\'ease\':\'ease\'}","tableName":"","uniqueIdentifier":""}' WHERE name='ease_distributionByKeyword' AND organization='leo1311';
		</sql>			
	</changeSet>
	
	<changeSet author="Leap" id="1312v0-cip-postgres-366327">
		<sql dbms="postgresql" splitStatements="true" stripComments="true">  
			UPDATE core.mlpipeline SET json_content='{\"elements\":[{\"attributes\":{\"filetype\":\"Python3\",\"files\":[\"ACMKYPHR40814_leo1311.py\"],\"arguments\":[{\"name\":\"LEAPDS\",\"value\":\"leo1311\",\"type\":\"Datasource\",\"index\":\"1\"},{\"name\":\"TableName\",\"value\":\"@projectname_phrase_extraction\",\"type\":\"Text\",\"index\":\"2\",\"alias\":\"@projectname_phrase_extraction\"}],\"dataset\":[]}}]}' WHERE name='ACMKYPHR40814' AND organization='leo1311';	
			DELETE FROM core.mlpipelinenativescriptentity WHERE cname='ACMKYPHR40814' AND organization='leo1311';
			DELETE FROM core.mlpipelinenativescriptentity WHERE cname='SNOW_Get_API' AND organization='leo1311';
			UPDATE core.mldataset SET attributes='{"filter":"","mode":"query","Query":"SELECT EASE,COUNT(*) AS COUNT, ROUND((CAST(COUNT(*) AS FLOAT )/CAST((SELECT COUNT(*) FROM @projectname_tickets ) AS FLOAT))*100,2) AS PERCENT FROM @projectname_tickets_enriched te JOIN @projectname_EASEMapping map ON te.mapped_phrase =map.Key_Word  WHERE ease = {ease} GROUP BY ease","Cacheable":"false","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{\''ease\'':\''ease\''}","tableName":"","uniqueIdentifier":""}' WHERE name='ease_TotalTickets' AND organization='leo1311';
			UPDATE core.mldataset SET attributes='{"filter":"","mode":"query","Query":"SELECT mapped_phrase AS KEYWORD, COUNT(*) as COUNT, ROUND((CAST(COUNT(*) AS FLOAT )/CAST((SELECT COUNT(*) FROM @projectname_tickets ) AS FLOAT))*100,2) AS PERCENT FROM @projectname_tickets_enriched te JOIN @projectname_EASEMapping map ON te.mapped_phrase =map.Key_Word  WHERE  ease = {ease} GROUP BY mapped_phrase ORDER BY COUNT(*) DESC","Cacheable":"false","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{\''ease\'':\''ease\''}","tableName":"","uniqueIdentifier":""}' WHERE name='ease_distributionByKeyword' AND organization='leo1311';
		</sql>			
	</changeSet>
	<changeSet dbms="mysql,postgresql" author="Leap (generated)" id="1312v0-cip-366328">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="db/changelog/data/1312v0/cip/mlpipelinenativescriptentity-mysql.csv" quotchar="&quot;" separator="," tableName="mlpipelinenativescriptentity">
            <column header="id" name="id" type="NUMERIC"/>
            <column header="cname" name="cname" type="STRING"/>
            <column header="filename" name="filename" type="STRING"/>
            <column header="filescript" name="filescript" type="BLOB"/>
            <column header="organization" name="organization" type="STRING"/>
        </loadData>
    </changeSet>
    <changeSet author="Leap" id="1312v0-cip-366329">
		<sql dbms="mysql,mssql" splitStatements="true" stripComments="true">  
			UPDATE mldataset SET attributes='{"filter":"","mode":"query","Query":"SELECT  EASE ,  ROUND((CAST(COUNT(*) AS FLOAT )/CAST((SELECT COUNT(*) FROM @projectname_tickets ) AS FLOAT))*100,2) AS COUNT FROM @projectname_tickets_enriched te JOIN @projectname_EASEMapping map ON te.mapped_phrase =map.Key_Word  GROUP BY ease","Cacheable":"false","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":""}' WHERE name='DistributionByEASE' AND organization='leo1311';
			UPDATE mldataset SET attributes='{"filter":"","mode":"query","Query":"SELECT category,COUNT(*), ROUND((COUNT(*)/(SELECT COUNT(*) FROM @projectname_tickets )*100),2) AS percent FROM @projectname_tickets_enriched te JOIN @projectname_EASEMapping map ON te.mapped_phrase =map.Key_Word WHERE  ease = {ease} GROUP BY category order by count(*) desc","Cacheable":"false","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{''ease'':''ease''}","tableName":"","uniqueIdentifier":""}' WHERE name='ease_ditributionByCategory' AND organization='leo1311';
			UPDATE mldataset SET attributes='{"filter":"","mode":"query","Query":"SELECT REPLACE(mapped_phrase,'' '', ''_'') as PHRASE FROM @projectname_tickets_enriched te JOIN @projectname_EASEMapping map ON te.mapped_phrase =map.Key_Word  WHERE  ease = {ease}","Cacheable":"false","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{''ease'':''ease''}","tableName":"","uniqueIdentifier":""}' WHERE name='ease_wordcloud' AND organization='leo1311';
			UPDATE mldataset SET attributes='{"filter":"","mode":"query","Query":"SELECT Number, extracted_phrase as Pattern ,  mapped_phrase as Keyword, Category , EASE , CONCAT(ROUND( mapped_phrase_confidennce*100 ,2) ,''%'')AS ConfidenceScore FROM @projectname_tickets_enriched te JOIN @projectname_EASEMapping map ON te.mapped_phrase =map.Key_Word  WHERE ease = {ease} ORDER BY mapped_phrase_confidennce DESC","Cacheable":"false","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{''ease'':''ease''}","tableName":"","uniqueIdentifier":""}' WHERE name='ease_tickets' AND organization='leo1311';
		</sql>			
	</changeSet>
	<changeSet author="Leap" id="1312v0-cip-postgres-366329">
		<sql dbms="postgresql" splitStatements="true" stripComments="true">  
			UPDATE core.mldataset SET attributes='{"filter":"","mode":"query","Query":"SELECT  EASE ,  ROUND((CAST(COUNT(*) AS FLOAT )/CAST((SELECT COUNT(*) FROM @projectname_tickets ) AS FLOAT))*100,2) AS COUNT FROM @projectname_tickets_enriched te JOIN @projectname_EASEMapping map ON te.mapped_phrase =map.Key_Word  GROUP BY ease","Cacheable":"false","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":""}' WHERE name='DistributionByEASE' AND organization='leo1311';
			UPDATE core.mldataset SET attributes='{"filter":"","mode":"query","Query":"SELECT category,COUNT(*), ROUND((COUNT(*)/(SELECT COUNT(*) FROM @projectname_tickets )*100),2) AS percent FROM @projectname_tickets_enriched te JOIN @projectname_EASEMapping map ON te.mapped_phrase =map.Key_Word WHERE  ease = {ease} GROUP BY category order by count(*) desc","Cacheable":"false","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{''ease'':''ease''}","tableName":"","uniqueIdentifier":""}' WHERE name='ease_ditributionByCategory' AND organization='leo1311';
			UPDATE core.mldataset SET attributes='{"filter":"","mode":"query","Query":"SELECT REPLACE(mapped_phrase,'' '', ''_'') as PHRASE FROM @projectname_tickets_enriched te JOIN @projectname_EASEMapping map ON te.mapped_phrase =map.Key_Word  WHERE  ease = {ease}","Cacheable":"false","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{''ease'':''ease''}","tableName":"","uniqueIdentifier":""}' WHERE name='ease_wordcloud' AND organization='leo1311';
			UPDATE core.mldataset SET attributes='{"filter":"","mode":"query","Query":"SELECT Number, extracted_phrase as Pattern ,  mapped_phrase as Keyword, Category , EASE , CONCAT(ROUND( mapped_phrase_confidennce*100 ,2) ,''%'')AS ConfidenceScore FROM @projectname_tickets_enriched te JOIN @projectname_EASEMapping map ON te.mapped_phrase =map.Key_Word  WHERE ease = {ease} ORDER BY mapped_phrase_confidennce DESC","Cacheable":"false","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{''ease'':''ease''}","tableName":"","uniqueIdentifier":""}' WHERE name='ease_tickets' AND organization='leo1311';
		</sql>			
	</changeSet>
	<changeSet author="Leap" id="1312v0-cip-366330">
		<sql dbms="mysql" splitStatements="true" stripComments="true">  
			UPDATE mlplugin SET plugin='[\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"vocabSize\": \"text\"\r\n		},\r\n		\"classname\": \"CountVectorizerFeatureExtractorConfig\",\r\n		\"name\": \"Count Vectorizer\",\r\n		\"alias\": \"Count Vectorizer\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"vocabSize\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"FeatureExtractorConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\"\r\n		},\r\n		\"classname\": \"TfFeatureExtractorConfig\",\r\n		\"name\": \"TF\",\r\n		\"alias\": \"TF\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"FeatureExtractorConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\"\r\n		},\r\n		\"classname\": \"IdfFeatureExtractorConfig\",\r\n		\"name\": \"IDF\",\r\n		\"alias\": \"IDF\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"FeatureExtractorConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"script\": \"textarea\"\r\n		},\r\n		\"classname\": \"PythonScriptTransformerConfig\",\r\n		\"name\": \"Python Script Transformer\",\r\n		\"alias\": \"Python Script Transformer\",\r\n		\"attributes\": {\r\n			\"script\": [\r\n				\"import logging\\r\",\r\n				\"class CustomPythonClass():\\r\",\r\n				\"    def __main__(self, dataset):\\r\",\r\n				\"            \\r\",\r\n				\"        return dataset\"\r\n			]\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"textarea\",\r\n			\"outputCol\": \"textarea\",\r\n			\"tags\": \"textarea\"\r\n		},\r\n		\"classname\": \"WordLemmetizerTransformerConfig\",\r\n		\"name\": \"Word Lemmetizer\",\r\n		\"alias\": \"Word Lemmetizer\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"tags\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"textarea\",\r\n			\"outputCol\": \"textarea\"\r\n		},\r\n		\"classname\": \"WordStemmerTransformerConfig\",\r\n		\"name\": \"Word Stemmer\",\r\n		\"alias\": \"Word Stemmer\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"smoothing\": \"text\",\r\n			\"modelType\": \"text\"\r\n		},\r\n		\"classname\": \"NaiveBayesTransformerConfig\",\r\n		\"name\": \"Naive Bayes\",\r\n		\"alias\": \"Naive Bayes\",\r\n		\"attributes\": {\r\n			\"smoothing\": \"\",\r\n			\"modelType\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\"\r\n		},\r\n		\"classname\": \"TokenizerTransformerConfig\",\r\n		\"name\": \"Tokenizer\",\r\n		\"alias\": \"Tokenizer\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"pattern\": \"text\"\r\n		},\r\n		\"classname\": \"RegexTokenizerTransformerConfig\",\r\n		\"name\": \"Regex Tokenizer\",\r\n		\"alias\": \"Regex Tokenizer\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"pattern\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCols\": \"text\",\r\n			\"outputCol\": \"text\"\r\n		},\r\n		\"classname\": \"VectorAssemblerTransformerConfig\",\r\n		\"name\": \"Vector Assembler\",\r\n		\"alias\": \"Vector Assembler\",\r\n		\"attributes\": {\r\n			\"inputCols\": \"\",\r\n			\"outputCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"withStd\": \"text\",\r\n			\"withMean\": \"text\"\r\n		},\r\n		\"classname\": \"StandardScalerTransformerConfig\",\r\n		\"name\": \"Standard Scaler\",\r\n		\"alias\": \"Standard Scaler\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"withStd\": \"\",\r\n			\"withMean\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"K\": \"text\"\r\n		},\r\n		\"classname\": \"PCATransformerConfig\",\r\n		\"name\": \"PCA\",\r\n		\"alias\": \"PCA\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"K\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"K\": \"text\"\r\n		},\r\n		\"classname\": \"KMeansTransformerConfig\",\r\n		\"name\": \"K Means\",\r\n		\"alias\": \"K Means\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"K\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"checkpointInterval\": \"text\",\r\n			\"K\": \"text\"\r\n		},\r\n		\"classname\": \"LDAConfig\",\r\n		\"name\": \"LDA\",\r\n		\"alias\": \"LDA\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"checkpointInterval\": \"\",\r\n			\"K\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"modelName\": \"text\"\r\n		},\r\n		\"classname\": \"ModelSinkConfig\",\r\n		\"name\": \"Model Sink\",\r\n		\"alias\": \"Model Sink\",\r\n		\"attributes\": {\r\n			\"modelName\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"BaseConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"modelName\": \"text\"\r\n		},\r\n		\"classname\": \"ModelSourceConfig\",\r\n		\"name\": \"Model Source\",\r\n		\"alias\": \"Model Source\",\r\n		\"attributes\": {\r\n			\"modelName\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"BaseConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"params\": \"textarea\",\r\n			\"script\": \"textarea\"\r\n		},\r\n		\"classname\": \"PostProcessingScriptConfig\",\r\n		\"name\": \"Post Processing Script\",\r\n		\"alias\": \"Post Processing Script\",\r\n		\"attributes\": {\r\n			\"params\": \"\",\r\n			\"script\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"BaseConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\",\r\n			\"out2\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"params\": \"textarea\",\r\n			\"script\": \"textarea\"\r\n		},\r\n		\"classname\": \"PreProcessingScriptConfig\",\r\n		\"name\": \"Pre Processing Script\",\r\n		\"alias\": \"Pre Processing Script\",\r\n		\"attributes\": {\r\n			\"params\": \"\",\r\n			\"script\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"BaseConfig\",\r\n		\"inputEndpoints\": [\r\n			\"dataset1\",\r\n			\"dataset2\",\r\n			\"dataset3\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"labelCol\": \"text\",\r\n			\"featuresCol\": \"text\",\r\n			\"numTrees\": \"text\"\r\n		},\r\n		\"classname\": \"RandomForestClassifierConfig\",\r\n		\"name\": \"Random Forest Classifier\",\r\n		\"alias\": \"Random Forest Classifier\",\r\n		\"attributes\": {\r\n			\"labelCol\": \"\",\r\n			\"featuresCol\": \"\",\r\n			\"numTrees\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"AnalyzerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"stopWords\": \"text\"\r\n		},\r\n		\"classname\": \"StopWordsRemoverTransformerConfig\",\r\n		\"name\": \"Stop Words Remover\",\r\n		\"alias\": \"Stop Words Remover\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"stopWords\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"n\": \"text\",\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\"\r\n		},\r\n		\"classname\": \"NgramTransformerConfig\",\r\n		\"name\": \"N Gram\",\r\n		\"alias\": \"N Gram\",\r\n		\"attributes\": {\r\n			\"n\": \"\",\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"inverse\": \"text\"\r\n		},\r\n		\"classname\": \"DiscreteCosineTransformTransformerConfig\",\r\n		\"name\": \"Discrete Cosine Transform\",\r\n		\"alias\": \"Discrete Cosine Transform\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"inverse\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCols\": \"text\",\r\n			\"outputCols\": \"text\"\r\n		},\r\n		\"classname\": \"StringIndexerTransformerConfig\",\r\n		\"name\": \"String Indexer\",\r\n		\"alias\": \"String Indexer\",\r\n		\"attributes\": {\r\n			\"inputCols\": \"\",\r\n			\"outputCols\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"p\": \"text\"\r\n		},\r\n		\"classname\": \"NormalizerTransformerConfig\",\r\n		\"name\": \"Normalizer\",\r\n		\"alias\": \"Normalizer\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"p\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\"\r\n		},\r\n		\"classname\": \"MinMaxScalerTransformerConfig\",\r\n		\"name\": \"Min Max Scaler\",\r\n		\"alias\": \"Min Max Scaler\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"statement\": \"text\"\r\n		},\r\n		\"classname\": \"SQLTransformerConfig\",\r\n		\"name\": \"SQL Transformer\",\r\n		\"alias\": \"SQL Transformer\",\r\n		\"attributes\": {\r\n			\"statement\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCols\": \"text\"\r\n		},\r\n		\"classname\": \"AnomolyDetectionConfig\",\r\n		\"name\": \"Anomoly Detection\",\r\n		\"alias\": \"Anomoly Detection\",\r\n		\"attributes\": {\r\n			\"inputCols\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"DomainSolutionConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCols\": \"text\",\r\n			\"predictionCount\": \"text\",\r\n			\"seasonality\": \"text\"\r\n		},\r\n		\"classname\": \"ARIMAModelConfig\",\r\n		\"name\": \"ARIMA\",\r\n		\"alias\": \"ARIMA\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"predictionCount\": \"\",\r\n			\"seasonality\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"DomainSolutionConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCols\": \"text\",\r\n			\"predictionCount\": \"text\",\r\n			\"groupCol\": \"text\"\r\n		},\r\n		\"classname\": \"ARIMAGroupedConfig\",\r\n		\"name\": \"ARIMA Grouped\",\r\n		\"alias\": \"ARIMA Grouped\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"predictionCount\": \"\",\r\n			\"groupCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"DomainSolutionConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCols\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"ambiguousWords\": \"text\"\r\n		},\r\n		\"classname\": \"CleanTicketsConfig\",\r\n		\"name\": \"Clean Tickets\",\r\n		\"alias\": \"Clean Tickets\",\r\n		\"attributes\": {\r\n			\"inputCols\": \"\",\r\n			\"outputCol\": \"clean_text\",\r\n			\"ambiguousWords\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"DomainSolutionConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"UniqueIdColumn\": \"text\",\r\n			\"GroupByColumn\": \"text\",\r\n			\"TextColumn\": \"text\",\r\n			\"customStopWords\": \"text\",\r\n			\"vocabSize\": \"text\",\r\n			\"ClusterCount\": \"text\",\r\n			\"checkPointInterval\": \"text\",\r\n			\"saveModels\": \"checkbox\"\r\n		},\r\n		\"classname\": \"IncidentClusteringLDAConfig\",\r\n		\"name\": \"Incident Clustering\",\r\n		\"alias\": \"Incident Clustering\",\r\n		\"attributes\": {\r\n			\"UniqueIdColumn\": \"\",\r\n			\"GroupByColumn\": \"\",\r\n			\"TextColumn\": \"\",\r\n			\"customStopWords\": \"\",\r\n			\"vocabSize\": \"\",\r\n			\"ClusterCount\": \"\",\r\n			\"checkPointInterval\": \"\",\r\n			\"saveModels\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"DomainSolutionConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"topics\",\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCols\": \"text\"\r\n		},\r\n		\"classname\": \"PhishingDetectionConfig\",\r\n		\"name\": \"Phishing Detection\",\r\n		\"alias\": \"Phishing Detection\",\r\n		\"attributes\": {\r\n			\"inputCols\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"DomainSolutionConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"labelCol\": \"text\",\r\n			\"featuresCol\": \"text\"\r\n		},\r\n		\"classname\": \"LogisticRegressionConfig\",\r\n		\"name\": \"Logistic Regression\",\r\n		\"alias\": \"Logistic Regression\",\r\n		\"attributes\": {\r\n			\"labelCol\": \"\",\r\n			\"featuresCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"AnalyzerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"labelCol\": \"text\",\r\n			\"featuresCol\": \"text\"\r\n		},\r\n		\"classname\": \"DecisionTreeClassifierConfig\",\r\n		\"name\": \"Decision Tree Classifier\",\r\n		\"alias\": \"Decision Tree Classifier\",\r\n		\"attributes\": {\r\n			\"labelCol\": \"\",\r\n			\"featuresCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"AnalyzerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"labelCol\": \"text\",\r\n			\"featuresCol\": \"text\",\r\n			\"maxIter\": \"text\"\r\n		},\r\n		\"classname\": \"GBTClassifierConfig\",\r\n		\"name\": \"GBT Classifier\",\r\n		\"alias\": \"GBT Classifier\",\r\n		\"attributes\": {\r\n			\"labelCol\": \"\",\r\n			\"featuresCol\": \"\",\r\n			\"maxIter\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"AnalyzerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"labelCol\": \"text\",\r\n			\"featuresCol\": \"text\",\r\n			\"maxIter\": \"text\",\r\n			\"regParam\": \"text\"\r\n		},\r\n		\"classname\": \"LinearSVCConfig\",\r\n		\"name\": \"Linear SVC\",\r\n		\"alias\": \"Linear SVC\",\r\n		\"attributes\": {\r\n			\"labelCol\": \"\",\r\n			\"featuresCol\": \"\",\r\n			\"maxIter\": \"\",\r\n			\"regParam\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"AnalyzerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"labelCol\": \"text\",\r\n			\"featuresCol\": \"text\",\r\n			\"maxIter\": \"text\",\r\n			\"regParam\": \"text\",\r\n			\"elasticNetParam\": \"text\"\r\n		},\r\n		\"classname\": \"LinearRegressionConfig\",\r\n		\"name\": \"Linear Regression\",\r\n		\"alias\": \"Linear Regression\",\r\n		\"attributes\": {\r\n			\"labelCol\": \"\",\r\n			\"featuresCol\": \"\",\r\n			\"maxIter\": \"\",\r\n			\"regParam\": \"\",\r\n			\"elasticNetParam\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"AnalyzerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"featuresCol\": \"text\",\r\n			\"labelCol\": \"text\"\r\n		},\r\n		\"classname\": \"RandomForestRegressorConfig\",\r\n		\"name\": \"Random Forest Regressor\",\r\n		\"alias\": \"Random Forest Regressor\",\r\n		\"attributes\": {\r\n			\"featuresCol\": \"\",\r\n			\"labelCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"AnalyzerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"dataset\": \"dropdown\",\r\n			\"isValidation\": \"checkbox\",\r\n			\"samplingRatio\": \"text\",\r\n			\"applySchema\": \"checkbox\"\r\n		},\r\n		\"classname\": \"DatasetExtractorConfig\",\r\n		\"name\": \"Dataset Extractor\",\r\n		\"alias\": \"Dataset Dataset\",\r\n		\"attributes\": {\r\n			\"dataset\": \"\",\r\n			\"isValidation\": \"\",\r\n			\"samplingRatio\": \"\",\r\n			\"applySchema\": false\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"ExtractorConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"seed\": \"text\"\r\n		},\r\n		\"classname\": \"Word2VecFeatureExtractorConfig\",\r\n		\"name\": \"Word2Vec\",\r\n		\"alias\": \"Word2Vec\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"seed\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"FeatureExtractorConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCols\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"categoricalCols\": \"text\"\r\n		},\r\n		\"classname\": \"FeatureHasherFeatureExtractorConfig\",\r\n		\"name\": \"FeatureHasher\",\r\n		\"alias\": \"FeatureHasher\",\r\n		\"attributes\": {\r\n			\"inputCols\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"categoricalCols\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"FeatureExtractorConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\"\r\n		},\r\n		\"classname\": \"BinarizerTransformerConfig\",\r\n		\"name\": \"Binarizer\",\r\n		\"alias\": \"Binarizer\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\"\r\n		},\r\n		\"classname\": \"PolynomialExpansionConfig\",\r\n		\"name\": \"PolynomialExpansion\",\r\n		\"alias\": \"PolynomialExpansion\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"labels\": \"text\"\r\n		},\r\n		\"classname\": \"IndexToStringTransformerConfig\",\r\n		\"name\": \"IndexToString\",\r\n		\"alias\": \"IndexToString\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"labels\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCols\": \"text\",\r\n			\"outputCols\": \"text\"\r\n		},\r\n		\"classname\": \"OneHotEncoderEstimatorTransformerConfig\",\r\n		\"name\": \"OneHotEncoderEstimator\",\r\n		\"alias\": \"OneHotEncoderEstimator\",\r\n		\"attributes\": {\r\n			\"inputCols\": \"\",\r\n			\"outputCols\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\"\r\n		},\r\n		\"classname\": \"VectorIndexerTransformerConfig\",\r\n		\"name\": \"VectorIndexer\",\r\n		\"alias\": \"VectorIndexer\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\"\r\n		},\r\n		\"classname\": \"MaxAbsScalerTransformerConfig\",\r\n		\"name\": \"MaxAbsScaler\",\r\n		\"alias\": \"MaxAbsScaler\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"splits\": \"text\"\r\n		},\r\n		\"classname\": \"BucketizerTransformerConfig\",\r\n		\"name\": \"Bucketizer\",\r\n		\"alias\": \"Bucketizer\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"splits\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"scalingVec\": \"text\"\r\n		},\r\n		\"classname\": \"ElementWiseProductTransformerConfig\",\r\n		\"name\": \"ElementWiseProduct\",\r\n		\"alias\": \"ElementWiseProduct\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"scalingVec\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"size\": \"text\"\r\n		},\r\n		\"classname\": \"VectorSizeHintTransformerConfig\",\r\n		\"name\": \"VectorSizeHint\",\r\n		\"alias\": \"VectorSizeHint\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"size\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"dataset\": \"dropdown\",\r\n			\"applySchema\": \"checkbox\"\r\n		},\r\n		\"classname\": \"DatasetLoaderConfig\",\r\n		\"name\": \"Dataset Loader\",\r\n		\"alias\": \"Dataset Loader\",\r\n		\"attributes\": {\r\n			\"dataset\": \"\",\r\n			\"applySchema\": false\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"LoaderConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"query\": \"text\"\r\n		},\r\n		\"classname\": \"HiveExtractorConfig\",\r\n		\"name\": \"Hive Extractor\",\r\n		\"alias\": \"Hive Extractor\",\r\n		\"attributes\": {\r\n			\"query\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"ExtractorConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"tableName\": \"text\",\r\n			\"writeMode\": \"text\"\r\n		},\r\n		\"classname\": \"HiveLoaderConfig\",\r\n		\"name\": \"Hive Loader\",\r\n		\"alias\": \"Hive Loader\",\r\n		\"attributes\": {\r\n			\"tableName\": \"\",\r\n			\"writeMode\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"LoaderConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"arguments\": \"text\",\r\n			\"id\": \"text\"\r\n		},\r\n		\"classname\": \"XYZ_test\",\r\n		\"name\": \"XYZ_test\",\r\n		\"alias\": \"XYZ_test\",\r\n		\"attributes\": {\r\n			\"arguments\": \"\",\r\n			\"id\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	}\r\n]' where name='genericPython' and type='DragAndDrop';
		</sql>			
	</changeSet>
	
	<changeSet author="Leap" id="1312v0-cip-postgres-366330">
		<sql dbms="postgresql" splitStatements="true" stripComments="true">  
			UPDATE core.mlplugin SET plugin='[\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"vocabSize\": \"text\"\r\n		},\r\n		\"classname\": \"CountVectorizerFeatureExtractorConfig\",\r\n		\"name\": \"Count Vectorizer\",\r\n		\"alias\": \"Count Vectorizer\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"vocabSize\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"FeatureExtractorConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\"\r\n		},\r\n		\"classname\": \"TfFeatureExtractorConfig\",\r\n		\"name\": \"TF\",\r\n		\"alias\": \"TF\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"FeatureExtractorConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\"\r\n		},\r\n		\"classname\": \"IdfFeatureExtractorConfig\",\r\n		\"name\": \"IDF\",\r\n		\"alias\": \"IDF\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"FeatureExtractorConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"script\": \"textarea\"\r\n		},\r\n		\"classname\": \"PythonScriptTransformerConfig\",\r\n		\"name\": \"Python Script Transformer\",\r\n		\"alias\": \"Python Script Transformer\",\r\n		\"attributes\": {\r\n			\"script\": [\r\n				\"import logging\\r\",\r\n				\"class CustomPythonClass():\\r\",\r\n				\"    def __main__(self, dataset):\\r\",\r\n				\"            \\r\",\r\n				\"        return dataset\"\r\n			]\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"textarea\",\r\n			\"outputCol\": \"textarea\",\r\n			\"tags\": \"textarea\"\r\n		},\r\n		\"classname\": \"WordLemmetizerTransformerConfig\",\r\n		\"name\": \"Word Lemmetizer\",\r\n		\"alias\": \"Word Lemmetizer\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"tags\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"textarea\",\r\n			\"outputCol\": \"textarea\"\r\n		},\r\n		\"classname\": \"WordStemmerTransformerConfig\",\r\n		\"name\": \"Word Stemmer\",\r\n		\"alias\": \"Word Stemmer\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"smoothing\": \"text\",\r\n			\"modelType\": \"text\"\r\n		},\r\n		\"classname\": \"NaiveBayesTransformerConfig\",\r\n		\"name\": \"Naive Bayes\",\r\n		\"alias\": \"Naive Bayes\",\r\n		\"attributes\": {\r\n			\"smoothing\": \"\",\r\n			\"modelType\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\"\r\n		},\r\n		\"classname\": \"TokenizerTransformerConfig\",\r\n		\"name\": \"Tokenizer\",\r\n		\"alias\": \"Tokenizer\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"pattern\": \"text\"\r\n		},\r\n		\"classname\": \"RegexTokenizerTransformerConfig\",\r\n		\"name\": \"Regex Tokenizer\",\r\n		\"alias\": \"Regex Tokenizer\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"pattern\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCols\": \"text\",\r\n			\"outputCol\": \"text\"\r\n		},\r\n		\"classname\": \"VectorAssemblerTransformerConfig\",\r\n		\"name\": \"Vector Assembler\",\r\n		\"alias\": \"Vector Assembler\",\r\n		\"attributes\": {\r\n			\"inputCols\": \"\",\r\n			\"outputCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"withStd\": \"text\",\r\n			\"withMean\": \"text\"\r\n		},\r\n		\"classname\": \"StandardScalerTransformerConfig\",\r\n		\"name\": \"Standard Scaler\",\r\n		\"alias\": \"Standard Scaler\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"withStd\": \"\",\r\n			\"withMean\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"K\": \"text\"\r\n		},\r\n		\"classname\": \"PCATransformerConfig\",\r\n		\"name\": \"PCA\",\r\n		\"alias\": \"PCA\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"K\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"K\": \"text\"\r\n		},\r\n		\"classname\": \"KMeansTransformerConfig\",\r\n		\"name\": \"K Means\",\r\n		\"alias\": \"K Means\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"K\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"checkpointInterval\": \"text\",\r\n			\"K\": \"text\"\r\n		},\r\n		\"classname\": \"LDAConfig\",\r\n		\"name\": \"LDA\",\r\n		\"alias\": \"LDA\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"checkpointInterval\": \"\",\r\n			\"K\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"modelName\": \"text\"\r\n		},\r\n		\"classname\": \"ModelSinkConfig\",\r\n		\"name\": \"Model Sink\",\r\n		\"alias\": \"Model Sink\",\r\n		\"attributes\": {\r\n			\"modelName\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"BaseConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"modelName\": \"text\"\r\n		},\r\n		\"classname\": \"ModelSourceConfig\",\r\n		\"name\": \"Model Source\",\r\n		\"alias\": \"Model Source\",\r\n		\"attributes\": {\r\n			\"modelName\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"BaseConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"params\": \"textarea\",\r\n			\"script\": \"textarea\"\r\n		},\r\n		\"classname\": \"PostProcessingScriptConfig\",\r\n		\"name\": \"Post Processing Script\",\r\n		\"alias\": \"Post Processing Script\",\r\n		\"attributes\": {\r\n			\"params\": \"\",\r\n			\"script\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"BaseConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\",\r\n			\"out2\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"params\": \"textarea\",\r\n			\"script\": \"textarea\"\r\n		},\r\n		\"classname\": \"PreProcessingScriptConfig\",\r\n		\"name\": \"Pre Processing Script\",\r\n		\"alias\": \"Pre Processing Script\",\r\n		\"attributes\": {\r\n			\"params\": \"\",\r\n			\"script\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"BaseConfig\",\r\n		\"inputEndpoints\": [\r\n			\"dataset1\",\r\n			\"dataset2\",\r\n			\"dataset3\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"labelCol\": \"text\",\r\n			\"featuresCol\": \"text\",\r\n			\"numTrees\": \"text\"\r\n		},\r\n		\"classname\": \"RandomForestClassifierConfig\",\r\n		\"name\": \"Random Forest Classifier\",\r\n		\"alias\": \"Random Forest Classifier\",\r\n		\"attributes\": {\r\n			\"labelCol\": \"\",\r\n			\"featuresCol\": \"\",\r\n			\"numTrees\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"AnalyzerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"stopWords\": \"text\"\r\n		},\r\n		\"classname\": \"StopWordsRemoverTransformerConfig\",\r\n		\"name\": \"Stop Words Remover\",\r\n		\"alias\": \"Stop Words Remover\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"stopWords\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"n\": \"text\",\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\"\r\n		},\r\n		\"classname\": \"NgramTransformerConfig\",\r\n		\"name\": \"N Gram\",\r\n		\"alias\": \"N Gram\",\r\n		\"attributes\": {\r\n			\"n\": \"\",\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"inverse\": \"text\"\r\n		},\r\n		\"classname\": \"DiscreteCosineTransformTransformerConfig\",\r\n		\"name\": \"Discrete Cosine Transform\",\r\n		\"alias\": \"Discrete Cosine Transform\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"inverse\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCols\": \"text\",\r\n			\"outputCols\": \"text\"\r\n		},\r\n		\"classname\": \"StringIndexerTransformerConfig\",\r\n		\"name\": \"String Indexer\",\r\n		\"alias\": \"String Indexer\",\r\n		\"attributes\": {\r\n			\"inputCols\": \"\",\r\n			\"outputCols\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"p\": \"text\"\r\n		},\r\n		\"classname\": \"NormalizerTransformerConfig\",\r\n		\"name\": \"Normalizer\",\r\n		\"alias\": \"Normalizer\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"p\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\"\r\n		},\r\n		\"classname\": \"MinMaxScalerTransformerConfig\",\r\n		\"name\": \"Min Max Scaler\",\r\n		\"alias\": \"Min Max Scaler\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"statement\": \"text\"\r\n		},\r\n		\"classname\": \"SQLTransformerConfig\",\r\n		\"name\": \"SQL Transformer\",\r\n		\"alias\": \"SQL Transformer\",\r\n		\"attributes\": {\r\n			\"statement\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCols\": \"text\"\r\n		},\r\n		\"classname\": \"AnomolyDetectionConfig\",\r\n		\"name\": \"Anomoly Detection\",\r\n		\"alias\": \"Anomoly Detection\",\r\n		\"attributes\": {\r\n			\"inputCols\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"DomainSolutionConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCols\": \"text\",\r\n			\"predictionCount\": \"text\",\r\n			\"seasonality\": \"text\"\r\n		},\r\n		\"classname\": \"ARIMAModelConfig\",\r\n		\"name\": \"ARIMA\",\r\n		\"alias\": \"ARIMA\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"predictionCount\": \"\",\r\n			\"seasonality\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"DomainSolutionConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCols\": \"text\",\r\n			\"predictionCount\": \"text\",\r\n			\"groupCol\": \"text\"\r\n		},\r\n		\"classname\": \"ARIMAGroupedConfig\",\r\n		\"name\": \"ARIMA Grouped\",\r\n		\"alias\": \"ARIMA Grouped\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"predictionCount\": \"\",\r\n			\"groupCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"DomainSolutionConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCols\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"ambiguousWords\": \"text\"\r\n		},\r\n		\"classname\": \"CleanTicketsConfig\",\r\n		\"name\": \"Clean Tickets\",\r\n		\"alias\": \"Clean Tickets\",\r\n		\"attributes\": {\r\n			\"inputCols\": \"\",\r\n			\"outputCol\": \"clean_text\",\r\n			\"ambiguousWords\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"DomainSolutionConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"UniqueIdColumn\": \"text\",\r\n			\"GroupByColumn\": \"text\",\r\n			\"TextColumn\": \"text\",\r\n			\"customStopWords\": \"text\",\r\n			\"vocabSize\": \"text\",\r\n			\"ClusterCount\": \"text\",\r\n			\"checkPointInterval\": \"text\",\r\n			\"saveModels\": \"checkbox\"\r\n		},\r\n		\"classname\": \"IncidentClusteringLDAConfig\",\r\n		\"name\": \"Incident Clustering\",\r\n		\"alias\": \"Incident Clustering\",\r\n		\"attributes\": {\r\n			\"UniqueIdColumn\": \"\",\r\n			\"GroupByColumn\": \"\",\r\n			\"TextColumn\": \"\",\r\n			\"customStopWords\": \"\",\r\n			\"vocabSize\": \"\",\r\n			\"ClusterCount\": \"\",\r\n			\"checkPointInterval\": \"\",\r\n			\"saveModels\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"DomainSolutionConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"topics\",\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCols\": \"text\"\r\n		},\r\n		\"classname\": \"PhishingDetectionConfig\",\r\n		\"name\": \"Phishing Detection\",\r\n		\"alias\": \"Phishing Detection\",\r\n		\"attributes\": {\r\n			\"inputCols\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"DomainSolutionConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"labelCol\": \"text\",\r\n			\"featuresCol\": \"text\"\r\n		},\r\n		\"classname\": \"LogisticRegressionConfig\",\r\n		\"name\": \"Logistic Regression\",\r\n		\"alias\": \"Logistic Regression\",\r\n		\"attributes\": {\r\n			\"labelCol\": \"\",\r\n			\"featuresCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"AnalyzerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"labelCol\": \"text\",\r\n			\"featuresCol\": \"text\"\r\n		},\r\n		\"classname\": \"DecisionTreeClassifierConfig\",\r\n		\"name\": \"Decision Tree Classifier\",\r\n		\"alias\": \"Decision Tree Classifier\",\r\n		\"attributes\": {\r\n			\"labelCol\": \"\",\r\n			\"featuresCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"AnalyzerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"labelCol\": \"text\",\r\n			\"featuresCol\": \"text\",\r\n			\"maxIter\": \"text\"\r\n		},\r\n		\"classname\": \"GBTClassifierConfig\",\r\n		\"name\": \"GBT Classifier\",\r\n		\"alias\": \"GBT Classifier\",\r\n		\"attributes\": {\r\n			\"labelCol\": \"\",\r\n			\"featuresCol\": \"\",\r\n			\"maxIter\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"AnalyzerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"labelCol\": \"text\",\r\n			\"featuresCol\": \"text\",\r\n			\"maxIter\": \"text\",\r\n			\"regParam\": \"text\"\r\n		},\r\n		\"classname\": \"LinearSVCConfig\",\r\n		\"name\": \"Linear SVC\",\r\n		\"alias\": \"Linear SVC\",\r\n		\"attributes\": {\r\n			\"labelCol\": \"\",\r\n			\"featuresCol\": \"\",\r\n			\"maxIter\": \"\",\r\n			\"regParam\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"AnalyzerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"labelCol\": \"text\",\r\n			\"featuresCol\": \"text\",\r\n			\"maxIter\": \"text\",\r\n			\"regParam\": \"text\",\r\n			\"elasticNetParam\": \"text\"\r\n		},\r\n		\"classname\": \"LinearRegressionConfig\",\r\n		\"name\": \"Linear Regression\",\r\n		\"alias\": \"Linear Regression\",\r\n		\"attributes\": {\r\n			\"labelCol\": \"\",\r\n			\"featuresCol\": \"\",\r\n			\"maxIter\": \"\",\r\n			\"regParam\": \"\",\r\n			\"elasticNetParam\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"AnalyzerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"featuresCol\": \"text\",\r\n			\"labelCol\": \"text\"\r\n		},\r\n		\"classname\": \"RandomForestRegressorConfig\",\r\n		\"name\": \"Random Forest Regressor\",\r\n		\"alias\": \"Random Forest Regressor\",\r\n		\"attributes\": {\r\n			\"featuresCol\": \"\",\r\n			\"labelCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"AnalyzerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"dataset\": \"dropdown\",\r\n			\"isValidation\": \"checkbox\",\r\n			\"samplingRatio\": \"text\",\r\n			\"applySchema\": \"checkbox\"\r\n		},\r\n		\"classname\": \"DatasetExtractorConfig\",\r\n		\"name\": \"Dataset Extractor\",\r\n		\"alias\": \"Dataset Dataset\",\r\n		\"attributes\": {\r\n			\"dataset\": \"\",\r\n			\"isValidation\": \"\",\r\n			\"samplingRatio\": \"\",\r\n			\"applySchema\": false\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"ExtractorConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"seed\": \"text\"\r\n		},\r\n		\"classname\": \"Word2VecFeatureExtractorConfig\",\r\n		\"name\": \"Word2Vec\",\r\n		\"alias\": \"Word2Vec\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"seed\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"FeatureExtractorConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCols\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"categoricalCols\": \"text\"\r\n		},\r\n		\"classname\": \"FeatureHasherFeatureExtractorConfig\",\r\n		\"name\": \"FeatureHasher\",\r\n		\"alias\": \"FeatureHasher\",\r\n		\"attributes\": {\r\n			\"inputCols\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"categoricalCols\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"FeatureExtractorConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\"\r\n		},\r\n		\"classname\": \"BinarizerTransformerConfig\",\r\n		\"name\": \"Binarizer\",\r\n		\"alias\": \"Binarizer\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\"\r\n		},\r\n		\"classname\": \"PolynomialExpansionConfig\",\r\n		\"name\": \"PolynomialExpansion\",\r\n		\"alias\": \"PolynomialExpansion\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"labels\": \"text\"\r\n		},\r\n		\"classname\": \"IndexToStringTransformerConfig\",\r\n		\"name\": \"IndexToString\",\r\n		\"alias\": \"IndexToString\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"labels\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCols\": \"text\",\r\n			\"outputCols\": \"text\"\r\n		},\r\n		\"classname\": \"OneHotEncoderEstimatorTransformerConfig\",\r\n		\"name\": \"OneHotEncoderEstimator\",\r\n		\"alias\": \"OneHotEncoderEstimator\",\r\n		\"attributes\": {\r\n			\"inputCols\": \"\",\r\n			\"outputCols\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\"\r\n		},\r\n		\"classname\": \"VectorIndexerTransformerConfig\",\r\n		\"name\": \"VectorIndexer\",\r\n		\"alias\": \"VectorIndexer\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\"\r\n		},\r\n		\"classname\": \"MaxAbsScalerTransformerConfig\",\r\n		\"name\": \"MaxAbsScaler\",\r\n		\"alias\": \"MaxAbsScaler\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"splits\": \"text\"\r\n		},\r\n		\"classname\": \"BucketizerTransformerConfig\",\r\n		\"name\": \"Bucketizer\",\r\n		\"alias\": \"Bucketizer\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"splits\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"outputCol\": \"text\",\r\n			\"scalingVec\": \"text\"\r\n		},\r\n		\"classname\": \"ElementWiseProductTransformerConfig\",\r\n		\"name\": \"ElementWiseProduct\",\r\n		\"alias\": \"ElementWiseProduct\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"outputCol\": \"\",\r\n			\"scalingVec\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"inputCol\": \"text\",\r\n			\"size\": \"text\"\r\n		},\r\n		\"classname\": \"VectorSizeHintTransformerConfig\",\r\n		\"name\": \"VectorSizeHint\",\r\n		\"alias\": \"VectorSizeHint\",\r\n		\"attributes\": {\r\n			\"inputCol\": \"\",\r\n			\"size\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"dataset\": \"dropdown\",\r\n			\"applySchema\": \"checkbox\"\r\n		},\r\n		\"classname\": \"DatasetLoaderConfig\",\r\n		\"name\": \"Dataset Loader\",\r\n		\"alias\": \"Dataset Loader\",\r\n		\"attributes\": {\r\n			\"dataset\": \"\",\r\n			\"applySchema\": false\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"LoaderConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"query\": \"text\"\r\n		},\r\n		\"classname\": \"HiveExtractorConfig\",\r\n		\"name\": \"Hive Extractor\",\r\n		\"alias\": \"Hive Extractor\",\r\n		\"attributes\": {\r\n			\"query\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"ExtractorConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"tableName\": \"text\",\r\n			\"writeMode\": \"text\"\r\n		},\r\n		\"classname\": \"HiveLoaderConfig\",\r\n		\"name\": \"Hive Loader\",\r\n		\"alias\": \"Hive Loader\",\r\n		\"attributes\": {\r\n			\"tableName\": \"\",\r\n			\"writeMode\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"LoaderConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	},\r\n	{\r\n		\"requiredJars\": [],\r\n		\"formats\": {\r\n			\"arguments\": \"text\",\r\n			\"id\": \"text\"\r\n		},\r\n		\"classname\": \"XYZ_test\",\r\n		\"name\": \"XYZ_test\",\r\n		\"alias\": \"XYZ_test\",\r\n		\"attributes\": {\r\n			\"arguments\": \"\",\r\n			\"id\": \"\"\r\n		},\r\n		\"id\": 0,\r\n		\"category\": \"TransformerConfig\",\r\n		\"inputEndpoints\": [\r\n			\"in\"\r\n		],\r\n		\"outputEndpoints\": [\r\n			\"out\"\r\n		]\r\n	}\r\n]' where name='genericPython' and type='DragAndDrop';
		</sql>			
	</changeSet>
	
	<changeSet author="Leap" id="1312v0-cip-366331">
		<sql dbms="mssql" splitStatements="true" stripComments="true">  
			UPDATE mlplugin SET plugin='[	{		"requiredJars": [],		"formats": {			"inputCol": "text",			"outputCol":"text",			"vocabSize": "text"		},		"classname":"CountVectorizerFeatureExtractorConfig",		"name": "Count Vectorizer",		"alias":"Count Vectorizer",		"attributes": {			"inputCol": "",			"outputCol": "",			"vocabSize": ""		},		"id": 0,		"category": "FeatureExtractorConfig",	"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCol": "text",			"outputCol": "text"		},		"classname": "TfFeatureExtractorConfig",		"name": "TF",		"alias": "TF",		"attributes": {			"inputCol": "",			"outputCol": ""		},		"id": 0,	"category": "FeatureExtractorConfig",		"inputEndpoints": [			"in"		],	"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCol": "text",			"outputCol": "text"		},		"classname":"IdfFeatureExtractorConfig",		"name": "IDF",		"alias": "IDF",		"attributes": {			"inputCol": "",			"outputCol": ""		},		"id": 0,		"category":"FeatureExtractorConfig",		"inputEndpoints": [			"in"		],	"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"script": "textarea"		},		"classname": "PythonScriptTransformerConfig",	"name":"Python Script Transformer",		"alias": "Python Script Transformer",		"attributes": {			"script": [				"import logging\r",				"class CustomPythonClass():\r",				"    def __main__(self, dataset):\r",				"            \r",				"        return dataset"			]		},		"id": 0,		"category":"TransformerConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCol":"textarea",			"outputCol": "textarea",			"tags": "textarea"		},	"classname": "WordLemmetizerTransformerConfig",		"name": "Word Lemmetizer",		"alias": "WordLemmetizer",		"attributes": {			"inputCol": "",			"outputCol": "",		"tags": ""		},		"id": 0,		"category": "TransformerConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],	"formats": {			"inputCol": "textarea",			"outputCol": "textarea"		},		"classname":"WordStemmerTransformerConfig",		"name": "Word Stemmer",		"alias": "Word Stemmer",		"attributes": {			"inputCol": "",			"outputCol": ""		},		"id": 0,		"category": "TransformerConfig",		"inputEndpoints": [			"in"		],	"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"smoothing": "text",			"modelType": "text"		},		"classname":"NaiveBayesTransformerConfig",		"name": "Naive Bayes",		"alias": "Naive Bayes",	"attributes": {			"smoothing": "",			"modelType": ""		},		"id": 0,	"category":"TransformerConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCol":"text",			"outputCol": "text"		},		"classname": "TokenizerTransformerConfig",		"name": "Tokenizer",		"alias": "Tokenizer",		"attributes": {			"inputCol": "",			"outputCol": ""		},		"id": 0,		"category":"TransformerConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCol":"text",			"outputCol": "text",			"pattern": "text"		},		"classname":"RegexTokenizerTransformerConfig",		"name": "Regex Tokenizer",		"alias": "RegexTokenizer",		"attributes": {			"inputCol": "",			"outputCol": "",		"pattern": ""		},		"id": 0,		"category": "TransformerConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{	"requiredJars": [],		"formats": {			"inputCols": "text",			"outputCol": "text"		},	"classname":"VectorAssemblerTransformerConfig",		"name": "Vector Assembler",		"alias": "VectorAssembler",		"attributes": {			"inputCols": "",			"outputCol": ""		},	"id":0,		"category": "TransformerConfig",		"inputEndpoints": [			"in"		],	"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCol": "text",			"outputCol": "text",			"withStd": "text",		"withMean": "text"		},		"classname": "StandardScalerTransformerConfig",		"name": "StandardScaler",		"alias": "Standard Scaler",		"attributes": {			"inputCol": "",		"outputCol": "",			"withStd": "",			"withMean": ""		},		"id": 0,	"category":"TransformerConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCol":"text",			"outputCol": "text",			"K": "text"		},		"classname":"PCATransformerConfig",		"name": "PCA",		"alias": "PCA",		"attributes": {		"inputCol": "",			"outputCol": "",			"K": ""		},		"id": 0,		"category":"TransformerConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCol":"text",			"outputCol": "text",			"K": "text"		},		"classname":"KMeansTransformerConfig",		"name": "K Means",		"alias": "K Means",	"attributes": {			"inputCol": "",			"outputCol": "",			"K": ""		},		"id": 0,	"category": "TransformerConfig",		"inputEndpoints": [			"in"		],	"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCol":"text",			"checkpointInterval": "text",			"K": "text"		},		"classname":"LDAConfig",		"name": "LDA",		"alias": "LDA",		"attributes": {		"inputCol":"",			"checkpointInterval": "",			"K": ""		},		"id": 0,	"category":"TransformerConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"modelName":"text"		},		"classname": "ModelSinkConfig",		"name": "Model Sink",		"alias":"Model Sink",		"attributes": {			"modelName": ""		},		"id": 0,	"category":"BaseConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"modelName":"text"		},		"classname": "ModelSourceConfig",		"name": "Model Source",	"alias":"Model Source",		"attributes": {			"modelName": ""		},		"id": 0,	"category":"BaseConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"params":"textarea",			"script": "textarea"		},		"classname":"PostProcessingScriptConfig",		"name": "Post Processing Script",		"alias": "PostProcessing Script",		"attributes": {			"params": "",			"script": ""		},		"id": 0,		"category": "BaseConfig",		"inputEndpoints": [			"in"		],	"outputEndpoints": [			"out",			"out2"		]	},	{		"requiredJars": [],	"formats": {			"params": "textarea",			"script": "textarea"		},		"classname":"PreProcessingScriptConfig",		"name": "Pre Processing Script",		"alias": "PreProcessing Script",		"attributes": {			"params": "",			"script": ""		},		"id": 0,		"category": "BaseConfig",		"inputEndpoints": [			"dataset1",		"dataset2",			"dataset3"		],		"outputEndpoints": [			"out"		]	},	{	"requiredJars": [],		"formats": {			"labelCol": "text",			"featuresCol": "text",			"numTrees": "text"		},		"classname": "RandomForestClassifierConfig",	"name":"Random Forest Classifier",		"alias": "Random Forest Classifier",		"attributes": {			"labelCol": "",			"featuresCol": "",			"numTrees": ""		},		"id": 0,		"category": "AnalyzerConfig",		"inputEndpoints": [			"in"		],	"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCol": "text",			"outputCol": "text",			"stopWords": "text"		},	"classname": "StopWordsRemoverTransformerConfig",		"name": "Stop Words Remover",		"alias":"Stop Words Remover",		"attributes": {			"inputCol": "",			"outputCol": "",			"stopWords": ""		},		"id": 0,		"category": "TransformerConfig",	"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"n": "text",			"inputCol": "text",			"outputCol": "text"		},		"classname": "NgramTransformerConfig",		"name": "NGram",		"alias": "N Gram",		"attributes": {			"n": "",			"inputCol": "",			"outputCol": ""		},		"id": 0,		"category": "TransformerConfig",	"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCol": "text",			"outputCol": "text",			"inverse": "text"		},		"classname":"DiscreteCosineTransformTransformerConfig",		"name": "Discrete Cosine Transform",	"alias": "Discrete Cosine Transform",		"attributes": {			"inputCol": "",			"outputCol":"",			"inverse": ""		},		"id": 0,		"category": "TransformerConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCols":"text",			"outputCols": "text"		},		"classname":"StringIndexerTransformerConfig",		"name": "String Indexer",		"alias": "StringIndexer",		"attributes": {			"inputCols": "",			"outputCols": ""		},		"id": 0,		"category": "TransformerConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCol": "text",			"outputCol": "text",			"p": "text"		},	"classname": "NormalizerTransformerConfig",		"name": "Normalizer",		"alias": "Normalizer",	"attributes": {			"inputCol": "",			"outputCol": "",			"p": ""		},		"id": 0,		"category": "TransformerConfig",		"inputEndpoints": [			"in"		],	"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCol": "text",			"outputCol": "text"		},		"classname":"MinMaxScalerTransformerConfig",		"name": "Min Max Scaler",		"alias": "Min MaxScaler",		"attributes": {			"inputCol": "",			"outputCol": ""		},		"id": 0,		"category": "TransformerConfig",		"inputEndpoints": [			"in"		],	"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"statement": "text"		},		"classname": "SQLTransformerConfig",		"name": "SQLTransformer",		"alias": "SQL Transformer",		"attributes": {			"statement": ""		},		"id": 0,		"category": "TransformerConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCols": "text"		},		"classname": "AnomolyDetectionConfig",		"name":"AnomolyDetection",		"alias": "Anomoly Detection",		"attributes": {			"inputCols":""		},		"id": 0,		"category": "DomainSolutionConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{	"requiredJars": [],		"formats": {			"inputCols": "text",			"predictionCount": "text",		"seasonality": "text"		},		"classname": "ARIMAModelConfig",		"name": "ARIMA",	"alias":"ARIMA",		"attributes": {			"inputCol": "",			"predictionCount": "",		"seasonality": ""		},		"id": 0,		"category": "DomainSolutionConfig",	"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{	"requiredJars": [],		"formats": {			"inputCols": "text",			"predictionCount": "text",		"groupCol": "text"		},		"classname": "ARIMAGroupedConfig",		"name": "ARIMA Grouped",	"alias": "ARIMA Grouped",		"attributes": {			"inputCol": "",			"predictionCount": "",			"groupCol": ""		},		"id": 0,		"category": "DomainSolutionConfig",	"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCols": "text",			"outputCol":"text",			"ambiguousWords": "text"		},		"classname": "CleanTicketsConfig",		"name": "Clean Tickets",		"alias": "Clean Tickets",		"attributes": {			"inputCols": "",			"outputCol": "clean_text",			"ambiguousWords": ""		},		"id": 0,		"category": "DomainSolutionConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"UniqueIdColumn": "text",			"GroupByColumn": "text",			"TextColumn": "text",			"customStopWords": "text",			"vocabSize": "text",			"ClusterCount":"text",			"checkPointInterval": "text",			"saveModels": "checkbox"		},		"classname": "IncidentClusteringLDAConfig",		"name": "Incident Clustering",		"alias":"Incident Clustering",		"attributes": {			"UniqueIdColumn": "",		"GroupByColumn":"",			"TextColumn": "",			"customStopWords": "",			"vocabSize": "",			"ClusterCount": "",			"checkPointInterval": "",			"saveModels": ""		},		"id": 0,		"category": "DomainSolutionConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"topics",			"out"		]	},	{		"requiredJars":[],		"formats": {			"inputCols": "text"		},		"classname":"PhishingDetectionConfig",		"name": "Phishing Detection",		"alias": "PhishingDetection",		"attributes": {			"inputCols": ""		},		"id": 0,	"category":"DomainSolutionConfig",		"inputEndpoints": [			"in"		],	"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"labelCol":"text",			"featuresCol": "text"		},		"classname": "LogisticRegressionConfig",		"name": "Logistic Regression",		"alias": "Logistic Regression",		"attributes": {			"labelCol": "",			"featuresCol": ""		},		"id": 0,		"category": "AnalyzerConfig",		"inputEndpoints": [			"in"		],	"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"labelCol": "text",			"featuresCol": "text"		},		"classname":"DecisionTreeClassifierConfig",		"name": "Decision Tree Classifier",		"alias":"Decision Tree Classifier",		"attributes": {			"labelCol": "",			"featuresCol": ""		},		"id": 0,		"category": "AnalyzerConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],	"formats": {			"labelCol": "text",			"featuresCol": "text",			"maxIter": "text"		},		"classname": "GBTClassifierConfig",		"name": "GBT Classifier",		"alias":"GBT Classifier",		"attributes": {			"labelCol": "",			"featuresCol": "",			"maxIter": ""		},		"id": 0,		"category": "AnalyzerConfig",	"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"labelCol": "text",			"featuresCol": "text",			"maxIter": "text",			"regParam": "text"		},		"classname":"LinearSVCConfig",		"name": "Linear SVC",		"alias": "Linear SVC",	"attributes": {			"labelCol": "",			"featuresCol": "",			"maxIter": "",			"regParam": ""		},		"id": 0,		"category": "AnalyzerConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],	"formats": {			"labelCol": "text",			"featuresCol": "text",			"maxIter": "text",			"regParam": "text",			"elasticNetParam": "text"		},		"classname":"LinearRegressionConfig",		"name": "Linear Regression",		"alias": "LinearRegression",		"attributes": {			"labelCol": "",			"featuresCol": "",		"maxIter": "",			"regParam": "",			"elasticNetParam": ""		},		"id": 0,	"category": "AnalyzerConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"featuresCol":"text",			"labelCol": "text"		},		"classname":"RandomForestRegressorConfig",		"name": "Random Forest Regressor",		"alias": "RandomForest Regressor",		"attributes": {			"featuresCol": "",			"labelCol": ""		},		"id": 0,		"category": "AnalyzerConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"dataset": "dropdown",			"isValidation": "checkbox",			"samplingRatio": "text",			"applySchema": "checkbox"		},		"classname": "DatasetExtractorConfig",	"name": "Dataset Extractor",		"alias": "Dataset Dataset",		"attributes": {			"dataset": "",			"isValidation": "",			"samplingRatio": "",			"applySchema": false		},		"id": 0,		"category": "ExtractorConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCol": "text",			"outputCol": "text",			"seed": "text"		},	"classname": "Word2VecFeatureExtractorConfig",		"name": "Word2Vec",		"alias": "Word2Vec",	"attributes": {			"inputCol": "",			"outputCol": "",			"seed": ""		},	"id": 0,		"category": "FeatureExtractorConfig",		"inputEndpoints": [			"in"		],	"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCols": "text",			"outputCol": "text",			"categoricalCols": "text"		},		"classname": "FeatureHasherFeatureExtractorConfig",		"name": "FeatureHasher",		"alias": "FeatureHasher",		"attributes": {			"inputCols": "",			"outputCol": "",			"categoricalCols": ""		},		"id": 0,	"category":"FeatureExtractorConfig",		"inputEndpoints": [			"in"		],	"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCol": "text",			"outputCol": "text"		},		"classname":"BinarizerTransformerConfig",		"name": "Binarizer",		"alias": "Binarizer",	"attributes": {			"inputCol": "",			"outputCol": ""		},		"id": 0,		"category":"TransformerConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCol":"text",			"outputCol": "text"		},		"classname": "PolynomialExpansionConfig",		"name": "PolynomialExpansion",		"alias": "PolynomialExpansion",		"attributes": {			"inputCol": "",			"outputCol": ""		},	"id":0,		"category": "TransformerConfig",		"inputEndpoints": [			"in"		],	"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCol": "text",			"outputCol": "text",			"labels": "text"		},	"classname": "IndexToStringTransformerConfig",		"name": "IndexToString",		"alias":"IndexToString",		"attributes": {			"inputCol": "",			"outputCol": "",			"labels": ""		},		"id": 0,		"category": "TransformerConfig",	"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCols": "text",			"outputCols":"text"		},		"classname": "OneHotEncoderEstimatorTransformerConfig",		"name":"OneHotEncoderEstimator",		"alias": "OneHotEncoderEstimator",		"attributes": {		"inputCols": "",			"outputCols": ""		},		"id": 0,		"category":"TransformerConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCol":"text",			"outputCol": "text"		},		"classname": "VectorIndexerTransformerConfig",		"name": "VectorIndexer",		"alias": "VectorIndexer",	"attributes": {			"inputCol": "",			"outputCol": ""		},		"id": 0,		"category":"TransformerConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCol":"text",			"outputCol": "text"		},		"classname": "MaxAbsScalerTransformerConfig",		"name": "MaxAbsScaler",		"alias": "MaxAbsScaler",	"attributes": {			"inputCol": "",			"outputCol": ""		},		"id": 0,		"category":"TransformerConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCol":"text",			"outputCol": "text",			"splits": "text"		},		"classname":"BucketizerTransformerConfig",		"name": "Bucketizer",		"alias": "Bucketizer",	"attributes": {			"inputCol": "",			"outputCol": "",			"splits": ""		},	"id": 0,		"category": "TransformerConfig",		"inputEndpoints": [			"in"		],	"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCol": "text",			"outputCol": "text",			"scalingVec": "text"		},		"classname": "ElementWiseProductTransformerConfig",		"name": "ElementWiseProduct",	"alias":"ElementWiseProduct",		"attributes": {			"inputCol": "",			"outputCol": "",			"scalingVec": ""		},		"id": 0,		"category": "TransformerConfig",	"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"inputCol": "text",			"size": "text"		},		"classname": "VectorSizeHintTransformerConfig",		"name": "VectorSizeHint",		"alias":"VectorSizeHint",		"attributes": {			"inputCol": "",			"size": ""		},	"id": 0,		"category": "TransformerConfig",		"inputEndpoints": [			"in"		],	"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"dataset": "dropdown",			"applySchema": "checkbox"		},		"classname":"DatasetLoaderConfig",		"name": "Dataset Loader",		"alias": "Dataset Loader",	"attributes": {			"dataset": "",			"applySchema": false		},		"id": 0,	"category": "LoaderConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"query": "text"		},		"classname": "HiveExtractorConfig",		"name": "Hive Extractor",		"alias":"HiveExtractor",		"attributes": {			"query": ""		},		"id": 0,	"category":"ExtractorConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	},	{		"requiredJars": [],		"formats": {			"tableName":"text",			"writeMode": "text"		},		"classname": "HiveLoaderConfig",	"name":"Hive Loader",		"alias": "Hive Loader",		"attributes": {			"tableName": "",			"writeMode": ""		},	"id": 0,		"category": "LoaderConfig",		"inputEndpoints": [			"in"		],		"outputEndpoints": [			"out"		]	}]' WHERE name='genericPython' and type='DragAndDrop'
		</sql>			
	</changeSet>
	<changeSet dbms="mssql" author="Leap (generated)" id="1312v0-cip-366332">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="db/changelog/data/1312v0/cip/mlpipeline-mssql.csv" quotchar="&quot;" separator="," tableName="mlpipeline">
            <column header="cid" name="cid" type="NUMERIC"/>
            <column header="created_by" name="created_by" type="STRING"/>
            <column header="created_date" name="created_date" type="datetime(6)"/>
            <column header="deleted" name="deleted" type="BOOLEAN"/>
            <column header="description" name="description" type="STRING"/>
            <column header="job_id" name="job_id" type="skip"/>
            <column header="json_content" name="json_content" type="STRING"/>
            <column header="lastmodifiedby" name="lastmodifiedby" type="STRING"/>
            <column header="alias" name="alias" type="STRING"/>
            <column header="lastmodifieddate" name="lastmodifieddate" type="datetime"/>
            <column header="name" name="name" type="STRING"/>
            <column header="organization" name="organization" type="STRING"/>
            <column header="type" name="type" type="STRING"/>
            <column header="version" name="version" type="skip"/>
        </loadData>
    </changeSet>
    <changeSet author="Leap" id="1312v0-cip-366322">
		<sql dbms="mssql" splitStatements="true" stripComments="true">  
			UPDATE mldataset SET attributes='{"filter":"","mode":"query","Query":"SELECT COUNT(*) AS count, FORMAT(createdDate, ''dd/MMM/yy'') AS label FROM @projectname_tickets GROUP BY FORMAT(createdDate, ''dd/MMM/yy'') ORDER BY FORMAT(createdDate, ''dd/MMM/yy'') OFFSET 0 ROWS","Cacheable":false,"isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":""}' WHERE name='DailyVolume' AND organization='leo1311'
			UPDATE mlpipeline SET json_content='{"elements":[{"id":"jKxVp","alias":"Dataset  Extractor","name":"Dataset  Extractor","classname":"DatasetExtractorConfig","category":"ExtractorConfig","attributes":{"dataset":{"name":"5HG2DXIXOW","alias":"Volume","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2021-12-29 07:42:19","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encwiuiKMPz4dAiAXwXsyz26lD6b5uHl4R7r6Y=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"mo30JpAa2FVXsBAYa4SxD93brNmJfqrcTBHivdgZuaZhK/FgDiNJMuKYmrR2OGrGK3/T0PDUK7p8+rUMHoCiiA==","organization":"leo1311","dshashcode":null,"activetime":"2021-12-29 07:42:19","category":"SQL"},"schema":{"lastmodifiedby":"admin","lastmodifieddate":"2021-11-16 06:45:06","alias":"Forecast","id":18,"name":"Forecast","description":null,"schemavalue":"[{\"columntype\":\"int\",\"columnorder\":1,\"recordcolumnname\":\"count\",\"recordcolumndisplayname\":\"count\",\"isunique\":false,\"isrequired\":false},{\"columntype\":\"datetime\",\"columnorder\":2,\"recordcolumnname\":\"label\",\"recordcolumndisplayname\":\"label\",\"isunique\":false,\"isrequired\":false}]","organization":"leo1311","formtemplate":"[]"},"type":"r","attributes":{"filter":"","mode":"query","Query":"  SELECT COUNT(*) AS count, FORMAT(createdDate, ''dd/MMM/yy'') AS label FROM @projectname_tickets GROUP BY FORMAT(createdDate, ''dd/MMM/yy'') ORDER BY FORMAT(createdDate, ''dd/MMM/yy'') OFFSET 0 ROWS\n","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"datasetType":"MYSQL","backingDataset":"","organization":"leo1311","groups":[]},"isValidation":"","samplingRatio":"","applySchema":false},"position_x":"170","position_y":"120","connectors":[{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"oervs","elementPosition":"LeftMiddle"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"dataset":"dropdown","isValidation":"checkbox","samplingRatio":"text","applySchema":"checkbox"},"context":[]},{"id":"TqdbH","alias":"Dataset  Loader","name":"Dataset  Loader","classname":"DatasetLoaderConfig","category":"LoaderConfig","attributes":{"dataset":{"name":"OBQI3IMMEI","alias":"output","description":"","schema":"","type":"r","attributes":{"filter":"","mode":"query","Query":"Select * from @projectname_forecast","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"@projectname_forecast","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"datasetType":"MYSQL","groups":[],"backingDataset":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2021-12-29 07:42:19","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encwiuiKMPz4dAiAXwXsyz26lD6b5uHl4R7r6Y=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"mo30JpAa2FVXsBAYa4SxD93brNmJfqrcTBHivdgZuaZhK/FgDiNJMuKYmrR2OGrGK3/T0PDUK7p8+rUMHoCiiA==","organization":"leo1311","dshashcode":null,"activetime":"2021-12-29 07:42:19","category":"SQL"}},"applySchema":false},"position_x":"960","position_y":"120","connectors":[{"type":"target","endpoint":"in","position":"LeftMiddle","elementId":"BhNMp","elementPosition":"RightMiddle"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"dataset":"dropdown","applySchema":"checkbox"},"context":[{"params":"{\"CorrelationId\":\"\"}","script":["from pyspark.sql.types import *","from pyspark.sql.functions import *","import datetime","class CustomPythonClass():","    def __main__(self,model,results):","        data = results[''out'']","        data.show()","        correlationId = self.params[''CorrelationId'']","        data = data.withColumn(''correlationId'', lit(correlationId))","        ","        data = data.withColumn(''run_timestamp'',lit(datetime.datetime.now()))","        ","        data = data.select(col(''order'').alias(''label''), col(''volume'').alias(''count''), ''run_timestamp'',''correlationId'' )","        return data","        ","        "]},{"inputCol":"count","seasonality":"7","predictionCount":"7"},{"dataset":{"name":"5HG2DXIXOW","alias":"Volume","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2021-12-29 07:42:19","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encwiuiKMPz4dAiAXwXsyz26lD6b5uHl4R7r6Y=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"mo30JpAa2FVXsBAYa4SxD93brNmJfqrcTBHivdgZuaZhK/FgDiNJMuKYmrR2OGrGK3/T0PDUK7p8+rUMHoCiiA==","organization":"leo1311","dshashcode":null,"activetime":"2021-12-29 07:42:19","category":"SQL"},"schema":{"lastmodifiedby":"admin","lastmodifieddate":"2021-11-16 06:45:06","alias":"Forecast","id":18,"name":"Forecast","description":null,"schemavalue":"[{\"columntype\":\"int\",\"columnorder\":1,\"recordcolumnname\":\"count\",\"recordcolumndisplayname\":\"count\",\"isunique\":false,\"isrequired\":false},{\"columntype\":\"datetime\",\"columnorder\":2,\"recordcolumnname\":\"label\",\"recordcolumndisplayname\":\"label\",\"isunique\":false,\"isrequired\":false}]","organization":"leo1311","formtemplate":"[]"},"type":"r","attributes":{"filter":"","mode":"query","Query":"  SELECT COUNT(*) AS count, FORMAT(createdDate, ''dd/MMM/yy'') AS label FROM @projectname_tickets GROUP BY FORMAT(createdDate, ''dd/MMM/yy'') ORDER BY FORMAT(createdDate, ''dd/MMM/yy'') OFFSET 0 ROWS\n","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"datasetType":"MYSQL","backingDataset":"","organization":"leo1311","groups":[]},"isValidation":"","samplingRatio":"","applySchema":false}]},{"id":"BhNMp","alias":"Post  Processing  Script","name":"Post  Processing  Script","classname":"PostProcessingScriptConfig","category":"BaseConfig","attributes":{"params":"{\"CorrelationId\":\"\"}","script":["from pyspark.sql.types import *","from pyspark.sql.functions import *","import datetime","class CustomPythonClass():","    def __main__(self,model,results):","        data = results[''out'']","        data.show()","        correlationId = self.params[''CorrelationId'']","        data = data.withColumn(''correlationId'', lit(correlationId))","        ","        data = data.withColumn(''run_timestamp'',lit(datetime.datetime.now()))","        ","        data = data.select(col(''order'').alias(''label''), col(''volume'').alias(''count''), ''run_timestamp'',''correlationId'' )","        return data","        ","        "]},"position_x":"720","position_y":"120","connectors":[{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"TqdbH","elementPosition":"LeftMiddle"},{"type":"target","endpoint":"in","position":"LeftMiddle","elementId":"oervs","elementPosition":"RightMiddle"}],"inputEndpoints":["in"],"outputEndpoints":["out","out2"],"requiredJars":[],"formats":{"params":"textarea","script":"textarea"},"context":[{"inputCol":"count","seasonality":"7","predictionCount":"7"},{"dataset":{"name":"5HG2DXIXOW","alias":"Volume","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2021-12-29 07:42:19","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encwiuiKMPz4dAiAXwXsyz26lD6b5uHl4R7r6Y=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"mo30JpAa2FVXsBAYa4SxD93brNmJfqrcTBHivdgZuaZhK/FgDiNJMuKYmrR2OGrGK3/T0PDUK7p8+rUMHoCiiA==","organization":"leo1311","dshashcode":null,"activetime":"2021-12-29 07:42:19","category":"SQL"},"schema":{"lastmodifiedby":"admin","lastmodifieddate":"2021-11-16 06:45:06","alias":"Forecast","id":18,"name":"Forecast","description":null,"schemavalue":"[{\"columntype\":\"int\",\"columnorder\":1,\"recordcolumnname\":\"count\",\"recordcolumndisplayname\":\"count\",\"isunique\":false,\"isrequired\":false},{\"columntype\":\"datetime\",\"columnorder\":2,\"recordcolumnname\":\"label\",\"recordcolumndisplayname\":\"label\",\"isunique\":false,\"isrequired\":false}]","organization":"leo1311","formtemplate":"[]"},"type":"r","attributes":{"filter":"","mode":"query","Query":"  SELECT COUNT(*) AS count, FORMAT(createdDate, ''dd/MMM/yy'') AS label FROM @projectname_tickets GROUP BY FORMAT(createdDate, ''dd/MMM/yy'') ORDER BY FORMAT(createdDate, ''dd/MMM/yy'') OFFSET 0 ROWS\n","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"datasetType":"MYSQL","backingDataset":"","organization":"leo1311","groups":[]},"isValidation":"","samplingRatio":"","applySchema":false}]},{"id":"oervs","alias":"A R I M A","name":"A R I M A","classname":"ARIMAModelConfig","category":"DomainSolutionConfig","attributes":{"inputCol":"count","seasonality":"7","predictionCount":"7"},"position_x":"410","position_y":"120","connectors":[{"type":"target","endpoint":"in","position":"LeftMiddle","elementId":"jKxVp","elementPosition":"RightMiddle"},{"type":"source","endpoint":"out","position":"RightMiddle","elementId":"BhNMp","elementPosition":"LeftMiddle"}],"inputEndpoints":["in"],"outputEndpoints":["out"],"requiredJars":[],"formats":{"inputCols":"text","seasonality":"","predictionCount":"text"},"context":[{"dataset":{"name":"5HG2DXIXOW","alias":"Volume","description":"","datasource":{"lastmodifiedby":"admin","lastmodifieddate":"2021-12-29 07:42:19","alias":"leo1311","id":15,"name":"leo1311","description":"Local data for setup","type":"MSSQL","connectionDetails":"{\"password\":\"encwiuiKMPz4dAiAXwXsyz26lD6b5uHl4R7r6Y=\",\"userName\":\"leapadmin\",\"url\":\"jdbc:sqlserver://VICTADPST-13\\\\SQLSERVER_17;databaseName=leapmaster_data\"}","salt":"mo30JpAa2FVXsBAYa4SxD93brNmJfqrcTBHivdgZuaZhK/FgDiNJMuKYmrR2OGrGK3/T0PDUK7p8+rUMHoCiiA==","organization":"leo1311","dshashcode":null,"activetime":"2021-12-29 07:42:19","category":"SQL"},"schema":{"lastmodifiedby":"admin","lastmodifieddate":"2021-11-16 06:45:06","alias":"Forecast","id":18,"name":"Forecast","description":null,"schemavalue":"[{\"columntype\":\"int\",\"columnorder\":1,\"recordcolumnname\":\"count\",\"recordcolumndisplayname\":\"count\",\"isunique\":false,\"isrequired\":false},{\"columntype\":\"datetime\",\"columnorder\":2,\"recordcolumnname\":\"label\",\"recordcolumndisplayname\":\"label\",\"isunique\":false,\"isrequired\":false}]","organization":"leo1311","formtemplate":"[]"},"type":"r","attributes":{"filter":"","mode":"query","Query":"  SELECT COUNT(*) AS count, FORMAT(createdDate, ''dd/MMM/yy'') AS label FROM @projectname_tickets GROUP BY FORMAT(createdDate, ''dd/MMM/yy'') ORDER BY FORMAT(createdDate, ''dd/MMM/yy'') OFFSET 0 ROWS\n","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":"","Cacheable":""},"expStatus":0,"datasetType":"MYSQL","backingDataset":"","organization":"leo1311","groups":[]},"isValidation":"","samplingRatio":"","applySchema":false}]}]}' WHERE name='Forecast' AND organization='leo1311'
			UPDATE mlpipeline SET json_content='{"elements":[{"attributes":{"filetype":"Python3","files":["ACMKYPHR40814_leo1311.py"],"arguments":[{"name":"LEAPDS","value":"leo1311","type":"Datasource","index":"1"},{"name":"TableName","value":"@projectname_phrase_extraction","type":"Text","index":"2","alias":"@projectname_phrase_extraction"},{"name":"EaseMapping","value":"@projectname_EASEMapping","type":"Text","alias":"@projectname_EASEMapping","index":"3"}],"dataset":[]}}]}' WHERE name='ACMKYPHR40814' AND organization='leo1311'
            DELETE FROM mlpipelinenativescriptentity WHERE cname='ACMKYPHR40814' AND organization='leo1311'
		</sql>			
	</changeSet>
</databaseChangeLog>
